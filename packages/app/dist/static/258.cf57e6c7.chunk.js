"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[258],{70258:(kn,Wt,q)=>{q.d(Wt,{A:()=>dr,D:()=>Es,L:()=>K,T:()=>rn,W:()=>Ee,a:()=>as,b:()=>Ds,c:()=>yr,d:()=>Ws,e:()=>jt,f:()=>Lr,g:()=>Rr,u:()=>Kn});var p=q(2784),Se=q(64279),de=q(60885),L=q(12053),G=q(95544),Ce=q(79692),Ie=q(60905),vt=q(90436),dt=q(4614),bt=q(97136),$e=q(27556),nt=q(77277),_e=q(91256),mt=q(37390),yi=q(58987),Xt=q(89571),me=q(15584),pt=q(97485),Kt=q(82113),wi=q(27616),ui=q(8284),Et=q(70660),ii=q(94339),Di=q(11776),Jt=q(12231),Ot=q(86136),Tt=q(49378),ct=q(80030),Yt=q(61837),ri=q(85256),Si=q(72779),Ge=q.n(Si),ki=q(38016),Xe=q(84905),oe=q(30705),ye=q(30204),ke=q(49558),Me=q(7089),Fe=q(35632),Dt=q(64304),lt=q(47603),Qt=q(56881),et=q(26228),Li=q(75951),Rt=q.n(Li),kt=q(34520),_t=q(25417),Xi=q(24579),hn=q(82726),ie=q(12420),w=q(87685),C=q(49423),N=q(96401),I=q(77120),Z=q(42123),ee=q(65329),se=q(78887),xe=function(z){return(z+1)%Number.MAX_SAFE_INTEGER};function He(){var z=(0,se.F)(0),H=z[1];return(0,p.useCallback)(function(){H(xe)},[])}var Oe=q(51967),Je=q(77246),tt=q(29862),rt=q(16303),ei=function(z,H,Q){if(Q||arguments.length===2)for(var te=0,he=H.length,ue;te<he;te++)(ue||!(te in H))&&(ue||(ue=Array.prototype.slice.call(H,0,te)),ue[te]=H[te]);return z.concat(ue||Array.prototype.slice.call(H))};function ci(z){for(var H=[],Q=1;Q<arguments.length;Q++)H[Q-1]=arguments[Q];var te=(0,tt.t)(),he=(0,Je.x)(H[1]),ue=(0,p.useMemo)(function(){return function(){for(var be=[],Ne=0;Ne<arguments.length;Ne++)be[Ne]=arguments[Ne];te()&&(typeof he.current=="function"?he.current.apply(this,be):typeof he.current.handleEvent=="function"&&he.current.handleEvent.apply(this,be))}},[]);(0,p.useEffect)(function(){var be=z&&(0,rt.nr)(z,"current")?z.current:z;if(be){var Ne=H.slice(2);return rt.on.apply(void 0,ei([be,H[0],ue],Ne,!1)),function(){return rt.S1.apply(void 0,ei([be,H[0],ue],Ne,!1))}}},[z,H[0]])}var Vt=q(24947),zt=function(z){return typeof z=="function"?z:typeof z=="string"?function(H){return H.key===z}:z?rt.cI:rt.Vp},Ct=Vt.jU?window:null;function Bt(z,H,Q,te){te===void 0&&(te={});var he=te.event,ue=he===void 0?"keydown":he,be=te.target,Ne=be===void 0?Ct:be,Mt=te.eventOptions,yt=(0,Je.x)(H),Ue=(0,p.useMemo)(function(){var De=zt(z);return function(At){De(At)&&yt.current.call(this,At)}},Q);ci(Ne,ue,Ue,Mt)}function Ci(z){var H=(0,p.useRef)();return(0,p.useEffect)(function(){H.current=z}),H.current}var it=q(2552),Ye=q(10921),We=q(38402),Ut=q(9520),st=q(49166),ot=q(98281),gt=q(22983),at=q(28113),Lt=q(6487),$t=q(99152),qe=q(7896),Vi=q(96234),fi=q(59740),vi=q(6277),tn=q(15459),Ti=q(24514),Ht=p.createContext({});const Ni=Ht;var zi={root:{padding:0,margin:0,listStyle:"none"}};function Yi(z,H){if(z.length!==H.length)return!0;for(var Q=0;Q<z.length;Q+=1)if(z[Q]!==H[Q])return!0;return!1}var $i=function(H,Q,te){for(var he=Q;he<H.length;he+=1)if(te===H[he])return he;return-1},nn=[],si=[],Zi=p.forwardRef(function(H,Q){var te=H.children,he=H.classes,ue=H.className,be=H.defaultCollapseIcon,Ne=H.defaultEndIcon,Mt=H.defaultExpanded,yt=Mt===void 0?nn:Mt,Ue=H.defaultExpandIcon,De=H.defaultParentIcon,Ae=H.defaultSelected,At=Ae===void 0?si:Ae,je=H.disableSelection,Pt=je===void 0?!1:je,ni=H.multiSelect,Zt=ni===void 0?!1:ni,Fi=H.expanded,Pi=H.onNodeSelect,Ji=H.onNodeToggle,Ui=H.selected,Nt=(0,fi.Z)(H,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),Tn=p.useState(null),oi=Tn[0],Wi=Tn[1],ji=p.useState(null),Mn=ji[0],ir=ji[1],li=p.useRef({}),un=p.useRef({}),Ri=p.useRef([]),nr=(0,Ti.Z)({controlled:Fi,default:yt,name:"TreeView",state:"expanded"}),Fr=(0,Vi.Z)(nr,2),vn=Fr[0],qr=Fr[1],rr=(0,Ti.Z)({controlled:Ui,default:At,name:"TreeView",state:"selected"}),Ii=(0,Vi.Z)(rr,2),Bi=Ii[0],dn=Ii[1],bn=p.useCallback(function(Qe){return Array.isArray(vn)?vn.indexOf(Qe)!==-1:!1},[vn]),Wr=p.useCallback(function(Qe){return Array.isArray(Bi)?Bi.indexOf(Qe)!==-1:Bi===Qe},[Bi]),sr=function(Te){return oi===Te},sn=function(Te){return Mn===Te},Hr=function(Te){var we=Ri.current.indexOf(Te);return we!==-1&&we+1<Ri.current.length?Ri.current[we+1]:null},Bn=function(Te){var we=Ri.current.indexOf(Te);return we!==-1&&we-1>=0?Ri.current[we-1]:null},or=function(){return Ri.current[Ri.current.length-1]},vr=function(){return Ri.current[0]},br=function(Te){return li.current[Te].parent},xr=function(Te,we){var ze=Ri.current.indexOf(Te),xt=Ri.current.indexOf(we),wt=Math.min(ze,xt),gi=Math.max(ze,xt);return Ri.current.slice(wt,gi+1)},Qi=function(Te){Te&&(Wi(Te),ir(Te))},En=function(Te){return Qi(Hr(Te))},Jn=function(Te){return Qi(Bn(Te))},Un=function(){return Qi(vr())},lr=function(){return Qi(or())},ps=function(Te,we){var ze,xt,wt=we.toLowerCase(),gi=[],Mi=[];Object.keys(un.current).forEach(function(Sn){var gs=un.current[Sn],is=li.current[Sn],so=is.parent?bn(is.parent):!0;so&&(gi.push(Sn),Mi.push(gs))}),ze=gi.indexOf(Te)+1,ze===li.current.length&&(ze=0),xt=$i(Mi,ze,wt),xt===-1&&(xt=$i(Mi,0,wt)),xt>-1&&Qi(gi[xt])},ar=function(Te){var we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Mn,ze;vn.indexOf(we)!==-1?(ze=vn.filter(function(xt){return xt!==we}),Wi(function(xt){var wt=li.current[xt];return xt&&(wt&&wt.parent?wt.parent.id:null)===we?we:xt})):ze=[we].concat(vn),Ji&&Ji(Te,ze),qr(ze)},xn=function(Te,we){var ze=li.current[we],xt=li.current[ze.parent],wt;if(xt)wt=xt.children.filter(function(Sn){return!bn(Sn)});else{var gi=li.current[-1].children;wt=gi.filter(function(Sn){return!bn(Sn)})}var Mi=vn.concat(wt);wt.length>0&&(qr(Mi),Ji&&Ji(Te,Mi))},Dn=p.useRef(null),mi=p.useRef(!1),pn=p.useRef([]),Ft=function(Te,we){var ze=Bi,xt=we.start,wt=we.next,gi=we.current;!wt||!gi||(pn.current.indexOf(gi)===-1&&(pn.current=[]),mi.current?pn.current.indexOf(wt)!==-1?(ze=ze.filter(function(Mi){return Mi===xt||Mi!==gi}),pn.current=pn.current.filter(function(Mi){return Mi===xt||Mi!==gi})):(ze.push(wt),pn.current.push(wt)):(ze.push(wt),pn.current.push(gi,wt)),Pi&&Pi(Te,ze),dn(ze))},Qr=function(Te,we){var ze=Bi,xt=we.start,wt=we.end;mi.current&&(ze=Bi.filter(function(Sn){return pn.current.indexOf(Sn)===-1}));var gi=xr(xt,wt);pn.current=gi;var Mi=ze.concat(gi);Mi=Mi.filter(function(Sn,gs){return Mi.indexOf(Sn)===gs}),Pi&&Pi(Te,Mi),dn(Mi)},wr=function(Te,we){var ze=[];Bi.indexOf(we)!==-1?ze=Bi.filter(function(xt){return xt!==we}):ze=[we].concat(Bi),Pi&&Pi(Te,ze),dn(ze)},Sr=function(Te,we){var ze=Zt?[we]:we;Pi&&Pi(Te,ze),dn(ze)},kr=function(Te,we){var ze=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return we?(ze?wr(Te,we):Sr(Te,we),Dn.current=we,mi.current=!1,pn.current=[],!0):!1},_i=function(Te,we){var ze=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,xt=we.start,wt=xt===void 0?Dn.current:xt,gi=we.end,Mi=we.current;return ze?Ft(Te,{start:wt,next:gi,current:Mi}):Qr(Te,{start:wt,end:gi}),mi.current=!0,!0},Re=function(Te,we){Dn.current||(Dn.current=we);var ze=mi.current?Dn.current:we;return _i(Te,{start:ze,end:vr()})},ai=function(Te,we){Dn.current||(Dn.current=we);var ze=mi.current?Dn.current:we;return _i(Te,{start:ze,end:or()})},wn=function(Te,we){return _i(Te,{end:Hr(we),current:we},!0)},Ln=function(Te,we){return _i(Te,{end:Bn(we),current:we},!0)},Hs=function(Te){return _i(Te,{start:vr(),end:or()})},Vs=function(Te,we){var ze=li.current[Te];li.current[Te]=(0,qe.Z)({},ze,{children:we,id:Te}),we.forEach(function(xt){var wt=li.current[xt];li.current[xt]=(0,qe.Z)({},wt,{parent:Te,id:xt})})},_r=p.useCallback(function(Qe){var Te=li.current[Qe],we=[];return Te&&(we.push(Qe),Te.children&&(we.concat(Te.children),Te.children.forEach(function(ze){we.concat(_r(ze))}))),we},[]),zn=p.useCallback(function(Qe){var Te=(0,qe.Z)({},un.current);Qe.forEach(function(we){Te[we]&&delete Te[we]}),un.current=Te},[]),ms=p.useCallback(function(Qe){var Te=_r(Qe);zn(Te);var we=(0,qe.Z)({},li.current);Te.forEach(function(ze){var xt=we[ze];if(xt){if(xt.parent){var wt=we[xt.parent];if(wt&&wt.children){var gi=wt.children.filter(function(Mi){return Mi!==ze});we[xt.parent]=(0,qe.Z)({},wt,{children:gi})}}delete we[ze]}}),li.current=we,ir(function(ze){return ze===Qe?null:ze})},[_r,zn]),on=function(Te,we){un.current[Te]=we},Gn=p.useRef([]),Cr=p.useState(!1),es=Cr[0],ts=Cr[1];p.useEffect(function(){var Qe=[];p.Children.forEach(te,function(Te){p.isValidElement(Te)&&Te.props.nodeId&&Qe.push(Te.props.nodeId)}),Yi(Gn.current,Qe)&&(li.current[-1]={parent:null,children:Qe},Qe.forEach(function(Te,we){we===0&&Wi(Te)}),Ri.current=li.current[-1].children,Gn.current=Qe,ts(!0))},[te]),p.useEffect(function(){var Qe=function Te(we){for(var ze=[],xt=0;xt<we.length;xt+=1){var wt=we[xt];ze.push(wt);var gi=li.current[wt].children;bn(wt)&&gi&&(ze=ze.concat(Te(gi)))}return ze};es&&(Ri.current=Qe(li.current[-1].children))},[vn,es,bn,te]);var xi=function(){return!1};return p.createElement(Ni.Provider,{value:{icons:{defaultCollapseIcon:be,defaultExpandIcon:Ue,defaultParentIcon:De,defaultEndIcon:Ne},focus:Qi,focusFirstNode:Un,focusLastNode:lr,focusNextNode:En,focusPreviousNode:Jn,focusByFirstCharacter:ps,expandAllSiblings:xn,toggleExpansion:ar,isExpanded:bn,isFocused:sn,isSelected:Wr,selectNode:Pt?xi:kr,selectRange:Pt?xi:_i,selectNextNode:Pt?xi:wn,selectPreviousNode:Pt?xi:Ln,rangeSelectToFirst:Pt?xi:Re,rangeSelectToLast:Pt?xi:ai,selectAllNodes:Pt?xi:Hs,isTabbable:sr,multiSelect:Zt,getParent:br,mapFirstChar:on,addNodeToNodeMap:Vs,removeNodeFromNodeMap:ms}},p.createElement("ul",(0,qe.Z)({role:"tree","aria-multiselectable":Zt,className:(0,vi.default)(he.root,ue),ref:Q},Nt),te))});const $n=(0,tn.Z)(zi,{name:"MuiTreeView"})(Zi);var cn=q(51209),di=q(41128),Nn=q(60364),On=q(85974),qn=function(H){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:H.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,di.Fq)(H.palette.primary.main,H.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,di.Fq)(H.palette.primary.main,H.palette.action.selectedOpacity+H.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:H.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},Fn=function(H){return H&&H.length===1&&H.match(/\S/)},R=p.forwardRef(function(H,Q){var te=H.children,he=H.classes,ue=H.className,be=H.collapseIcon,Ne=H.endIcon,Mt=H.expandIcon,yt=H.icon,Ue=H.label,De=H.nodeId,Ae=H.onClick,At=H.onLabelClick,je=H.onIconClick,Pt=H.onFocus,ni=H.onKeyDown,Zt=H.onMouseDown,Fi=H.TransitionComponent,Pi=Fi===void 0?Kt.Z:Fi,Ji=H.TransitionProps,Ui=(0,fi.Z)(H,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),Nt=p.useContext(Ni),Tn=Nt.icons,oi=Nt.focus,Wi=Nt.focusFirstNode,ji=Nt.focusLastNode,Mn=Nt.focusNextNode,ir=Nt.focusPreviousNode,li=Nt.focusByFirstCharacter,un=Nt.selectNode,Ri=Nt.selectRange,nr=Nt.selectNextNode,Fr=Nt.selectPreviousNode,vn=Nt.rangeSelectToFirst,qr=Nt.rangeSelectToLast,rr=Nt.selectAllNodes,Ii=Nt.expandAllSiblings,Bi=Nt.toggleExpansion,dn=Nt.isExpanded,bn=Nt.isFocused,Wr=Nt.isSelected,sr=Nt.isTabbable,sn=Nt.multiSelect,Hr=Nt.getParent,Bn=Nt.mapFirstChar,or=Nt.addNodeToNodeMap,vr=Nt.removeNodeFromNodeMap,br=p.useRef(null),xr=p.useRef(null),Qi=(0,On.Z)(br,Q),En=yt,Jn=Boolean(Array.isArray(te)?te.length:te),Un=dn?dn(De):!1,lr=bn?bn(De):!1,ps=sr?sr(De):!1,ar=Wr?Wr(De):!1,xn=Tn||{},Dn=(0,Nn.Z)();En||(Jn?(Un?En=be||xn.defaultCollapseIcon:En=Mt||xn.defaultExpandIcon,En||(En=xn.defaultParentIcon)):En=Ne||xn.defaultEndIcon);var mi=function(Re){lr||oi(De);var ai=sn&&(Re.shiftKey||Re.ctrlKey||Re.metaKey);Jn&&!Re.defaultPrevented&&!(ai&&dn(De))&&Bi(Re,De),ai?Re.shiftKey?Ri(Re,{end:De}):un(Re,De,!0):un(Re,De),Ae&&Ae(Re)},pn=function(Re){(Re.shiftKey||Re.ctrlKey||Re.metaKey)&&Re.preventDefault(),Zt&&Zt(Re)},Ft=function(Re){return Jn&&(Un?Mn(De):Bi(Re)),!0},Qr=function(Re){if(Un)return Bi(Re,De),!0;var ai=Hr(De);return ai?(oi(ai),!0):!1},wr=function(Re){var ai=!1,wn=Re.key;if(!(Re.altKey||Re.currentTarget!==Re.target)){var Ln=Re.ctrlKey||Re.metaKey;switch(wn){case" ":br.current===Re.currentTarget&&(sn&&Re.shiftKey?ai=Ri(Re,{end:De}):sn?ai=un(Re,De,!0):ai=un(Re,De)),Re.stopPropagation();break;case"Enter":br.current===Re.currentTarget&&Jn&&(Bi(Re),ai=!0),Re.stopPropagation();break;case"ArrowDown":sn&&Re.shiftKey&&nr(Re,De),Mn(De),ai=!0;break;case"ArrowUp":sn&&Re.shiftKey&&Fr(Re,De),ir(De),ai=!0;break;case"ArrowRight":Dn.direction==="rtl"?ai=Qr(Re):ai=Ft(Re);break;case"ArrowLeft":Dn.direction==="rtl"?ai=Ft(Re):ai=Qr(Re);break;case"Home":sn&&Ln&&Re.shiftKey&&vn(Re,De),Wi(),ai=!0;break;case"End":sn&&Ln&&Re.shiftKey&&qr(Re,De),ji(),ai=!0;break;default:wn==="*"?(Ii(Re,De),ai=!0):sn&&Ln&&wn.toLowerCase()==="a"?ai=rr(Re):!Ln&&!Re.shiftKey&&Fn(wn)&&(li(De,wn),ai=!0)}ai&&(Re.preventDefault(),Re.stopPropagation()),ni&&ni(Re)}},Sr=function(Re){!lr&&Re.currentTarget===Re.target&&oi(De),Pt&&Pt(Re)};p.useEffect(function(){if(or){var _i=[];p.Children.forEach(te,function(Re){p.isValidElement(Re)&&Re.props.nodeId&&_i.push(Re.props.nodeId)}),or(De,_i)}},[te,De,or]),p.useEffect(function(){if(vr)return function(){vr(De)}},[De,vr]),p.useEffect(function(){Bn&&Ue&&Bn(De,xr.current.textContent.substring(0,1).toLowerCase())},[Bn,De,Ue]),p.useEffect(function(){lr&&br.current.focus()},[lr]);var kr;return sn?kr=ar:ar&&(kr=!0),p.createElement("li",(0,qe.Z)({className:(0,vi.default)(he.root,ue,Un&&he.expanded,ar&&he.selected),role:"treeitem",onKeyDown:wr,onFocus:Sr,"aria-expanded":Jn?Un:null,"aria-selected":kr,ref:Qi,tabIndex:ps?0:-1},Ui),p.createElement("div",{className:he.content,onClick:mi,onMouseDown:pn,ref:xr},p.createElement("div",{onClick:je,className:he.iconContainer},En),p.createElement(vt.Z,{onClick:At,component:"div",className:he.label},Ue)),te&&p.createElement(Pi,(0,qe.Z)({unmountOnExit:!0,className:he.group,in:Un,component:"ul",role:"group"},Ji),te))});const a=(0,tn.Z)(qn,{name:"MuiTreeItem"})(R);var d=q(52160),v=q(31377),x=q(34546),E=q(31625),D=q(16874),V=q(19126),j=q.n(V),ne=q(73557),fe=q(70218);const ve=({error:z})=>{const H=(0,p.useRef)("");return(0,p.useEffect)(()=>{H.current=String(Math.random())},[z]),z?p.createElement(G.Z,null,p.createElement(ke.SX,{id:H.current,variant:"warning",message:z.message})):null},Le=(0,Ce.Z)({svgIcon:{display:"inline-block","& svg":{display:"inline-block",fontSize:"inherit",verticalAlign:"baseline"}}}),Pe=z=>{const{href:H,text:Q,Icon:te,...he}=z,ue=Le();return p.createElement(Ie.Z,{container:!0,direction:"row",spacing:1},p.createElement(Ie.Z,{item:!0},p.createElement(vt.Z,{component:"div",className:ue.svgIcon},te?p.createElement(te,null):p.createElement(d.Z,null))),p.createElement(Ie.Z,{item:!0},p.createElement(ke.rU,{to:H,...he},Q||H)))},Gt=({output:z})=>{const{links:H=[]}=z,Q=(0,oe.qD)(),te=(0,oe.tg)(Dt.wi),he=ue=>{var be;return ue&&(be=Q.getSystemIcon(ue))!=null?be:d.Z};return p.createElement(G.Z,{px:3,pb:3},H.filter(({url:ue,entityRef:be})=>ue||be).map(({url:ue,entityRef:be,title:Ne,icon:Mt})=>{if(be){const yt=(0,kt.of)(be,{defaultKind:"<unknown>",defaultNamespace:"<unknown>"}),Ue=te(yt);return{title:Ne,icon:Mt,url:Ue}}return{title:Ne,icon:Mt,url:ue}}).map(({url:ue,title:be,icon:Ne},Mt)=>p.createElement(Pe,{key:`output-link-${Mt}`,href:ue,text:be!=null?be:ue,Icon:he(Ne),target:"_blank"})))},pi=(0,Ce.Z)(z=>(0,ie.Z)({root:{width:"100%"},button:{marginBottom:z.spacing(2),marginLeft:z.spacing(2)},actionsContainer:{marginBottom:z.spacing(2)},resetContainer:{padding:z.spacing(3)},labelWrapper:{display:"flex",flex:1,flexDirection:"row",justifyContent:"space-between"},stepWrapper:{width:"100%"}})),bi=({step:z})=>{const[H,Q]=(0,p.useState)("");return(0,fe.Z)(()=>{if(!z.startedAt){Q("");return}const te=z.endedAt?et.ou.fromISO(z.endedAt):et.ou.local(),he=et.ou.fromISO(z.startedAt),ue=et.Xp.fromDateTimes(he,te).toDuration().valueOf();Q(Rt()(ue,{round:!0}))},1e3),p.createElement(vt.Z,{variant:"caption"},H)},jn=(0,Ce.Z)(z=>(0,ie.Z)({root:{color:z.palette.text.disabled,display:"flex",height:22,alignItems:"center"},completed:{color:z.palette.status.ok},error:{color:z.palette.status.error}}));function mn(z){const H=jn(),{active:Q,completed:te,error:he}=z,ue=()=>Q?p.createElement(dt.Z,{size:"24px"}):te?p.createElement(ot.Z,null):he?p.createElement(st.Z,null):p.createElement(D.Z,null);return p.createElement("div",{className:Ge()(H.root,{[H.completed]:te,[H.error]:he})},ue())}const Pn=(0,p.memo)(z=>{const{steps:H,currentStepId:Q,onUserStepChange:te}=z,he=pi(z);return p.createElement("div",{className:he.root},p.createElement(E.Z,{activeStep:H.findIndex(ue=>ue.id===Q),orientation:"vertical",nonLinear:!0},H.map((ue,be)=>{const Ne=ue.status==="cancelled",Mt=ue.status==="processing",yt=ue.status==="completed",Ue=ue.status==="failed",De=ue.status==="skipped";return p.createElement(v.Z,{key:String(be),expanded:!0},p.createElement(bt.Z,{onClick:()=>te(ue.id)},p.createElement(x.Z,{StepIconProps:{completed:yt,error:Ue||Ne,active:Mt},StepIconComponent:mn,className:he.stepWrapper},p.createElement("div",{className:he.labelWrapper},p.createElement(vt.Z,{variant:"subtitle2"},ue.name),De?p.createElement(vt.Z,{variant:"caption"},"Skipped"):p.createElement(bi,{step:ue})))))})))}),qt=({links:z=[]})=>z.length>0,Rr=z=>{const{loadingText:H}=z,Q=pi(),te=(0,ne.s0)(),he=(0,oe.tg)(Fe.r),ue=(0,ye.u)(de.s),be=(0,oe.tg)(Fe.o),[Ne,Mt]=(0,p.useState)(void 0),[yt,Ue]=(0,p.useState)(!1),[De,Ae]=(0,p.useState)(void 0),{taskId:At}=(0,oe.Oi)(Fe.w),je=(0,L.WQ)(At),Pt=je.completed,ni=je.cancelled,Zt=(0,p.useMemo)(()=>{var oi,Wi;return(Wi=(oi=je.task)==null?void 0:oi.spec.steps.map(ji=>{var Mn;return{...ji,...(Mn=je==null?void 0:je.steps)==null?void 0:Mn[ji.id]}}))!=null?Wi:[]},[je]);(0,p.useEffect)(()=>{var oi;const Wi=Zt.find(ji=>["failed","processing"].includes(ji.status));if(Pt&&!Wi){Ae((oi=Zt[Zt.length-1])==null?void 0:oi.id);return}Ae(Wi==null?void 0:Wi.id)},[Zt,Pt]);const Fi=Ne!=null?Ne:De,Pi=(0,p.useMemo)(()=>{if(!Fi)return H||"Loading...";const oi=je.stepLogs[Fi];return oi!=null&&oi.length?oi.join(`
`):"Waiting for logs..."},[je.stepLogs,Fi,H]),Ji=je.completed&&!je.loading&&!je.task,{output:Ui}=je,Nt=()=>{var oi,Wi,ji;if(!je.task||!((Wi=(oi=je.task)==null?void 0:oi.spec.templateInfo)!=null&&Wi.entityRef)){te(he());return}const Mn=je.task.spec.parameters,{name:ir,namespace:li}=(0,kt.of)((ji=je.task.spec.templateInfo)==null?void 0:ji.entityRef);te(`${be({templateName:ir,namespace:li})}?${j().stringify({formData:JSON.stringify(Mn)})}`)},Tn=async()=>{Ue(!0),await ue.cancelTask(At)};return p.createElement(ke.T3,{themeId:"home"},p.createElement(ke.h4,{pageTitleOverride:`Task ${At}`,title:"Task Activity",subtitle:`Activity for task: ${At}`}),p.createElement(ke.VY,null,Ji?p.createElement(ke.mf,{status:"404",statusMessage:"Task not found",additionalInfo:"No task found with this ID"}):p.createElement("div",null,p.createElement(Ie.Z,{container:!0},p.createElement(Ie.Z,{item:!0,xs:3},p.createElement($e.Z,null,p.createElement(Pn,{steps:Zt,currentStepId:Fi,onUserStepChange:Mt}),Ui&&qt(Ui)&&p.createElement(Gt,{output:Ui}),p.createElement(nt.Z,{className:Q.button,onClick:Nt,disabled:!Pt,variant:"contained",color:"primary"},"Start Over"),p.createElement(nt.Z,{className:Q.button,onClick:Tn,disabled:Pt||ni||yt,variant:"outlined",color:"secondary"},(ni||yt)&&!Pt?"Cancelling...":"Cancel"))),p.createElement(Ie.Z,{item:!0,xs:9},!Fi&&p.createElement(ke.Ex,null),p.createElement("div",{style:{height:"80vh"}},p.createElement(ve,{error:je.error}),p.createElement(ke.nU,{text:Pi})))))))},Br=(0,Ce.Z)(z=>({code:{fontFamily:"Menlo, monospace",padding:z.spacing(1),backgroundColor:z.palette.type==="dark"?z.palette.grey[700]:z.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${z.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:z.spacing(.5),fontWeight:"bolder",color:z.palette.error.light}}})),Jr=z=>p.createElement(Ie.Z,{container:!0},z.examples.map((H,Q)=>p.createElement(p.Fragment,{key:`example-${Q}`},p.createElement(Ie.Z,{item:!0,lg:3},p.createElement(G.Z,{padding:4},p.createElement(vt.Z,null,H.description))),p.createElement(Ie.Z,{item:!0,lg:9},p.createElement(G.Z,{padding:1},p.createElement(ke.Oi,{text:H.example,showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})))))),dr=()=>{const z=(0,ye.u)(de.s),H=Br(),{loading:Q,value:te,error:he}=(0,Se.default)(async()=>z.listActions()),[ue,be]=(0,p.useState)({});if(Q)return p.createElement(ke.Ex,null);if(he)return p.createElement(ke.mf,{statusMessage:"Failed to load installed actions",status:"500"});const Ne=Ae=>!Ae||Ae.length<1?p.createElement(vt.Z,null,"No schema defined"):p.createElement(_e.Z,{component:$e.Z},p.createElement(mt.Z,{size:"small"},p.createElement(yi.Z,null,p.createElement(Xt.Z,null,p.createElement(me.Z,null,"Name"),p.createElement(me.Z,null,"Title"),p.createElement(me.Z,null,"Description"),p.createElement(me.Z,null,"Type"))),p.createElement(pt.Z,null,Ae))),Mt=Ae=>{var At,je;return Ae.type?Ae.type!=="array"?[Ae.type].flat():[`${Ae.type}(${(je=(At=Ae.items)==null?void 0:At.type)!=null?je:"unknown"})`]:["unknown"]},yt=(Ae,At)=>{const je=At==null?void 0:At.properties;if(je)return Object.entries(je).map(Pt=>{var ni,Zt,Fi;const[Pi]=Pt,Ji=`${Ae}.${Pi}`,Ui=Pt[1],Nt=Ge()(H.code,{[H.codeRequired]:(ni=At.required)==null?void 0:ni.includes(Pi)}),Tn=Mt(Ui);return p.createElement(p.Fragment,{key:Ji},p.createElement(Xt.Z,{key:Ji},p.createElement(me.Z,null,p.createElement("div",{className:Nt},Pi)),p.createElement(me.Z,null,Ui.title),p.createElement(me.Z,null,Ui.description),p.createElement(me.Z,null,Tn.map(oi=>oi.includes("object")?p.createElement(Me.Z,{label:oi,key:oi,icon:ue[Ji]?p.createElement(Xe.Z,null):p.createElement(ki.Z,null),variant:"outlined",onClick:()=>be(Wi=>{const ji={...Wi};return ji[Ji]=!Wi[Ji],ji})}):p.createElement(Me.Z,{label:oi,key:oi,variant:"outlined"})))),p.createElement(Xt.Z,null,p.createElement(me.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6},p.createElement(Kt.Z,{in:ue[Ji],timeout:"auto",unmountOnExit:!0},p.createElement(G.Z,{sx:{margin:1}},p.createElement(vt.Z,{variant:"h6",component:"div"},Pi),Ne(yt(Ji,Ui.type==="array"?{properties:(Fi=(Zt=Ui.items)==null?void 0:Zt.properties)!=null?Fi:{}}:Ui)))))))})},Ue=(Ae,At,je)=>{if(je)return p.createElement(p.Fragment,null,p.createElement(vt.Z,{variant:"h6",component:"h4"},Ae),je.map((Pt,ni)=>p.createElement("div",{key:ni},Ne(yt(`${At}.${ni}`,Pt)))))},De=te==null?void 0:te.map(Ae=>{var At,je,Pt,ni,Zt,Fi;if(Ae.id.startsWith("legacy:"))return;const Pi=Ue("oneOf",`${Ae.id}.input`,(je=(At=Ae.schema)==null?void 0:At.input)==null?void 0:je.oneOf);return p.createElement(G.Z,{pb:4,key:Ae.id},p.createElement(vt.Z,{variant:"h4",component:"h2",className:H.code},Ae.id),Ae.description&&p.createElement(ke.SA,{content:Ae.description}),((Pt=Ae.schema)==null?void 0:Pt.input)&&p.createElement(G.Z,{pb:2},p.createElement(vt.Z,{variant:"h5",component:"h3"},"Input"),Ne(yt(`${Ae.id}.input`,(ni=Ae==null?void 0:Ae.schema)==null?void 0:ni.input)),Pi),((Zt=Ae.schema)==null?void 0:Zt.output)&&p.createElement(G.Z,{pb:2},p.createElement(vt.Z,{variant:"h5",component:"h3"},"Output"),Ne(yt(`${Ae.id}.output`,(Fi=Ae==null?void 0:Ae.schema)==null?void 0:Fi.output))),Ae.examples&&p.createElement(wi.Z,null,p.createElement(ui.Z,{expandIcon:p.createElement(ki.Z,null)},p.createElement(vt.Z,{variant:"h5",component:"h3"},"Examples")),p.createElement(Et.Z,null,p.createElement(G.Z,{pb:2},p.createElement(Jr,{examples:Ae.examples})))))});return p.createElement(ke.T3,{themeId:"home"},p.createElement(ke.h4,{pageTitleOverride:"Create a New Component",title:"Installed actions",subtitle:"This is the collection of all installed actions"}),p.createElement(ke.VY,null,De))},Lr=[{component:Fe.y,name:"EntityPicker",schema:Fe.z},{component:Fe.A,name:"EntityNamePicker",validation:Fe.B,schema:Fe.C},{component:Fe.D,name:"EntityTagsPicker",schema:Fe.F},{component:Fe.G,name:"RepoUrlPicker",validation:Fe.i,schema:Fe.H},{component:Fe.I,name:"OwnerPicker",schema:Fe.J},{component:Fe.K,name:"OwnedEntityPicker",schema:Fe.N},{component:Fe.P,name:"MyGroupsPicker",schema:Fe.l}],pr=(0,Ce.Z)(z=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:z.spacing(1,0,1,0)},title:{margin:z.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:z.palette.text.primary},menuItem:{minHeight:z.spacing(6)},groupWrapper:{margin:z.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"});function Rn(){return[{name:"Task Owner",items:[{id:"owned",label:"Owned",icon:lt.Z},{id:"all",label:"All",icon:Qt.Z}]}]}const Qn=z=>{const{filter:H,onSelectOwner:Q}=z,te=pr(),he=Rn();return p.createElement(ii.Z,{className:te.root},he.map(ue=>p.createElement(p.Fragment,{key:ue.name},p.createElement(vt.Z,{variant:"subtitle2",component:"span",className:te.title},ue.name),p.createElement(ii.Z,{className:te.groupWrapper},p.createElement(Di.Z,{disablePadding:!0,dense:!0,role:"menu"},ue.items.map(be=>p.createElement(Jt.Z,{key:be.id,divider:!0,ContainerProps:{role:"menuitem"},onClick:()=>Q(be.id),selected:be.id===H,className:te.menuItem,"data-testid":`owner-picker-${be.id}`},be.icon&&p.createElement(Ot.Z,{className:te.listIcon},p.createElement(be.icon,{fontSize:"small"})),p.createElement(Tt.Z,null,p.createElement(vt.Z,{variant:"body1"},be.label)))))))))},O=({createdAt:z})=>{const H=et.ou.fromISO(z),Q=et.Xp.fromDateTimes(H,et.ou.local()).toDuration().valueOf();return p.createElement(vt.Z,{paragraph:!0},Rt()(Q,{round:!0})," ago")},g=({entityRef:z})=>{var H,Q,te;const he=(0,ye.u)(Dt.Ah),{value:ue,loading:be,error:Ne}=(0,Se.default)(()=>he.getEntityByRef(z||""),[he,z]);return z?be||Ne?null:p.createElement(Dt.dx,{entityRef:(0,kt.of)(z),title:(te=(Q=(H=ue==null?void 0:ue.spec)==null?void 0:H.profile)==null?void 0:Q.displayName)!=null?te:ue==null?void 0:ue.metadata.name}):p.createElement(vt.Z,{paragraph:!0},"Unknown")},S=({status:z})=>{switch(z){case"processing":return p.createElement(ke.wA,null,z);case"completed":return p.createElement(ke.Kq,null,z);case"error":default:return p.createElement(ke.vK,null,z)}},P=({entityRef:z})=>{const H=(0,ye.u)(de.s),{value:Q,loading:te,error:he}=(0,Se.default)(()=>H.getTemplateParameterSchema(z||""),[H,z]);return te||he||!z?null:p.createElement(Dt.dx,{entityRef:(0,kt.of)(z),title:Q==null?void 0:Q.title})},W=z=>{var H;const{initiallySelectedFilter:Q="owned"}=z,te=(0,ye.u)(de.s),he=(0,oe.tg)(Fe.r),[ue,be]=(0,p.useState)(Q),{value:Ne,loading:Mt,error:yt}=(0,Se.default)(()=>{var Ue;return te.listTasks?(Ue=te.listTasks)==null?void 0:Ue.call(te,{filterByOwnership:ue}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[]}))},[te,ue]);return Mt?p.createElement(ke.Ex,null):yt?p.createElement(p.Fragment,null,p.createElement(ke.yu,{error:yt}),p.createElement(ke.ub,{missing:"info",title:"No information to display",description:"There is no Tasks or there was an issue communicating with backend."})):p.createElement(Dt._i,null,p.createElement(Dt._i.Filters,null,p.createElement(Qn,{filter:ue,onSelectOwner:Ue=>be(Ue)})),p.createElement(Dt._i.Content,null,p.createElement(ke.iA,{data:(H=Ne==null?void 0:Ne.tasks)!=null?H:[],title:"Tasks",columns:[{title:"Task ID",field:"id",render:Ue=>p.createElement(ke.rU,{to:`${he()}/tasks/${Ue.id}`},Ue.id)},{title:"Template",render:Ue=>{var De;return p.createElement(P,{entityRef:(De=Ue.spec.templateInfo)==null?void 0:De.entityRef})}},{title:"Created",field:"createdAt",render:Ue=>p.createElement(O,{createdAt:Ue.createdAt})},{title:"Owner",field:"createdBy",render:Ue=>{var De,Ae;return p.createElement(g,{entityRef:(Ae=(De=Ue.spec)==null?void 0:De.user)==null?void 0:Ae.ref})}},{title:"Status",field:"status",render:Ue=>p.createElement(S,{status:Ue.status})}]})))},K=z=>p.createElement(ke.T3,{themeId:"home"},p.createElement(ke.h4,{pageTitleOverride:"Templates Tasks",title:p.createElement(p.Fragment,null,"List template tasks ",p.createElement(ke.Fw,{shorthand:!0,alpha:!0})),subtitle:"All tasks that have been started"}),p.createElement(ke.VY,null,p.createElement(W,{...z}))),U=window.showDirectoryPicker;class ce{constructor(H,Q){this.path=H,this.handle=Q}file(){return this.handle.getFile()}async save(H){const Q=await this.handle.createWritable();await Q.write(H),await Q.close()}}class ae{constructor(H){this.handle=H}async listFiles(){const H=[];for await(const Q of this.listDirectoryContents(this.handle))H.push(Q);return H}async*listDirectoryContents(H,Q=[]){for await(const te of H.values())if(te.kind==="file")yield new ce([...Q,te.name].join("/"),te);else if(te.kind==="directory"){if(te.name===".git")continue;yield*this.listDirectoryContents(te,[...Q,te.name])}}}class Ee{static isSupported(){return Boolean(U)}static async requestDirectoryAccess(){if(!U)throw new Error("File system access is not supported");const H=await U();return new ae(H)}constructor(){}}const Ve=(0,Ce.Z)(z=>({introText:{textAlign:"center",marginTop:z.spacing(2)},card:{position:"relative",maxWidth:340,marginTop:z.spacing(4),margin:z.spacing(0,2)},infoIcon:{position:"absolute",top:z.spacing(1),right:z.spacing(1)}}));function jt(z){const H=Ve(),Q=Ee.isSupported(),te=p.createElement(ii.Z,{className:H.card,elevation:4},p.createElement(_t.Z,{disabled:!Q,onClick:()=>{var be;return(be=z.onSelect)==null?void 0:be.call(z,"local")}},p.createElement(Xi.Z,null,p.createElement(vt.Z,{variant:"h4",component:"h3",gutterBottom:!0,color:Q?void 0:"textSecondary",style:{display:"flex",flexFlow:"row nowrap"}},"Load Template Directory"),p.createElement(vt.Z,{variant:"body1",color:Q?void 0:"textSecondary"},"Load a local template directory, allowing you to both edit and try executing your own template."))),!Q&&p.createElement("div",{className:H.infoIcon},p.createElement(ct.ZP,{placement:"top",title:"Only supported in some Chromium-based browsers"},p.createElement(hn.Z,null)))),he=p.createElement(ii.Z,{className:H.card,elevation:4},p.createElement(_t.Z,{onClick:()=>{var be;return(be=z.onSelect)==null?void 0:be.call(z,"form")}},p.createElement(Xi.Z,null,p.createElement(vt.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Edit Template Form"),p.createElement(vt.Z,{variant:"body1"},"Preview and edit a template form, either using a sample template or by loading a template from the catalog.")))),ue=p.createElement(ii.Z,{className:H.card,elevation:4},p.createElement(_t.Z,{onClick:()=>{var be;return(be=z.onSelect)==null?void 0:be.call(z,"field-explorer")}},p.createElement(Xi.Z,null,p.createElement(vt.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Custom Field Explorer"),p.createElement(vt.Z,{variant:"body1"},"View and play around with available installed custom field extensions."))));return p.createElement("div",{style:z.style},p.createElement(vt.Z,{variant:"h4",component:"h2",className:H.introText},"Get started by choosing one of the options below"),p.createElement("div",{style:{display:"flex",flexFlow:"row wrap",alignItems:"flex-start",justifyContent:"center",alignContent:"flex-start"}},Q&&te,he,!Q&&te,ue))}var Ki=Object.defineProperty,Oi=(z,H,Q)=>H in z?Ki(z,H,{enumerable:!0,configurable:!0,writable:!0,value:Q}):z[H]=Q,gn=(z,H,Q)=>(Oi(z,typeof H!="symbol"?H+"":H,Q),Q),Cn=(z,H,Q)=>{if(!H.has(z))throw TypeError("Cannot "+Q)},It=(z,H,Q)=>(Cn(z,H,"read from private field"),Q?Q.call(z):H.get(z)),qi=(z,H,Q)=>{if(H.has(z))throw TypeError("Cannot add the same private member more than once");H instanceof WeakSet?H.add(z):H.set(z,Q)},yn=(z,H,Q,te)=>(Cn(z,H,"write to private field"),te?te.call(z,Q):H.set(z,Q),Q),_n,Zn,fn,mr,Ur,er,Wn,Hn,Ir;const os=1024*1024,Nr="This file is too large to be displayed";class Ms{constructor(H,Q){qi(this,_n,void 0),qi(this,Zn,void 0),qi(this,fn,void 0),qi(this,mr,void 0),yn(this,_n,H),yn(this,Zn,Q)}get path(){return It(this,_n).path}get content(){var H;return(H=It(this,fn))!=null?H:Nr}updateContent(H){It(this,fn)!==void 0&&(yn(this,fn,H),It(this,Zn).call(this))}get dirty(){return It(this,fn)!==It(this,mr)}async save(){It(this,fn)!==void 0&&(await It(this,_n).save(It(this,fn)),yn(this,mr,It(this,fn)),It(this,Zn).call(this))}async reload(){const H=await It(this,_n).file();if(H.size>os){It(this,fn)!==void 0&&(yn(this,fn,void 0),yn(this,mr,void 0),It(this,Zn).call(this));return}const Q=await H.text();It(this,fn)!==Q&&(yn(this,fn,Q),yn(this,mr,Q),It(this,Zn).call(this))}}_n=new WeakMap,Zn=new WeakMap,fn=new WeakMap,mr=new WeakMap;class io{constructor(H){qi(this,Ur,void 0),qi(this,er,new Set),qi(this,Wn,[]),qi(this,Hn,void 0),gn(this,"setSelectedFile",Q=>{const te=It(this,Hn),he=It(this,Wn).find(ue=>ue.path===Q);te!==he&&(yn(this,Hn,he),It(this,Ir).call(this))}),qi(this,Ir,()=>{It(this,er).forEach(Q=>Q())}),yn(this,Ur,H)}get files(){return It(this,Wn)}get selectedFile(){return It(this,Hn)}get dirty(){return It(this,Wn).some(H=>H.dirty)}async save(){await Promise.all(It(this,Wn).map(H=>H.save()))}async reload(){var H;const Q=(H=It(this,Hn))==null?void 0:H.path,te=await It(this,Ur).listFiles(),he=await Promise.all(te.map(async ue=>{const be=new Ms(ue,It(this,Ir));return await be.reload(),be}));It(this,Wn).length=0,It(this,Wn).push(...he),this.setSelectedFile(Q),It(this,Ir).call(this)}subscribe(H){return It(this,er).add(H),()=>{It(this,er).delete(H)}}}Ur=new WeakMap,er=new WeakMap,Wn=new WeakMap,Hn=new WeakMap,Ir=new WeakMap;const ls=(0,p.createContext)(void 0);function as(){const z=(0,p.useContext)(ls),H=He();if((0,p.useEffect)(()=>z==null?void 0:z.subscribe(H),[z,H]),!z)throw new Error("must be used within a DirectoryEditorProvider");return z}function Es(z){const{directory:H}=z,[{result:Q,error:te},{execute:he}]=(0,Oe.r)(async ue=>{const be=new io(ue);await be.reload();const Ne=be.files.find(Mt=>Mt.path.match(/\.ya?ml$/));return Ne&&be.setSelectedFile(Ne.path),be});return(0,p.useEffect)(()=>{he(H)},[he,H]),te?p.createElement(ke.yu,{error:te}):Q?p.createElement(ls.Provider,{value:Q},z.children):p.createElement(ke.Ex,null)}const hi=64*1024,Gr=32*1024,gr=(0,p.createContext)(void 0);function Vn(z){if(z.length>hi)return window.btoa("<file too large>");try{return window.btoa(z)}catch{const Q=new TextEncoder().encode(z),te=new Array;for(let he=0;he<Q.length;he+=Gr)te.push(String.fromCharCode(...Q.slice(he,he+Gr)));return window.btoa(te.join(""))}}function Ds(z){const H=(0,ye.u)(de.s),[Q,te]=(0,p.useState)({results:[],selectedResult:void 0}),he=(0,p.useRef)(1),ue=(0,p.useCallback)(yt=>{te(Ue=>{const De=Ue.results.find(Ae=>Ae.id===yt);return De===Ue.selectedResult?Ue:{results:Ue.results,selectedResult:De}})},[]),be=(0,p.useCallback)(yt=>{te(Ue=>{var De;const Ae=Ue.results.findIndex(Pt=>Pt.id===yt);if(Ae===-1)return Ue;const At=Ue.results.slice(),[je]=At.splice(Ae,1);return{results:At,selectedResult:((De=Ue.selectedResult)==null?void 0:De.id)===je.id?At[0]:Ue.selectedResult}})},[]),Ne=(0,p.useCallback)(async yt=>{if(!H.dryRun)throw new Error("Scaffolder API does not support dry-run");const Ue=Ye.ZP.parse(yt.templateContent),Ae={...await H.dryRun({template:Ue,values:yt.values,secrets:{},directoryContents:yt.files.map(At=>({path:At.path,base64Content:Vn(At.content)}))}),id:he.current++};te(At=>{var je;return{results:[...At.results,Ae],selectedResult:(je=At.selectedResult)!=null?je:Ae}})},[H]),Mt=(0,p.useMemo)(()=>({...Q,selectResult:ue,deleteResult:be,execute:Ne}),[Q,ue,be,Ne]);return p.createElement(gr.Provider,{value:Mt},z.children)}function Kn(){const z=(0,p.useContext)(gr);if(!z)throw new Error("must be used within a DryRunProvider");return z}const Os=(0,Ce.Z)({root:{whiteSpace:"nowrap",overflowY:"auto"}});function hs(z){const H={type:"directory",name:"",path:"",children:[]};for(const Q of z.slice().sort()){const te=Q.split("/");let he=H;for(let ue=0;ue<te.length;ue++){const be=te[ue];if(be==="")throw new Error("Invalid path part: ''");const Ne=te.slice(0,ue+1).join("/"),Mt=he.children.find(yt=>yt.name===be);if((Mt==null?void 0:Mt.type)==="file")throw new Error(`Duplicate filename at '${Ne}'`);if(Mt)he=Mt;else if(ue<te.length-1){const yt={type:"directory",name:be,path:Ne,children:[]},Ue=he.children.findIndex(De=>De.type==="file");he.children.splice(Ue,0,yt),he=yt}else he.children.push({type:"file",name:be,path:Ne})}}return H.children}function tr({entry:z}){return z.type==="file"?p.createElement(a,{nodeId:z.path,label:z.name}):p.createElement(a,{nodeId:z.path,label:z.name},z.children.map(H=>p.createElement(tr,{key:H.path,entry:H})))}function cs(z){const H=Os(),Q=(0,p.useMemo)(()=>hs(z.filePaths),[z.filePaths]);return p.createElement($n,{selected:z.selected,className:H.root,defaultCollapseIcon:p.createElement(ki.Z,null),defaultExpandIcon:p.createElement(cn.Z,null),onNodeSelect:(te,he)=>{z.onSelect&&z.filePaths.includes(he)&&z.onSelect(he)}},Q.map(te=>p.createElement(tr,{key:te.path,entry:te})))}const An=(0,Ce.Z)(z=>({button:{padding:z.spacing(1)},buttons:{display:"flex",flexFlow:"row nowrap",alignItems:"center",justifyContent:"flex-start"},buttonsGap:{flex:"1 1 auto"},buttonsDivider:{marginBottom:z.spacing(1)}}));function rn(z){var H,Q;const te=An(),he=as(),ue=he.files.filter(Ne=>Ne.dirty),be=()=>{z.onClose&&(ue.length>0&&!window.confirm("Are you sure? Unsaved changes will be lost")||z.onClose())};return p.createElement(p.Fragment,null,p.createElement("div",{className:te.buttons},p.createElement(ct.ZP,{title:"Save all files"},p.createElement(Yt.Z,{className:te.button,disabled:he.files.every(Ne=>!Ne.dirty),onClick:()=>he.save()},p.createElement(N.Z,null))),p.createElement(ct.ZP,{title:"Reload directory"},p.createElement(Yt.Z,{className:te.button,onClick:()=>he.reload()},p.createElement(C.Z,null))),p.createElement("div",{className:te.buttonsGap}),p.createElement(ct.ZP,{title:"Close directory"},p.createElement(Yt.Z,{className:te.button,onClick:be},p.createElement(w.Z,null)))),p.createElement(ri.Z,{className:te.buttonsDivider}),p.createElement(cs,{selected:(Q=(H=he.selectedFile)==null?void 0:H.path)!=null?Q:"",onSelect:he.setSelectedFile,filePaths:he.files.map(Ne=>Ne.path)}))}const Xr=(0,Ce.Z)(z=>({container:{position:"relative",width:"100%",height:"100%"},codeMirror:{position:"absolute",top:0,bottom:0,left:0,right:0},errorPanel:{color:z.palette.error.main,lineHeight:2,margin:z.spacing(0,1)},floatingButtons:{position:"absolute",top:z.spacing(1),right:z.spacing(3)},floatingButton:{padding:z.spacing(1)}}));function yr(z){const{errorText:H}=z,Q=Xr(),te=(0,p.useMemo)(()=>{if(!H)return ee.mH.of(null);const he=document.createElement("div");return he.classList.add(Q.errorPanel),he.textContent=H,ee.mH.of(()=>({dom:he,bottom:!0}))},[Q,H]);return Bt(he=>he.key==="s"&&(he.ctrlKey||he.metaKey),he=>{he.preventDefault(),z.onSave&&z.onSave()}),p.createElement("div",{className:Q.container},p.createElement(it.ZP,{className:Q.codeMirror,theme:"dark",height:"100%",extensions:[I.il.define(Z.r),te],value:z.content,onChange:z.onUpdate}),(z.onSave||z.onReload)&&p.createElement("div",{className:Q.floatingButtons},p.createElement($e.Z,null,z.onSave&&p.createElement(ct.ZP,{title:"Save file"},p.createElement(Yt.Z,{className:Q.floatingButton,onClick:()=>{var he;return(he=z.onSave)==null?void 0:he.call(z)}},p.createElement(N.Z,null))),z.onReload&&p.createElement(ct.ZP,{title:"Reload file"},p.createElement(Yt.Z,{className:Q.floatingButton,onClick:()=>{var he;return(he=z.onReload)==null?void 0:he.call(z)}},p.createElement(C.Z,null))))))}function fs(z){var H,Q;const te=as(),he=(H=te.selectedFile)!=null&&H.dirty?{onSave:()=>te.save(),onReload:()=>te.reload()}:{onReload:()=>te.reload()};return p.createElement(yr,{errorText:z.errorText,content:(Q=te.selectedFile)==null?void 0:Q.content,onUpdate:ue=>{var be;return(be=te.selectedFile)==null?void 0:be.updateContent(ue)},...he})}yr.DirectoryEditor=fs;function Ps(z,H){const Q=document.createElement("a");Q.href=URL.createObjectURL(z),Q.download=H,Q.click(),URL.revokeObjectURL(Q.href),Q.remove()}const Rs=(0,Ce.Z)(z=>({root:{overflowY:"auto",background:z.palette.background.default},iconSuccess:{minWidth:0,marginRight:z.spacing(1),color:z.palette.status.ok},iconFailure:{minWidth:0,marginRight:z.spacing(1),color:z.palette.status.error}}));function Bs(){const z=Rs(),H=Kn();return p.createElement(Di.Z,{className:z.root,dense:!0},H.results.map(Q=>{var te;const he=Q.log.some(Ne=>Ne.body.status==="failed");let ue=!1;async function be(){ue=!0,await Ls(Q.directoryContents,`dry-run-result-${Q.id}.zip`),ue=!1}return p.createElement(We.Z,{button:!0,key:Q.id,selected:((te=H.selectedResult)==null?void 0:te.id)===Q.id,onClick:()=>H.selectResult(Q.id)},p.createElement(Ot.Z,{className:he?z.iconFailure:z.iconSuccess},he?p.createElement(st.Z,null):p.createElement(ot.Z,null)),p.createElement(Tt.Z,{primary:`Result ${Q.id}`}),p.createElement(Ut.Z,null,p.createElement(Yt.Z,{edge:"end","aria-label":"download",title:"Download as .zip",disabled:ue,onClick:()=>be()},p.createElement(at.Z,null)),p.createElement(Yt.Z,{edge:"end","aria-label":"delete",title:"Delete result",onClick:()=>H.deleteResult(Q.id)},p.createElement(gt.Z,null))))}))}async function Ls(z,H){const{default:Q}=await q.e(1297).then(q.t.bind(q,1297,23)),te=new Q;for(const ue of z){const be=atob(ue.base64Content);await te.file(ue.path,be)}const he=await te.generateAsync({type:"blob"});Ps(he,H)}const Is=(0,Ce.Z)(z=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:z.palette.background.paper}}));function us(z){const H=Is(),Q=p.Children.toArray(z.children);if(Q.length!==2)throw new Error("must have exactly 2 children");return p.createElement("div",{className:H.root},p.createElement("div",{className:Ge()(H.child,H.firstChild)},Q[0]),p.createElement(ri.Z,{orientation:"horizontal"}),p.createElement("div",{className:H.child},Q[1]))}const Yr=(0,Ce.Z)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function ds(){const z=Yr(),{selectedResult:H}=Kn(),[Q,te]=(0,p.useState)(""),he=H==null?void 0:H.directoryContents.find(ue=>ue.path===Q);return(0,p.useEffect)(()=>{if(H){const[ue]=H.directoryContents;te(ue?ue.path:"")}},[H]),H?p.createElement(us,null,p.createElement(cs,{selected:Q,onSelect:te,filePaths:H.directoryContents.map(ue=>ue.path)}),p.createElement(it.ZP,{className:z.codeMirror,theme:"dark",height:"100%",extensions:[I.il.define(Z.r)],readOnly:!0,value:he!=null&&he.base64Content?atob(he.base64Content):""})):null}function Ns(){var z,H;const{selectedResult:Q}=Kn(),[te,he]=(0,p.useState)(),ue=(0,p.useMemo)(()=>{var Ne;return Q?(Ne=Q.steps.map(Mt=>{var yt,Ue;const De=Q.log.filter(Ae=>Ae.body.stepId===Mt.id);return{id:Mt.id,name:Mt.name,logString:De.map(Ae=>Ae.body.message).join(`
`),status:(Ue=(yt=De[De.length-1])==null?void 0:yt.body.status)!=null?Ue:"completed"}}))!=null?Ne:[]:[]},[Q]);if(!Q)return null;const be=(z=ue.find(Ne=>Ne.id===te))!=null?z:ue[0];return p.createElement(us,null,p.createElement(Pn,{steps:ue,currentStepId:be.id,onUserStepChange:he}),p.createElement(ke.nU,{text:(H=be==null?void 0:be.logString)!=null?H:""}))}function Fs(){var z,H;const Q=Yr(),{selectedResult:te}=Kn();return te?p.createElement(us,null,p.createElement(G.Z,{pt:2},((H=(z=te.output)==null?void 0:z.links)==null?void 0:H.length)&&p.createElement(Gt,{output:te.output})),p.createElement(it.ZP,{className:Q.codeMirror,theme:"dark",height:"100%",extensions:[I.il.define(Z.r)],readOnly:!0,value:JSON.stringify(te.output,null,2)})):null}function no(){const z=Yr(),[H,Q]=(0,p.useState)("files");return p.createElement("div",{className:z.root},p.createElement($t.Z,{value:H,onChange:(te,he)=>Q(he)},p.createElement(Lt.Z,{value:"files",label:"Files"}),p.createElement(Lt.Z,{value:"log",label:"Log"}),p.createElement(Lt.Z,{value:"output",label:"Output"})),p.createElement(ri.Z,null),p.createElement("div",{className:z.contentWrapper},p.createElement("div",{className:z.content},H==="files"&&p.createElement(ds,null),H==="log"&&p.createElement(Ns,null),H==="output"&&p.createElement(Fs,null))))}const ro=(0,Ce.Z)(z=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:z.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function Ws(){const z=ro(),H=Kn(),[Q,te]=(0,p.useState)(!1),[he,ue]=(0,p.useState)(!0),be=H.results.length,Ne=Ci(be);return(0,p.useEffect)(()=>{Ne===0&&be===1?(ue(!1),te(!0)):Ne===1&&be===0&&te(!1)},[Ne,be]),p.createElement(p.Fragment,null,p.createElement(wi.Z,{variant:"outlined",expanded:Q,hidden:be===0&&he,onChange:(Mt,yt)=>te(yt),onTransitionEnd:()=>be===0&&ue(!0)},p.createElement(ui.Z,{className:z.header,expandIcon:p.createElement(Xe.Z,null)},p.createElement(vt.Z,null,"Dry-run results")),p.createElement(ri.Z,{orientation:"horizontal"}),p.createElement(Et.Z,{className:z.content},p.createElement(Bs,null),p.createElement(ri.Z,{orientation:"horizontal"}),p.createElement(no,null))))}},22983:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");Wt.Z=Ce},84905:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");Wt.Z=Ce},16874:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord");Wt.Z=Ce},28113:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");Wt.Z=Ce},82726:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");Wt.Z=Ce},49423:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");Wt.Z=Ce},96401:(kn,Wt,q)=>{var p,Se=q(71600),de=q(34590);p={value:!0},Wt.Z=void 0;var L=de(q(2784)),G=Se(q(50175)),Ce=(0,G.default)(L.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");Wt.Z=Ce},2552:(kn,Wt,q)=>{q.d(Wt,{ZP:()=>cr});var p=q(7896),Se=q(31461),de=q(2784),L=q(1727),G=q(65329),Ce=q(77120),Ie=q(21649);const vt=o=>{let{state:i}=o,l=i.doc.lineAt(i.selection.main.from),h=me(o.state,l.from);return h.line?bt(o):h.block?Xt(o):!1};function dt(o,i){return({state:l,dispatch:h})=>{if(l.readOnly)return!1;let f=o(i,l);return f?(h(l.update(f)),!0):!1}}const bt=dt(Et,0),$e=null,nt=null,_e=dt(ui,0),mt=null,yi=null,Xt=dt((o,i)=>ui(o,i,wi(i)),0);function me(o,i){let l=o.languageDataAt("commentTokens",i);return l.length?l[0]:{}}const pt=50;function Kt(o,{open:i,close:l},h,f){let m=o.sliceDoc(h-pt,h),k=o.sliceDoc(f,f+pt),T=/\s*$/.exec(m)[0].length,B=/^\s*/.exec(k)[0].length,J=m.length-T;if(m.slice(J-i.length,J)==i&&k.slice(B,B+l.length)==l)return{open:{pos:h-T,margin:T&&1},close:{pos:f+B,margin:B&&1}};let Y,ge;f-h<=2*pt?Y=ge=o.sliceDoc(h,f):(Y=o.sliceDoc(h,h+pt),ge=o.sliceDoc(f-pt,f));let Be=/^\s*/.exec(Y)[0].length,ut=/\s*$/.exec(ge)[0].length,ti=ge.length-ut-l.length;return Y.slice(Be,Be+i.length)==i&&ge.slice(ti,ti+l.length)==l?{open:{pos:h+Be+i.length,margin:/\s/.test(Y.charAt(Be+i.length))?1:0},close:{pos:f-ut-l.length,margin:/\s/.test(ge.charAt(ti-1))?1:0}}:null}function wi(o){let i=[];for(let l of o.selection.ranges){let h=o.doc.lineAt(l.from),f=l.to<=h.to?h:o.doc.lineAt(l.to),m=i.length-1;m>=0&&i[m].to>h.from?i[m].to=f.to:i.push({from:h.from+/^\s*/.exec(h.text)[0].length,to:f.to})}return i}function ui(o,i,l=i.selection.ranges){let h=l.map(m=>me(i,m.from).block);if(!h.every(m=>m))return null;let f=l.map((m,k)=>Kt(i,h[k],m.from,m.to));if(o!=2&&!f.every(m=>m))return{changes:i.changes(l.map((m,k)=>f[k]?[]:[{from:m.from,insert:h[k].open+" "},{from:m.to,insert:" "+h[k].close}]))};if(o!=1&&f.some(m=>m)){let m=[];for(let k=0,T;k<f.length;k++)if(T=f[k]){let B=h[k],{open:J,close:Y}=T;m.push({from:J.pos-B.open.length,to:J.pos+J.margin},{from:Y.pos-Y.margin,to:Y.pos+B.close.length})}return{changes:m}}return null}function Et(o,i,l=i.selection.ranges){let h=[],f=-1;for(let{from:m,to:k}of l){let T=h.length,B=1e9,J=me(i,m).line;if(J){for(let Y=m;Y<=k;){let ge=i.doc.lineAt(Y);if(ge.from>f&&(m==k||k>ge.from)){f=ge.from;let Be=/^\s*/.exec(ge.text)[0].length,ut=Be==ge.length,ti=ge.text.slice(Be,Be+J.length)==J?Be:-1;Be<ge.text.length&&Be<B&&(B=Be),h.push({line:ge,comment:ti,token:J,indent:Be,empty:ut,single:!1})}Y=ge.to+1}if(B<1e9)for(let Y=T;Y<h.length;Y++)h[Y].indent<h[Y].line.text.length&&(h[Y].indent=B);h.length==T+1&&(h[T].single=!0)}}if(o!=2&&h.some(m=>m.comment<0&&(!m.empty||m.single))){let m=[];for(let{line:T,token:B,indent:J,empty:Y,single:ge}of h)(ge||!Y)&&m.push({from:T.from+J,insert:B+" "});let k=i.changes(m);return{changes:k,selection:i.selection.map(k,1)}}else if(o!=1&&h.some(m=>m.comment>=0)){let m=[];for(let{line:k,comment:T,token:B}of h)if(T>=0){let J=k.from+T,Y=J+B.length;k.text[Y-k.from]==" "&&Y++,m.push({from:J,to:Y})}return{changes:m}}return null}const ii=L.q6.define(),Di=L.q6.define(),Jt=L.r$.define(),Ot=L.r$.define({combine(o){return(0,L.BO)(o,{minDepth:100,newGroupDelay:500,joinToEvent:(i,l)=>l},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(i,l)=>(h,f)=>i(h,f)||l(h,f)})}}),Tt=L.QQ.define({create(){return ie.empty},update(o,i){let l=i.state.facet(Ot),h=i.annotation(ii);if(h){let B=Me.fromTransaction(i,h.selection),J=h.side,Y=J==0?o.undone:o.done;return B?Y=Fe(Y,Y.length,l.minDepth,B):Y=Rt(Y,i.startState.selection),new ie(J==0?h.rest:Y,J==0?Y:h.rest)}let f=i.annotation(Di);if((f=="full"||f=="before")&&(o=o.isolate()),i.annotation(L.YW.addToHistory)===!1)return i.changes.empty?o:o.addMapping(i.changes.desc);let m=Me.fromTransaction(i),k=i.annotation(L.YW.time),T=i.annotation(L.YW.userEvent);return m?o=o.addChanges(m,k,T,l,i):i.selection&&(o=o.addSelection(i.startState.selection,k,T,l.newGroupDelay)),(f=="full"||f=="after")&&(o=o.isolate()),o},toJSON(o){return{done:o.done.map(i=>i.toJSON()),undone:o.undone.map(i=>i.toJSON())}},fromJSON(o){return new ie(o.done.map(Me.fromJSON),o.undone.map(Me.fromJSON))}});function ct(o={}){return[Tt,Ot.of(o),G.tk.domEventHandlers({beforeinput(i,l){let h=i.inputType=="historyUndo"?Si:i.inputType=="historyRedo"?Ge:null;return h?(i.preventDefault(),h(l)):!1}})]}const Yt=null;function ri(o,i){return function({state:l,dispatch:h}){if(!i&&l.readOnly)return!1;let f=l.field(Tt,!1);if(!f)return!1;let m=f.pop(o,l,i);return m?(h(m),!0):!1}}const Si=ri(0,!1),Ge=ri(1,!1),ki=ri(0,!0),Xe=ri(1,!0);function oe(o){return function(i){let l=i.field(Tt,!1);if(!l)return 0;let h=o==0?l.done:l.undone;return h.length-(h.length&&!h[0].changes?1:0)}}const ye=null,ke=null;class Me{constructor(i,l,h,f,m){this.changes=i,this.effects=l,this.mapped=h,this.startSelection=f,this.selectionsAfter=m}setSelAfter(i){return new Me(this.changes,this.effects,this.mapped,this.startSelection,i)}toJSON(){var i,l,h;return{changes:(i=this.changes)===null||i===void 0?void 0:i.toJSON(),mapped:(l=this.mapped)===null||l===void 0?void 0:l.toJSON(),startSelection:(h=this.startSelection)===null||h===void 0?void 0:h.toJSON(),selectionsAfter:this.selectionsAfter.map(f=>f.toJSON())}}static fromJSON(i){return new Me(i.changes&&L.as.fromJSON(i.changes),[],i.mapped&&L.n0.fromJSON(i.mapped),i.startSelection&&L.jT.fromJSON(i.startSelection),i.selectionsAfter.map(L.jT.fromJSON))}static fromTransaction(i,l){let h=et;for(let f of i.startState.facet(Jt)){let m=f(i);m.length&&(h=h.concat(m))}return!h.length&&i.changes.empty?null:new Me(i.changes.invert(i.startState.doc),h,void 0,l||i.startState.selection,et)}static selection(i){return new Me(void 0,et,void 0,void 0,i)}}function Fe(o,i,l,h){let f=i+1>l+20?i-l-1:0,m=o.slice(f,i);return m.push(h),m}function Dt(o,i){let l=[],h=!1;return o.iterChangedRanges((f,m)=>l.push(f,m)),i.iterChangedRanges((f,m,k,T)=>{for(let B=0;B<l.length;){let J=l[B++],Y=l[B++];T>=J&&k<=Y&&(h=!0)}}),h}function lt(o,i){return o.ranges.length==i.ranges.length&&o.ranges.filter((l,h)=>l.empty!=i.ranges[h].empty).length===0}function Qt(o,i){return o.length?i.length?o.concat(i):o:i}const et=[],Li=200;function Rt(o,i){if(o.length){let l=o[o.length-1],h=l.selectionsAfter.slice(Math.max(0,l.selectionsAfter.length-Li));return h.length&&h[h.length-1].eq(i)?o:(h.push(i),Fe(o,o.length-1,1e9,l.setSelAfter(h)))}else return[Me.selection([i])]}function kt(o){let i=o[o.length-1],l=o.slice();return l[o.length-1]=i.setSelAfter(i.selectionsAfter.slice(0,i.selectionsAfter.length-1)),l}function _t(o,i){if(!o.length)return o;let l=o.length,h=et;for(;l;){let f=Xi(o[l-1],i,h);if(f.changes&&!f.changes.empty||f.effects.length){let m=o.slice(0,l);return m[l-1]=f,m}else i=f.mapped,l--,h=f.selectionsAfter}return h.length?[Me.selection(h)]:et}function Xi(o,i,l){let h=Qt(o.selectionsAfter.length?o.selectionsAfter.map(T=>T.map(i)):et,l);if(!o.changes)return Me.selection(h);let f=o.changes.map(i),m=i.mapDesc(o.changes,!0),k=o.mapped?o.mapped.composeDesc(m):m;return new Me(f,L.Py.mapEffects(o.effects,i),k,o.startSelection.map(m),h)}const hn=/^(input\.type|delete)($|\.)/;class ie{constructor(i,l,h=0,f=void 0){this.done=i,this.undone=l,this.prevTime=h,this.prevUserEvent=f}isolate(){return this.prevTime?new ie(this.done,this.undone):this}addChanges(i,l,h,f,m){let k=this.done,T=k[k.length-1];return T&&T.changes&&!T.changes.empty&&i.changes&&(!h||hn.test(h))&&(!T.selectionsAfter.length&&l-this.prevTime<f.newGroupDelay&&f.joinToEvent(m,Dt(T.changes,i.changes))||h=="input.type.compose")?k=Fe(k,k.length-1,f.minDepth,new Me(i.changes.compose(T.changes),Qt(i.effects,T.effects),T.mapped,T.startSelection,et)):k=Fe(k,k.length,f.minDepth,i),new ie(k,et,l,h)}addSelection(i,l,h,f){let m=this.done.length?this.done[this.done.length-1].selectionsAfter:et;return m.length>0&&l-this.prevTime<f&&h==this.prevUserEvent&&h&&/^select($|\.)/.test(h)&&lt(m[m.length-1],i)?this:new ie(Rt(this.done,i),this.undone,l,h)}addMapping(i){return new ie(_t(this.done,i),_t(this.undone,i),this.prevTime,this.prevUserEvent)}pop(i,l,h){let f=i==0?this.done:this.undone;if(f.length==0)return null;let m=f[f.length-1],k=m.selectionsAfter[0]||l.selection;if(h&&m.selectionsAfter.length)return l.update({selection:m.selectionsAfter[m.selectionsAfter.length-1],annotations:ii.of({side:i,rest:kt(f),selection:k}),userEvent:i==0?"select.undo":"select.redo",scrollIntoView:!0});if(m.changes){let T=f.length==1?et:f.slice(0,f.length-1);return m.mapped&&(T=_t(T,m.mapped)),l.update({changes:m.changes,selection:m.startSelection,effects:m.effects,annotations:ii.of({side:i,rest:T,selection:k}),filter:!1,userEvent:i==0?"undo":"redo",scrollIntoView:!0})}else return null}}ie.empty=new ie(et,et);const w=[{key:"Mod-z",run:Si,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ge,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Ge,preventDefault:!0},{key:"Mod-u",run:ki,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Xe,preventDefault:!0}];function C(o,i){return L.jT.create(o.ranges.map(i),o.mainIndex)}function N(o,i){return o.update({selection:i,scrollIntoView:!0,userEvent:"select"})}function I({state:o,dispatch:i},l){let h=C(o.selection,l);return h.eq(o.selection)?!1:(i(N(o,h)),!0)}function Z(o,i){return L.jT.cursor(i?o.to:o.from)}function ee(o,i){return I(o,l=>l.empty?o.moveByChar(l,i):Z(l,i))}function se(o){return o.textDirectionAt(o.state.selection.main.head)==G.Nm.LTR}const xe=o=>ee(o,!se(o)),He=o=>ee(o,se(o)),Oe=o=>ee(o,!0),Je=o=>ee(o,!1);function tt(o,i){return I(o,l=>l.empty?o.moveByGroup(l,i):Z(l,i))}const rt=o=>tt(o,!se(o)),ei=o=>tt(o,se(o)),ci=o=>tt(o,!0),Vt=o=>tt(o,!1),zt=typeof Intl!="undefined"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function Ct(o,i,l){let h=o.state.charCategorizer(i.from),f=CharCategory.Space,m=i.from,k=0,T=!1,B=!1,J=!1,Y=Be=>{if(T)return!1;m+=l?Be.length:-Be.length;let ut=h(Be),ti;if(ut==CharCategory.Word&&Be.charCodeAt(0)<128&&/[\W_]/.test(Be)&&(ut=-1),f==CharCategory.Space&&(f=ut),f!=ut)return!1;if(f==CharCategory.Word)if(Be.toLowerCase()==Be){if(!l&&B)return!1;J=!0}else if(J){if(l)return!1;T=!0}else{if(B&&l&&h(ti=o.state.sliceDoc(m,m+1))==CharCategory.Word&&ti.toLowerCase()==ti)return!1;B=!0}return k++,!0},ge=o.moveByChar(i,l,Be=>(Y(Be),Y));if(zt&&f==CharCategory.Word&&ge.from==i.from+k*(l?1:-1)){let Be=Math.min(i.head,ge.head),ut=Math.max(i.head,ge.head),ti=o.state.sliceDoc(Be,ut);if(ti.length>1&&/[\u4E00-\uffff]/.test(ti)){let Gi=Array.from(zt.segment(ti));if(Gi.length>1)return l?EditorSelection.cursor(i.head+Gi[1].index,-1):EditorSelection.cursor(ge.head+Gi[Gi.length-1].index,1)}}return ge}function Bt(o,i){return I(o,l=>l.empty?Ct(o,l,i):Z(l,i))}const Ci=o=>Bt(o,!0),it=o=>Bt(o,!1);function Ye(o,i,l){if(i.type.prop(l))return!0;let h=i.to-i.from;return h&&(h>2||/[^\s,.;:]/.test(o.sliceDoc(i.from,i.to)))||i.firstChild}function We(o,i,l){let h=(0,Ce.qz)(o).resolveInner(i.head),f=l?Ie.md.closedBy:Ie.md.openedBy;for(let B=i.head;;){let J=l?h.childAfter(B):h.childBefore(B);if(!J)break;Ye(o,J,f)?h=J:B=l?J.to:J.from}let m=h.type.prop(f),k,T;return m&&(k=l?(0,Ce.Um)(o,h.from,1):(0,Ce.Um)(o,h.to,-1))&&k.matched?T=l?k.end.to:k.end.from:T=l?h.to:h.from,L.jT.cursor(T,l?-1:1)}const Ut=o=>I(o,i=>We(o.state,i,!se(o))),st=o=>I(o,i=>We(o.state,i,se(o)));function ot(o,i){return I(o,l=>{if(!l.empty)return Z(l,i);let h=o.moveVertically(l,i);return h.head!=l.head?h:o.moveToLineBoundary(l,i)})}const gt=o=>ot(o,!1),at=o=>ot(o,!0);function Lt(o){let i=o.scrollDOM.clientHeight<o.scrollDOM.scrollHeight-2,l=0,h=0,f;if(i){for(let m of o.state.facet(G.tk.scrollMargins)){let k=m(o);k!=null&&k.top&&(l=Math.max(k==null?void 0:k.top,l)),k!=null&&k.bottom&&(h=Math.max(k==null?void 0:k.bottom,h))}f=o.scrollDOM.clientHeight-l-h}else f=(o.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:l,marginBottom:h,selfScroll:i,height:Math.max(o.defaultLineHeight,f-5)}}function $t(o,i){let l=Lt(o),{state:h}=o,f=C(h.selection,k=>k.empty?o.moveVertically(k,i,l.height):Z(k,i));if(f.eq(h.selection))return!1;let m;if(l.selfScroll){let k=o.coordsAtPos(h.selection.main.head),T=o.scrollDOM.getBoundingClientRect(),B=T.top+l.marginTop,J=T.bottom-l.marginBottom;k&&k.top>B&&k.bottom<J&&(m=G.tk.scrollIntoView(f.main.head,{y:"start",yMargin:k.top-B}))}return o.dispatch(N(h,f),{effects:m}),!0}const qe=o=>$t(o,!1),Vi=o=>$t(o,!0);function fi(o,i,l){let h=o.lineBlockAt(i.head),f=o.moveToLineBoundary(i,l);if(f.head==i.head&&f.head!=(l?h.to:h.from)&&(f=o.moveToLineBoundary(i,l,!1)),!l&&f.head==h.from&&h.length){let m=/^\s*/.exec(o.state.sliceDoc(h.from,Math.min(h.from+100,h.to)))[0].length;m&&i.head!=h.from+m&&(f=L.jT.cursor(h.from+m))}return f}const vi=o=>I(o,i=>fi(o,i,!0)),tn=o=>I(o,i=>fi(o,i,!1)),Ti=o=>I(o,i=>fi(o,i,!se(o))),Ht=o=>I(o,i=>fi(o,i,se(o))),Ni=o=>I(o,i=>L.jT.cursor(o.lineBlockAt(i.head).from,1)),zi=o=>I(o,i=>L.jT.cursor(o.lineBlockAt(i.head).to,-1));function Yi(o,i,l){let h=!1,f=C(o.selection,m=>{let k=(0,Ce.Um)(o,m.head,-1)||(0,Ce.Um)(o,m.head,1)||m.head>0&&(0,Ce.Um)(o,m.head-1,1)||m.head<o.doc.length&&(0,Ce.Um)(o,m.head+1,-1);if(!k||!k.end)return m;h=!0;let T=k.start.from==m.head?k.end.to:k.end.from;return l?L.jT.range(m.anchor,T):L.jT.cursor(T)});return h?(i(N(o,f)),!0):!1}const $i=({state:o,dispatch:i})=>Yi(o,i,!1),nn=({state:o,dispatch:i})=>Yi(o,i,!0);function si(o,i){let l=C(o.state.selection,h=>{let f=i(h);return L.jT.range(h.anchor,f.head,f.goalColumn,f.bidiLevel||void 0)});return l.eq(o.state.selection)?!1:(o.dispatch(N(o.state,l)),!0)}function Zi(o,i){return si(o,l=>o.moveByChar(l,i))}const $n=o=>Zi(o,!se(o)),cn=o=>Zi(o,se(o)),di=o=>Zi(o,!0),Nn=o=>Zi(o,!1);function On(o,i){return si(o,l=>o.moveByGroup(l,i))}const qn=o=>On(o,!se(o)),Fn=o=>On(o,se(o)),R=o=>On(o,!0),a=o=>On(o,!1);function d(o,i){return si(o,l=>Ct(o,l,i))}const v=o=>d(o,!0),x=o=>d(o,!1),E=o=>si(o,i=>We(o.state,i,!se(o))),D=o=>si(o,i=>We(o.state,i,se(o)));function V(o,i){return si(o,l=>o.moveVertically(l,i))}const j=o=>V(o,!1),ne=o=>V(o,!0);function fe(o,i){return si(o,l=>o.moveVertically(l,i,Lt(o).height))}const ve=o=>fe(o,!1),Le=o=>fe(o,!0),Pe=o=>si(o,i=>fi(o,i,!0)),Gt=o=>si(o,i=>fi(o,i,!1)),pi=o=>si(o,i=>fi(o,i,!se(o))),bi=o=>si(o,i=>fi(o,i,se(o))),jn=o=>si(o,i=>L.jT.cursor(o.lineBlockAt(i.head).from)),mn=o=>si(o,i=>L.jT.cursor(o.lineBlockAt(i.head).to)),Pn=({state:o,dispatch:i})=>(i(N(o,{anchor:0})),!0),qt=({state:o,dispatch:i})=>(i(N(o,{anchor:o.doc.length})),!0),Rr=({state:o,dispatch:i})=>(i(N(o,{anchor:o.selection.main.anchor,head:0})),!0),Br=({state:o,dispatch:i})=>(i(N(o,{anchor:o.selection.main.anchor,head:o.doc.length})),!0),Jr=({state:o,dispatch:i})=>(i(o.update({selection:{anchor:0,head:o.doc.length},userEvent:"select"})),!0),dr=({state:o,dispatch:i})=>{let l=Oi(o).map(({from:h,to:f})=>L.jT.range(h,Math.min(f+1,o.doc.length)));return i(o.update({selection:L.jT.create(l),userEvent:"select"})),!0},Lr=({state:o,dispatch:i})=>{let l=C(o.selection,h=>{var f;let m=(0,Ce.qz)(o).resolveStack(h.from,1);for(let k=m;k;k=k.next){let{node:T}=k;if((T.from<h.from&&T.to>=h.to||T.to>h.to&&T.from<=h.from)&&(!((f=T.parent)===null||f===void 0)&&f.parent))return L.jT.range(T.to,T.from)}return h});return i(N(o,l)),!0},pr=({state:o,dispatch:i})=>{let l=o.selection,h=null;return l.ranges.length>1?h=L.jT.create([l.main]):l.main.empty||(h=L.jT.create([L.jT.cursor(l.main.head)])),h?(i(N(o,h)),!0):!1};function Rn(o,i){if(o.state.readOnly)return!1;let l="delete.selection",{state:h}=o,f=h.changeByRange(m=>{let{from:k,to:T}=m;if(k==T){let B=i(m);B<k?(l="delete.backward",B=Qn(o,B,!1)):B>k&&(l="delete.forward",B=Qn(o,B,!0)),k=Math.min(k,B),T=Math.max(T,B)}else k=Qn(o,k,!1),T=Qn(o,T,!0);return k==T?{range:m}:{changes:{from:k,to:T},range:L.jT.cursor(k,k<m.head?-1:1)}});return f.changes.empty?!1:(o.dispatch(h.update(f,{scrollIntoView:!0,userEvent:l,effects:l=="delete.selection"?G.tk.announce.of(h.phrase("Selection deleted")):void 0})),!0)}function Qn(o,i,l){if(o instanceof G.tk)for(let h of o.state.facet(G.tk.atomicRanges).map(f=>f(o)))h.between(i,i,(f,m)=>{f<i&&m>i&&(i=l?m:f)});return i}const O=(o,i)=>Rn(o,l=>{let h=l.from,{state:f}=o,m=f.doc.lineAt(h),k,T;if(!i&&h>m.from&&h<m.from+200&&!/[^ \t]/.test(k=m.text.slice(0,h-m.from))){if(k[k.length-1]=="	")return h-1;let B=(0,L.IS)(k,f.tabSize),J=B%(0,Ce.y1)(f)||(0,Ce.y1)(f);for(let Y=0;Y<J&&k[k.length-1-Y]==" ";Y++)h--;T=h}else T=(0,L.cp)(m.text,h-m.from,i,i)+m.from,T==h&&m.number!=(i?f.doc.lines:1)?T+=i?1:-1:!i&&/[\ufe00-\ufe0f]/.test(m.text.slice(T-m.from,h-m.from))&&(T=(0,L.cp)(m.text,T-m.from,!1,!1)+m.from);return T}),g=o=>O(o,!1),S=o=>O(o,!0),P=(o,i)=>Rn(o,l=>{let h=l.head,{state:f}=o,m=f.doc.lineAt(h),k=f.charCategorizer(h);for(let T=null;;){if(h==(i?m.to:m.from)){h==l.head&&m.number!=(i?f.doc.lines:1)&&(h+=i?1:-1);break}let B=(0,L.cp)(m.text,h-m.from,i)+m.from,J=m.text.slice(Math.min(h,B)-m.from,Math.max(h,B)-m.from),Y=k(J);if(T!=null&&Y!=T)break;(J!=" "||h!=l.head)&&(T=Y),h=B}return h}),W=o=>P(o,!1),K=o=>P(o,!0),U=o=>Rn(o,i=>{let l=o.lineBlockAt(i.head).to;return i.head<l?l:Math.min(o.state.doc.length,i.head+1)}),ce=o=>Rn(o,i=>{let l=o.lineBlockAt(i.head).from;return i.head>l?l:Math.max(0,i.head-1)}),ae=o=>Rn(o,i=>{let l=o.moveToLineBoundary(i,!1).head;return i.head>l?l:Math.max(0,i.head-1)}),Ee=o=>Rn(o,i=>{let l=o.moveToLineBoundary(i,!0).head;return i.head<l?l:Math.min(o.state.doc.length,i.head+1)}),Ve=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=[];for(let h=0,f="",m=o.doc.iter();;){if(m.next(),m.lineBreak||m.done){let k=f.search(/\s+$/);if(k>-1&&l.push({from:h-(f.length-k),to:h}),m.done)break;f=""}else f=m.value;h+=m.value.length}return l.length?(i(o.update({changes:l,userEvent:"delete"})),!0):!1},jt=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(h=>({changes:{from:h.from,to:h.to,insert:L.xv.of(["",""])},range:L.jT.cursor(h.from)}));return i(o.update(l,{scrollIntoView:!0,userEvent:"input"})),!0},Ki=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(h=>{if(!h.empty||h.from==0||h.from==o.doc.length)return{range:h};let f=h.from,m=o.doc.lineAt(f),k=f==m.from?f-1:(0,L.cp)(m.text,f-m.from,!1)+m.from,T=f==m.to?f+1:(0,L.cp)(m.text,f-m.from,!0)+m.from;return{changes:{from:k,to:T,insert:o.doc.slice(f,T).append(o.doc.slice(k,f))},range:L.jT.cursor(T)}});return l.changes.empty?!1:(i(o.update(l,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Oi(o){let i=[],l=-1;for(let h of o.selection.ranges){let f=o.doc.lineAt(h.from),m=o.doc.lineAt(h.to);if(!h.empty&&h.to==m.from&&(m=o.doc.lineAt(h.to-1)),l>=f.number){let k=i[i.length-1];k.to=m.to,k.ranges.push(h)}else i.push({from:f.from,to:m.to,ranges:[h]});l=m.number+1}return i}function gn(o,i,l){if(o.readOnly)return!1;let h=[],f=[];for(let m of Oi(o)){if(l?m.to==o.doc.length:m.from==0)continue;let k=o.doc.lineAt(l?m.to+1:m.from-1),T=k.length+1;if(l){h.push({from:m.to,to:k.to},{from:m.from,insert:k.text+o.lineBreak});for(let B of m.ranges)f.push(L.jT.range(Math.min(o.doc.length,B.anchor+T),Math.min(o.doc.length,B.head+T)))}else{h.push({from:k.from,to:m.from},{from:m.to,insert:o.lineBreak+k.text});for(let B of m.ranges)f.push(L.jT.range(B.anchor-T,B.head-T))}}return h.length?(i(o.update({changes:h,scrollIntoView:!0,selection:L.jT.create(f,o.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Cn=({state:o,dispatch:i})=>gn(o,i,!1),It=({state:o,dispatch:i})=>gn(o,i,!0);function qi(o,i,l){if(o.readOnly)return!1;let h=[];for(let f of Oi(o))l?h.push({from:f.from,insert:o.doc.slice(f.from,f.to)+o.lineBreak}):h.push({from:f.to,insert:o.lineBreak+o.doc.slice(f.from,f.to)});return i(o.update({changes:h,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const yn=({state:o,dispatch:i})=>qi(o,i,!1),_n=({state:o,dispatch:i})=>qi(o,i,!0),Zn=o=>{if(o.state.readOnly)return!1;let{state:i}=o,l=i.changes(Oi(i).map(({from:f,to:m})=>(f>0?f--:m<i.doc.length&&m++,{from:f,to:m}))),h=C(i.selection,f=>o.moveVertically(f,!0)).map(l);return o.dispatch({changes:l,selection:h,scrollIntoView:!0,userEvent:"delete.line"}),!0},fn=({state:o,dispatch:i})=>(i(o.update(o.replaceSelection(o.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function mr(o,i){if(/\(\)|\[\]|\{\}/.test(o.sliceDoc(i-1,i+1)))return{from:i,to:i};let l=(0,Ce.qz)(o).resolveInner(i),h=l.childBefore(i),f=l.childAfter(i),m;return h&&f&&h.to<=i&&f.from>=i&&(m=h.type.prop(Ie.md.closedBy))&&m.indexOf(f.name)>-1&&o.doc.lineAt(h.to).from==o.doc.lineAt(f.from).from&&!/\S/.test(o.sliceDoc(h.to,f.from))?{from:h.to,to:f.from}:null}const Ur=Wn(!1),er=Wn(!0);function Wn(o){return({state:i,dispatch:l})=>{if(i.readOnly)return!1;let h=i.changeByRange(f=>{let{from:m,to:k}=f,T=i.doc.lineAt(m),B=!o&&m==k&&mr(i,m);o&&(m=k=(k<=T.to?T:i.doc.lineAt(k)).to);let J=new Ce.Gn(i,{simulateBreak:m,simulateDoubleBreak:!!B}),Y=(0,Ce.K0)(J,m);for(Y==null&&(Y=(0,L.IS)(/^\s*/.exec(i.doc.lineAt(m).text)[0],i.tabSize));k<T.to&&/\s/.test(T.text[k-T.from]);)k++;B?{from:m,to:k}=B:m>T.from&&m<T.from+100&&!/\S/.test(T.text.slice(0,m))&&(m=T.from);let ge=["",(0,Ce.SS)(i,Y)];return B&&ge.push((0,Ce.SS)(i,J.lineIndent(T.from,-1))),{changes:{from:m,to:k,insert:L.xv.of(ge)},range:L.jT.cursor(m+1+ge[1].length)}});return l(i.update(h,{scrollIntoView:!0,userEvent:"input"})),!0}}function Hn(o,i){let l=-1;return o.changeByRange(h=>{let f=[];for(let k=h.from;k<=h.to;){let T=o.doc.lineAt(k);T.number>l&&(h.empty||h.to>T.from)&&(i(T,f,h),l=T.number),k=T.to+1}let m=o.changes(f);return{changes:f,range:L.jT.range(m.mapPos(h.anchor,1),m.mapPos(h.head,1))}})}const Ir=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=Object.create(null),h=new Ce.Gn(o,{overrideIndentation:m=>{let k=l[m];return k==null?-1:k}}),f=Hn(o,(m,k,T)=>{let B=(0,Ce.K0)(h,m.from);if(B==null)return;/\S/.test(m.text)||(B=0);let J=/^\s*/.exec(m.text)[0],Y=(0,Ce.SS)(o,B);(J!=Y||T.from<m.from+J.length)&&(l[m.from]=B,k.push({from:m.from,to:m.from+J.length,insert:Y}))});return f.changes.empty||i(o.update(f,{userEvent:"indent"})),!0},os=({state:o,dispatch:i})=>o.readOnly?!1:(i(o.update(Hn(o,(l,h)=>{h.push({from:l.from,insert:o.facet(Ce.c)})}),{userEvent:"input.indent"})),!0),Nr=({state:o,dispatch:i})=>o.readOnly?!1:(i(o.update(Hn(o,(l,h)=>{let f=/^\s*/.exec(l.text)[0];if(!f)return;let m=(0,L.IS)(f,o.tabSize),k=0,T=(0,Ce.SS)(o,Math.max(0,m-(0,Ce.y1)(o)));for(;k<f.length&&k<T.length&&f.charCodeAt(k)==T.charCodeAt(k);)k++;h.push({from:l.from+k,to:l.from+f.length,insert:T.slice(k)})}),{userEvent:"delete.dedent"})),!0),Ms=({state:o,dispatch:i})=>o.selection.ranges.some(l=>!l.empty)?os({state:o,dispatch:i}):(i(o.update(o.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),io=[{key:"Ctrl-b",run:xe,shift:$n,preventDefault:!0},{key:"Ctrl-f",run:He,shift:cn},{key:"Ctrl-p",run:gt,shift:j},{key:"Ctrl-n",run:at,shift:ne},{key:"Ctrl-a",run:Ni,shift:jn},{key:"Ctrl-e",run:zi,shift:mn},{key:"Ctrl-d",run:S},{key:"Ctrl-h",run:g},{key:"Ctrl-k",run:U},{key:"Ctrl-Alt-h",run:W},{key:"Ctrl-o",run:jt},{key:"Ctrl-t",run:Ki},{key:"Ctrl-v",run:Vi}],ls=[{key:"ArrowLeft",run:xe,shift:$n,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:rt,shift:qn,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ti,shift:pi,preventDefault:!0},{key:"ArrowRight",run:He,shift:cn,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ei,shift:Fn,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Ht,shift:bi,preventDefault:!0},{key:"ArrowUp",run:gt,shift:j,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Pn,shift:Rr},{mac:"Ctrl-ArrowUp",run:qe,shift:ve},{key:"ArrowDown",run:at,shift:ne,preventDefault:!0},{mac:"Cmd-ArrowDown",run:qt,shift:Br},{mac:"Ctrl-ArrowDown",run:Vi,shift:Le},{key:"PageUp",run:qe,shift:ve},{key:"PageDown",run:Vi,shift:Le},{key:"Home",run:tn,shift:Gt,preventDefault:!0},{key:"Mod-Home",run:Pn,shift:Rr},{key:"End",run:vi,shift:Pe,preventDefault:!0},{key:"Mod-End",run:qt,shift:Br},{key:"Enter",run:Ur},{key:"Mod-a",run:Jr},{key:"Backspace",run:g,shift:g},{key:"Delete",run:S},{key:"Mod-Backspace",mac:"Alt-Backspace",run:W},{key:"Mod-Delete",mac:"Alt-Delete",run:K},{mac:"Mod-Backspace",run:ae},{mac:"Mod-Delete",run:Ee}].concat(io.map(o=>({mac:o.key,run:o.run,shift:o.shift}))),as=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Ut,shift:E},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:st,shift:D},{key:"Alt-ArrowUp",run:Cn},{key:"Shift-Alt-ArrowUp",run:yn},{key:"Alt-ArrowDown",run:It},{key:"Shift-Alt-ArrowDown",run:_n},{key:"Escape",run:pr},{key:"Mod-Enter",run:er},{key:"Alt-l",mac:"Ctrl-l",run:dr},{key:"Mod-i",run:Lr,preventDefault:!0},{key:"Mod-[",run:Nr},{key:"Mod-]",run:os},{key:"Mod-Alt-\\",run:Ir},{key:"Shift-Mod-k",run:Zn},{key:"Shift-Mod-\\",run:$i},{key:"Mod-/",run:vt},{key:"Alt-A",run:_e}].concat(ls),Es={key:"Tab",run:os,shift:Nr};function hi(){var o=arguments[0];typeof o=="string"&&(o=document.createElement(o));var i=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)){var f=l[h];typeof f=="string"?o.setAttribute(h,f):f!=null&&(o[h]=f)}i++}for(;i<arguments.length;i++)Gr(o,arguments[i]);return o}function Gr(o,i){if(typeof i=="string")o.appendChild(document.createTextNode(i));else if(i!=null)if(i.nodeType!=null)o.appendChild(i);else if(Array.isArray(i))for(var l=0;l<i.length;l++)Gr(o,i[l]);else throw new RangeError("Unsupported child node: "+i)}const gr=typeof String.prototype.normalize=="function"?o=>o.normalize("NFKD"):o=>o;class Vn{constructor(i,l,h=0,f=i.length,m,k){this.test=k,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=i.iterRange(h,f),this.bufferStart=h,this.normalize=m?T=>m(gr(T)):gr,this.query=this.normalize(l)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,L.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let i=this.peek();if(i<0)return this.done=!0,this;let l=(0,L.bg)(i),h=this.bufferStart+this.bufferPos;this.bufferPos+=(0,L.nZ)(i);let f=this.normalize(l);for(let m=0,k=h;;m++){let T=f.charCodeAt(m),B=this.match(T,k);if(m==f.length-1){if(B)return this.value=B,this;break}k==h&&m<l.length&&l.charCodeAt(m)==T&&k++}}}match(i,l){let h=null;for(let f=0;f<this.matches.length;f+=2){let m=this.matches[f],k=!1;this.query.charCodeAt(m)==i&&(m==this.query.length-1?h={from:this.matches[f+1],to:l+1}:(this.matches[f]++,k=!0)),k||(this.matches.splice(f,2),f-=2)}return this.query.charCodeAt(0)==i&&(this.query.length==1?h={from:l,to:l+1}:this.matches.push(1,l)),h&&this.test&&!this.test(h.from,h.to,this.buffer,this.bufferStart)&&(h=null),h}}typeof Symbol!="undefined"&&(Vn.prototype[Symbol.iterator]=function(){return this});const Ds={from:-1,to:-1,match:/.*/.exec("")},Kn="gm"+(/x/.unicode==null?"":"u");class Os{constructor(i,l,h,f=0,m=i.length){if(this.text=i,this.to=m,this.curLine="",this.done=!1,this.value=Ds,/\\[sWDnr]|\n|\r|\[\^/.test(l))return new cs(i,l,h,f,m);this.re=new RegExp(l,Kn+(h!=null&&h.ignoreCase?"i":"")),this.test=h==null?void 0:h.test,this.iter=i.iter();let k=i.lineAt(f);this.curLineStart=k.from,this.matchPos=rn(i,f),this.getLine(this.curLineStart)}getLine(i){this.iter.next(i),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let i=this.matchPos-this.curLineStart;;){this.re.lastIndex=i;let l=this.matchPos<=this.to&&this.re.exec(this.curLine);if(l){let h=this.curLineStart+l.index,f=h+l[0].length;if(this.matchPos=rn(this.text,f+(h==f?1:0)),h==this.curLineStart+this.curLine.length&&this.nextLine(),(h<f||h>this.value.to)&&(!this.test||this.test(h,f,l)))return this.value={from:h,to:f,match:l},this;i=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),i=0;else return this.done=!0,this}}}const hs=new WeakMap;class tr{constructor(i,l){this.from=i,this.text=l}get to(){return this.from+this.text.length}static get(i,l,h){let f=hs.get(i);if(!f||f.from>=h||f.to<=l){let T=new tr(l,i.sliceString(l,h));return hs.set(i,T),T}if(f.from==l&&f.to==h)return f;let{text:m,from:k}=f;return k>l&&(m=i.sliceString(l,k)+m,k=l),f.to<h&&(m+=i.sliceString(f.to,h)),hs.set(i,new tr(k,m)),new tr(l,m.slice(l-k,h-k))}}class cs{constructor(i,l,h,f,m){this.text=i,this.to=m,this.done=!1,this.value=Ds,this.matchPos=rn(i,f),this.re=new RegExp(l,Kn+(h!=null&&h.ignoreCase?"i":"")),this.test=h==null?void 0:h.test,this.flat=tr.get(i,f,this.chunkEnd(f+5e3))}chunkEnd(i){return i>=this.to?this.to:this.text.lineAt(i).to}next(){for(;;){let i=this.re.lastIndex=this.matchPos-this.flat.from,l=this.re.exec(this.flat.text);if(l&&!l[0]&&l.index==i&&(this.re.lastIndex=i+1,l=this.re.exec(this.flat.text)),l){let h=this.flat.from+l.index,f=h+l[0].length;if((this.flat.to>=this.to||l.index+l[0].length<=this.flat.text.length-10)&&(!this.test||this.test(h,f,l)))return this.value={from:h,to:f,match:l},this.matchPos=rn(this.text,f+(h==f?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=tr.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(Os.prototype[Symbol.iterator]=cs.prototype[Symbol.iterator]=function(){return this});function An(o){try{return new RegExp(o,Kn),!0}catch{return!1}}function rn(o,i){if(i>=o.length)return i;let l=o.lineAt(i),h;for(;i<l.to&&(h=l.text.charCodeAt(i-l.from))>=56320&&h<57344;)i++;return i}function Xr(o){let i=String(o.state.doc.lineAt(o.state.selection.main.head).number),l=hi("input",{class:"cm-textfield",name:"line",value:i}),h=hi("form",{class:"cm-gotoLine",onkeydown:m=>{m.keyCode==27?(m.preventDefault(),o.dispatch({effects:yr.of(!1)}),o.focus()):m.keyCode==13&&(m.preventDefault(),f())},onsubmit:m=>{m.preventDefault(),f()}},hi("label",o.state.phrase("Go to line"),": ",l)," ",hi("button",{class:"cm-button",type:"submit"},o.state.phrase("go")));function f(){let m=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.value);if(!m)return;let{state:k}=o,T=k.doc.lineAt(k.selection.main.head),[,B,J,Y,ge]=m,Be=Y?+Y.slice(1):0,ut=J?+J:T.number;if(J&&ge){let Yn=ut/100;B&&(Yn=Yn*(B=="-"?-1:1)+T.number/k.doc.lines),ut=Math.round(k.doc.lines*Yn)}else J&&B&&(ut=ut*(B=="-"?-1:1)+T.number);let ti=k.doc.line(Math.max(1,Math.min(k.doc.lines,ut))),Gi=L.jT.cursor(ti.from+Math.max(0,Math.min(Be,ti.length)));o.dispatch({effects:[yr.of(!1),G.tk.scrollIntoView(Gi.from,{y:"center"})],selection:Gi}),o.focus()}return{dom:h}}const yr=L.Py.define(),fs=L.QQ.define({create(){return!0},update(o,i){for(let l of i.effects)l.is(yr)&&(o=l.value);return o},provide:o=>G.mH.from(o,i=>i?Xr:null)}),Ps=o=>{let i=(0,G.Sd)(o,Xr);if(!i){let l=[yr.of(!0)];o.state.field(fs,!1)==null&&l.push(L.Py.appendConfig.of([fs,Rs])),o.dispatch({effects:l}),i=(0,G.Sd)(o,Xr)}return i&&i.dom.querySelector("input").select(),!0},Rs=G.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Bs={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Ls=L.r$.define({combine(o){return(0,L.BO)(o,Bs,{highlightWordAroundCursor:(i,l)=>i||l,minSelectionLength:Math.min,maxMatches:Math.min})}});function Is(o){let i=[no,Fs];return o&&i.push(Ls.of(o)),i}const us=G.p.mark({class:"cm-selectionMatch"}),Yr=G.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function ds(o,i,l,h){return(l==0||o(i.sliceDoc(l-1,l))!=L.D0.Word)&&(h==i.doc.length||o(i.sliceDoc(h,h+1))!=L.D0.Word)}function Ns(o,i,l,h){return o(i.sliceDoc(l,l+1))==L.D0.Word&&o(i.sliceDoc(h-1,h))==L.D0.Word}const Fs=G.lg.fromClass(class{constructor(o){this.decorations=this.getDeco(o)}update(o){(o.selectionSet||o.docChanged||o.viewportChanged)&&(this.decorations=this.getDeco(o.view))}getDeco(o){let i=o.state.facet(Ls),{state:l}=o,h=l.selection;if(h.ranges.length>1)return G.p.none;let f=h.main,m,k=null;if(f.empty){if(!i.highlightWordAroundCursor)return G.p.none;let B=l.wordAt(f.head);if(!B)return G.p.none;k=l.charCategorizer(f.head),m=l.sliceDoc(B.from,B.to)}else{let B=f.to-f.from;if(B<i.minSelectionLength||B>200)return G.p.none;if(i.wholeWords){if(m=l.sliceDoc(f.from,f.to),k=l.charCategorizer(f.head),!(ds(k,l,f.from,f.to)&&Ns(k,l,f.from,f.to)))return G.p.none}else if(m=l.sliceDoc(f.from,f.to).trim(),!m)return G.p.none}let T=[];for(let B of o.visibleRanges){let J=new Vn(l.doc,m,B.from,B.to);for(;!J.next().done;){let{from:Y,to:ge}=J.value;if((!k||ds(k,l,Y,ge))&&(f.empty&&Y<=f.from&&ge>=f.to?T.push(Yr.range(Y,ge)):(Y>=f.to||ge<=f.from)&&T.push(us.range(Y,ge)),T.length>i.maxMatches))return G.p.none}}return G.p.set(T)}},{decorations:o=>o.decorations}),no=G.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ro=({state:o,dispatch:i})=>{let{selection:l}=o,h=L.jT.create(l.ranges.map(f=>o.wordAt(f.head)||L.jT.cursor(f.head)),l.mainIndex);return h.eq(l)?!1:(i(o.update({selection:h})),!0)};function Ws(o,i){let{main:l,ranges:h}=o.selection,f=o.wordAt(l.head),m=f&&f.from==l.from&&f.to==l.to;for(let k=!1,T=new Vn(o.doc,i,h[h.length-1].to);;)if(T.next(),T.done){if(k)return null;T=new Vn(o.doc,i,0,Math.max(0,h[h.length-1].from-1)),k=!0}else{if(k&&h.some(B=>B.from==T.value.from))continue;if(m){let B=o.wordAt(T.value.from);if(!B||B.from!=T.value.from||B.to!=T.value.to)continue}return T.value}}const z=({state:o,dispatch:i})=>{let{ranges:l}=o.selection;if(l.some(m=>m.from===m.to))return ro({state:o,dispatch:i});let h=o.sliceDoc(l[0].from,l[0].to);if(o.selection.ranges.some(m=>o.sliceDoc(m.from,m.to)!=h))return!1;let f=Ws(o,h);return f?(i(o.update({selection:o.selection.addRange(L.jT.range(f.from,f.to),!1),effects:G.tk.scrollIntoView(f.to)})),!0):!1},H=L.r$.define({combine(o){return(0,L.BO)(o,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:i=>new rr(i),scrollToMatch:i=>G.tk.scrollIntoView(i)})}});function Q(o){return o?[H.of(o),sr]:sr}class te{constructor(i){this.search=i.search,this.caseSensitive=!!i.caseSensitive,this.literal=!!i.literal,this.regexp=!!i.regexp,this.replace=i.replace||"",this.valid=!!this.search&&(!this.regexp||An(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!i.wholeWord}unquote(i){return this.literal?i:i.replace(/\\([nrt\\])/g,(l,h)=>h=="n"?`
`:h=="r"?"\r":h=="t"?"	":"\\")}eq(i){return this.search==i.search&&this.replace==i.replace&&this.caseSensitive==i.caseSensitive&&this.regexp==i.regexp&&this.wholeWord==i.wholeWord}create(){return this.regexp?new Ae(this):new Ne(this)}getCursor(i,l=0,h){let f=i.doc?i:L.yy.create({doc:i});return h==null&&(h=f.doc.length),this.regexp?Mt(this,f,l,h):ue(this,f,l,h)}}class he{constructor(i){this.spec=i}}function ue(o,i,l,h){return new Vn(i.doc,o.unquoted,l,h,o.caseSensitive?void 0:f=>f.toLowerCase(),o.wholeWord?be(i.doc,i.charCategorizer(i.selection.main.head)):void 0)}function be(o,i){return(l,h,f,m)=>((m>l||m+f.length<h)&&(m=Math.max(0,l-2),f=o.sliceString(m,Math.min(o.length,h+2))),(i(yt(f,l-m))!=L.D0.Word||i(Ue(f,l-m))!=L.D0.Word)&&(i(Ue(f,h-m))!=L.D0.Word||i(yt(f,h-m))!=L.D0.Word))}class Ne extends he{constructor(i){super(i)}nextMatch(i,l,h){let f=ue(this.spec,i,h,i.doc.length).nextOverlapping();return f.done&&(f=ue(this.spec,i,0,l).nextOverlapping()),f.done?null:f.value}prevMatchInRange(i,l,h){for(let f=h;;){let m=Math.max(l,f-1e4-this.spec.unquoted.length),k=ue(this.spec,i,m,f),T=null;for(;!k.nextOverlapping().done;)T=k.value;if(T)return T;if(m==l)return null;f-=1e4}}prevMatch(i,l,h){return this.prevMatchInRange(i,0,l)||this.prevMatchInRange(i,h,i.doc.length)}getReplacement(i){return this.spec.unquote(this.spec.replace)}matchAll(i,l){let h=ue(this.spec,i,0,i.doc.length),f=[];for(;!h.next().done;){if(f.length>=l)return null;f.push(h.value)}return f}highlight(i,l,h,f){let m=ue(this.spec,i,Math.max(0,l-this.spec.unquoted.length),Math.min(h+this.spec.unquoted.length,i.doc.length));for(;!m.next().done;)f(m.value.from,m.value.to)}}function Mt(o,i,l,h){return new Os(i.doc,o.search,{ignoreCase:!o.caseSensitive,test:o.wholeWord?De(i.charCategorizer(i.selection.main.head)):void 0},l,h)}function yt(o,i){return o.slice((0,L.cp)(o,i,!1),i)}function Ue(o,i){return o.slice(i,(0,L.cp)(o,i))}function De(o){return(i,l,h)=>!h[0].length||(o(yt(h.input,h.index))!=L.D0.Word||o(Ue(h.input,h.index))!=L.D0.Word)&&(o(Ue(h.input,h.index+h[0].length))!=L.D0.Word||o(yt(h.input,h.index+h[0].length))!=L.D0.Word)}class Ae extends he{nextMatch(i,l,h){let f=Mt(this.spec,i,h,i.doc.length).next();return f.done&&(f=Mt(this.spec,i,0,l).next()),f.done?null:f.value}prevMatchInRange(i,l,h){for(let f=1;;f++){let m=Math.max(l,h-f*1e4),k=Mt(this.spec,i,m,h),T=null;for(;!k.next().done;)T=k.value;if(T&&(m==l||T.from>m+10))return T;if(m==l)return null}}prevMatch(i,l,h){return this.prevMatchInRange(i,0,l)||this.prevMatchInRange(i,h,i.doc.length)}getReplacement(i){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(l,h)=>h=="$"?"$":h=="&"?i.match[0]:h!="0"&&+h<i.match.length?i.match[h]:l)}matchAll(i,l){let h=Mt(this.spec,i,0,i.doc.length),f=[];for(;!h.next().done;){if(f.length>=l)return null;f.push(h.value)}return f}highlight(i,l,h,f){let m=Mt(this.spec,i,Math.max(0,l-250),Math.min(h+250,i.doc.length));for(;!m.next().done;)f(m.value.from,m.value.to)}}const At=L.Py.define(),je=L.Py.define(),Pt=L.QQ.define({create(o){return new Fi(un(o).create(),null)},update(o,i){for(let l of i.effects)l.is(At)?o=new Fi(l.value.create(),o.panel):l.is(je)&&(o=new Fi(o.query,l.value?li:null));return o},provide:o=>G.mH.from(o,i=>i.panel)});function ni(o){let i=o.field(Pt,!1);return i?i.query.spec:un(o)}function Zt(o){var i;return((i=o.field(Pt,!1))===null||i===void 0?void 0:i.panel)!=null}class Fi{constructor(i,l){this.query=i,this.panel=l}}const Pi=G.p.mark({class:"cm-searchMatch"}),Ji=G.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Ui=G.lg.fromClass(class{constructor(o){this.view=o,this.decorations=this.highlight(o.state.field(Pt))}update(o){let i=o.state.field(Pt);(i!=o.startState.field(Pt)||o.docChanged||o.selectionSet||o.viewportChanged)&&(this.decorations=this.highlight(i))}highlight({query:o,panel:i}){if(!i||!o.spec.valid)return G.p.none;let{view:l}=this,h=new L.f_;for(let f=0,m=l.visibleRanges,k=m.length;f<k;f++){let{from:T,to:B}=m[f];for(;f<k-1&&B>m[f+1].from-2*250;)B=m[++f].to;o.highlight(l.state,T,B,(J,Y)=>{let ge=l.state.selection.ranges.some(Be=>Be.from==J&&Be.to==Y);h.add(J,Y,ge?Ji:Pi)})}return h.finish()}},{decorations:o=>o.decorations});function Nt(o){return i=>{let l=i.state.field(Pt,!1);return l&&l.query.spec.valid?o(i,l):Fr(i)}}const Tn=Nt((o,{query:i})=>{let{to:l}=o.state.selection.main,h=i.nextMatch(o.state,l,l);if(!h)return!1;let f=L.jT.single(h.from,h.to),m=o.state.facet(H);return o.dispatch({selection:f,effects:[bn(o,h),m.scrollToMatch(f.main,o)],userEvent:"select.search"}),nr(o),!0}),oi=Nt((o,{query:i})=>{let{state:l}=o,{from:h}=l.selection.main,f=i.prevMatch(l,h,h);if(!f)return!1;let m=L.jT.single(f.from,f.to),k=o.state.facet(H);return o.dispatch({selection:m,effects:[bn(o,f),k.scrollToMatch(m.main,o)],userEvent:"select.search"}),nr(o),!0}),Wi=Nt((o,{query:i})=>{let l=i.matchAll(o.state,1e3);return!l||!l.length?!1:(o.dispatch({selection:L.jT.create(l.map(h=>L.jT.range(h.from,h.to))),userEvent:"select.search.matches"}),!0)}),ji=({state:o,dispatch:i})=>{let l=o.selection;if(l.ranges.length>1||l.main.empty)return!1;let{from:h,to:f}=l.main,m=[],k=0;for(let T=new Vn(o.doc,o.sliceDoc(h,f));!T.next().done;){if(m.length>1e3)return!1;T.value.from==h&&(k=m.length),m.push(L.jT.range(T.value.from,T.value.to))}return i(o.update({selection:L.jT.create(m,k),userEvent:"select.search.matches"})),!0},Mn=Nt((o,{query:i})=>{let{state:l}=o,{from:h,to:f}=l.selection.main;if(l.readOnly)return!1;let m=i.nextMatch(l,h,h);if(!m)return!1;let k=[],T,B,J=[];if(m.from==h&&m.to==f&&(B=l.toText(i.getReplacement(m)),k.push({from:m.from,to:m.to,insert:B}),m=i.nextMatch(l,m.from,m.to),J.push(G.tk.announce.of(l.phrase("replaced match on line $",l.doc.lineAt(h).number)+"."))),m){let Y=k.length==0||k[0].from>=m.to?0:m.to-m.from-B.length;T=L.jT.single(m.from-Y,m.to-Y),J.push(bn(o,m)),J.push(l.facet(H).scrollToMatch(T.main,o))}return o.dispatch({changes:k,selection:T,effects:J,userEvent:"input.replace"}),!0}),ir=Nt((o,{query:i})=>{if(o.state.readOnly)return!1;let l=i.matchAll(o.state,1e9).map(f=>{let{from:m,to:k}=f;return{from:m,to:k,insert:i.getReplacement(f)}});if(!l.length)return!1;let h=o.state.phrase("replaced $ matches",l.length)+".";return o.dispatch({changes:l,effects:G.tk.announce.of(h),userEvent:"input.replace.all"}),!0});function li(o){return o.state.facet(H).createPanel(o)}function un(o,i){var l,h,f,m,k;let T=o.selection.main,B=T.empty||T.to>T.from+100?"":o.sliceDoc(T.from,T.to);if(i&&!B)return i;let J=o.facet(H);return new te({search:((l=i==null?void 0:i.literal)!==null&&l!==void 0?l:J.literal)?B:B.replace(/\n/g,"\\n"),caseSensitive:(h=i==null?void 0:i.caseSensitive)!==null&&h!==void 0?h:J.caseSensitive,literal:(f=i==null?void 0:i.literal)!==null&&f!==void 0?f:J.literal,regexp:(m=i==null?void 0:i.regexp)!==null&&m!==void 0?m:J.regexp,wholeWord:(k=i==null?void 0:i.wholeWord)!==null&&k!==void 0?k:J.wholeWord})}function Ri(o){let i=(0,G.Sd)(o,li);return i&&i.dom.querySelector("[main-field]")}function nr(o){let i=Ri(o);i&&i==o.root.activeElement&&i.select()}const Fr=o=>{let i=o.state.field(Pt,!1);if(i&&i.panel){let l=Ri(o);if(l&&l!=o.root.activeElement){let h=un(o.state,i.query.spec);h.valid&&o.dispatch({effects:At.of(h)}),l.focus(),l.select()}}else o.dispatch({effects:[je.of(!0),i?At.of(un(o.state,i.query.spec)):L.Py.appendConfig.of(sr)]});return!0},vn=o=>{let i=o.state.field(Pt,!1);if(!i||!i.panel)return!1;let l=(0,G.Sd)(o,li);return l&&l.dom.contains(o.root.activeElement)&&o.focus(),o.dispatch({effects:je.of(!1)}),!0},qr=[{key:"Mod-f",run:Fr,scope:"editor search-panel"},{key:"F3",run:Tn,shift:oi,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:Tn,shift:oi,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:vn,scope:"editor search-panel"},{key:"Mod-Shift-l",run:ji},{key:"Mod-Alt-g",run:Ps},{key:"Mod-d",run:z,preventDefault:!0}];class rr{constructor(i){this.view=i;let l=this.query=i.state.field(Pt).query.spec;this.commit=this.commit.bind(this),this.searchField=hi("input",{value:l.search,placeholder:Ii(i,"Find"),"aria-label":Ii(i,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=hi("input",{value:l.replace,placeholder:Ii(i,"Replace"),"aria-label":Ii(i,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=hi("input",{type:"checkbox",name:"case",form:"",checked:l.caseSensitive,onchange:this.commit}),this.reField=hi("input",{type:"checkbox",name:"re",form:"",checked:l.regexp,onchange:this.commit}),this.wordField=hi("input",{type:"checkbox",name:"word",form:"",checked:l.wholeWord,onchange:this.commit});function h(f,m,k){return hi("button",{class:"cm-button",name:f,onclick:m,type:"button"},k)}this.dom=hi("div",{onkeydown:f=>this.keydown(f),class:"cm-search"},[this.searchField,h("next",()=>Tn(i),[Ii(i,"next")]),h("prev",()=>oi(i),[Ii(i,"previous")]),h("select",()=>Wi(i),[Ii(i,"all")]),hi("label",null,[this.caseField,Ii(i,"match case")]),hi("label",null,[this.reField,Ii(i,"regexp")]),hi("label",null,[this.wordField,Ii(i,"by word")]),...i.state.readOnly?[]:[hi("br"),this.replaceField,h("replace",()=>Mn(i),[Ii(i,"replace")]),h("replaceAll",()=>ir(i),[Ii(i,"replace all")])],hi("button",{name:"close",onclick:()=>vn(i),"aria-label":Ii(i,"close"),type:"button"},["\xD7"])])}commit(){let i=new te({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});i.eq(this.query)||(this.query=i,this.view.dispatch({effects:At.of(i)}))}keydown(i){(0,G.$1)(this.view,i,"search-panel")?i.preventDefault():i.keyCode==13&&i.target==this.searchField?(i.preventDefault(),(i.shiftKey?oi:Tn)(this.view)):i.keyCode==13&&i.target==this.replaceField&&(i.preventDefault(),Mn(this.view))}update(i){for(let l of i.transactions)for(let h of l.effects)h.is(At)&&!h.value.eq(this.query)&&this.setQuery(h.value)}setQuery(i){this.query=i,this.searchField.value=i.search,this.replaceField.value=i.replace,this.caseField.checked=i.caseSensitive,this.reField.checked=i.regexp,this.wordField.checked=i.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(H).top}}function Ii(o,i){return o.state.phrase(i)}const Bi=30,dn=/[\s\.,:;?!]/;function bn(o,{from:i,to:l}){let h=o.state.doc.lineAt(i),f=o.state.doc.lineAt(l).to,m=Math.max(h.from,i-Bi),k=Math.min(f,l+Bi),T=o.state.sliceDoc(m,k);if(m!=h.from){for(let B=0;B<Bi;B++)if(!dn.test(T[B+1])&&dn.test(T[B])){T=T.slice(B);break}}if(k!=f){for(let B=T.length-1;B>T.length-Bi;B--)if(!dn.test(T[B-1])&&dn.test(T[B])){T=T.slice(0,B);break}}return G.tk.announce.of(`${o.state.phrase("current match")}. ${T} ${o.state.phrase("on line")} ${h.number}.`)}const Wr=G.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),sr=[Pt,L.Wl.low(Ui),Wr];class sn{constructor(i,l,h){this.state=i,this.pos=l,this.explicit=h,this.abortListeners=[]}tokenBefore(i){let l=(0,Ce.qz)(this.state).resolveInner(this.pos,-1);for(;l&&i.indexOf(l.name)<0;)l=l.parent;return l?{from:l.from,to:this.pos,text:this.state.sliceDoc(l.from,this.pos),type:l.type}:null}matchBefore(i){let l=this.state.doc.lineAt(this.pos),h=Math.max(l.from,this.pos-250),f=l.text.slice(h-l.from,this.pos-l.from),m=f.search(En(i,!1));return m<0?null:{from:h+m,to:this.pos,text:f.slice(m)}}get aborted(){return this.abortListeners==null}addEventListener(i,l){i=="abort"&&this.abortListeners&&this.abortListeners.push(l)}}function Hr(o){let i=Object.keys(o).join(""),l=/\w/.test(i);return l&&(i=i.replace(/\w/g,"")),`[${l?"\\w":""}${i.replace(/[^\w\s]/g,"\\$&")}]`}function Bn(o){let i=Object.create(null),l=Object.create(null);for(let{label:f}of o){i[f[0]]=!0;for(let m=1;m<f.length;m++)l[f[m]]=!0}let h=Hr(i)+Hr(l)+"*$";return[new RegExp("^"+h),new RegExp(h)]}function or(o){let i=o.map(f=>typeof f=="string"?{label:f}:f),[l,h]=i.every(f=>/^\w+$/.test(f.label))?[/\w*$/,/\w+$/]:Bn(i);return f=>{let m=f.matchBefore(h);return m||f.explicit?{from:m?m.from:f.pos,options:i,validFor:l}:null}}function vr(o,i){return l=>{for(let h=syntaxTree(l.state).resolveInner(l.pos,-1);h;h=h.parent){if(o.indexOf(h.name)>-1)return i(l);if(h.type.isTop)break}return null}}function br(o,i){return l=>{for(let h=syntaxTree(l.state).resolveInner(l.pos,-1);h;h=h.parent){if(o.indexOf(h.name)>-1)return null;if(h.type.isTop)break}return i(l)}}class xr{constructor(i,l,h,f){this.completion=i,this.source=l,this.match=h,this.score=f}}function Qi(o){return o.selection.main.from}function En(o,i){var l;let{source:h}=o,f=i&&h[0]!="^",m=h[h.length-1]!="$";return!f&&!m?o:new RegExp(`${f?"^":""}(?:${h})${m?"$":""}`,(l=o.flags)!==null&&l!==void 0?l:o.ignoreCase?"i":"")}const Jn=L.q6.define();function Un(o,i,l,h){let{main:f}=o.selection,m=l-f.from,k=h-f.from;return Object.assign(Object.assign({},o.changeByRange(T=>T!=f&&l!=h&&o.sliceDoc(T.from+m,T.from+k)!=o.sliceDoc(l,h)?{range:T}:{changes:{from:T.from+m,to:h==f.from?T.to:T.from+k,insert:i},range:L.jT.cursor(T.from+m+i.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const lr=new WeakMap;function ps(o){if(!Array.isArray(o))return o;let i=lr.get(o);return i||lr.set(o,i=or(o)),i}const ar=L.Py.define(),xn=L.Py.define();class Dn{constructor(i){this.pattern=i,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let l=0;l<i.length;){let h=(0,L.gm)(i,l),f=(0,L.nZ)(h);this.chars.push(h);let m=i.slice(l,l+f),k=m.toUpperCase();this.folded.push((0,L.gm)(k==m?m.toLowerCase():k,0)),l+=f}this.astral=i.length!=this.chars.length}ret(i,l){return this.score=i,this.matched=l,!0}match(i){if(this.pattern.length==0)return this.ret(-100,[]);if(i.length<this.pattern.length)return!1;let{chars:l,folded:h,any:f,precise:m,byWord:k}=this;if(l.length==1){let Ei=(0,L.gm)(i,0),fr=(0,L.nZ)(Ei),In=fr==i.length?0:-100;if(Ei!=l[0])if(Ei==h[0])In+=-200;else return!1;return this.ret(In,[0,fr])}let T=i.indexOf(this.pattern);if(T==0)return this.ret(i.length==this.pattern.length?0:-100,[0,this.pattern.length]);let B=l.length,J=0;if(T<0){for(let Ei=0,fr=Math.min(i.length,200);Ei<fr&&J<B;){let In=(0,L.gm)(i,Ei);(In==l[J]||In==h[J])&&(f[J++]=Ei),Ei+=(0,L.nZ)(In)}if(J<B)return!1}let Y=0,ge=0,Be=!1,ut=0,ti=-1,Gi=-1,Yn=/[a-z]/.test(i),Dr=!0;for(let Ei=0,fr=Math.min(i.length,200),In=0;Ei<fr&&ge<B;){let ln=(0,L.gm)(i,Ei);T<0&&(Y<B&&ln==l[Y]&&(m[Y++]=Ei),ut<B&&(ln==l[ut]||ln==h[ut]?(ut==0&&(ti=Ei),Gi=Ei+1,ut++):ut=0));let Or,Pr=ln<255?ln>=48&&ln<=57||ln>=97&&ln<=122?2:ln>=65&&ln<=90?1:0:(Or=(0,L.bg)(ln))!=Or.toLowerCase()?1:Or!=Or.toUpperCase()?2:0;(!Ei||Pr==1&&Yn||In==0&&Pr!=0)&&(l[ge]==ln||h[ge]==ln&&(Be=!0)?k[ge++]=Ei:k.length&&(Dr=!1)),In=Pr,Ei+=(0,L.nZ)(ln)}return ge==B&&k[0]==0&&Dr?this.result(-100+(Be?-200:0),k,i):ut==B&&ti==0?this.ret(-200-i.length+(Gi==i.length?0:-100),[0,Gi]):T>-1?this.ret(-700-i.length,[T,T+this.pattern.length]):ut==B?this.ret(-200+-700-i.length,[ti,Gi]):ge==B?this.result(-100+(Be?-200:0)+-700+(Dr?0:-1100),k,i):l.length==2?!1:this.result((f[0]?-700:0)+-200+-1100,f,i)}result(i,l,h){let f=[],m=0;for(let k of l){let T=k+(this.astral?(0,L.nZ)((0,L.gm)(h,k)):1);m&&f[m-1]==k?f[m-1]=T:(f[m++]=k,f[m++]=T)}return this.ret(i-h.length,f)}}const mi=L.r$.define({combine(o){return(0,L.BO)(o,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Ft,compareCompletions:(i,l)=>i.label.localeCompare(l.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(i,l)=>i&&l,closeOnBlur:(i,l)=>i&&l,icons:(i,l)=>i&&l,tooltipClass:(i,l)=>h=>pn(i(h),l(h)),optionClass:(i,l)=>h=>pn(i(h),l(h)),addToOptions:(i,l)=>i.concat(l)})}});function pn(o,i){return o?i?o+" "+i:o:i}function Ft(o,i,l,h,f,m){let k=o.textDirection==G.Nm.RTL,T=k,B=!1,J="top",Y,ge,Be=i.left-f.left,ut=f.right-i.right,ti=h.right-h.left,Gi=h.bottom-h.top;if(T&&Be<Math.min(ti,ut)?T=!1:!T&&ut<Math.min(ti,Be)&&(T=!0),ti<=(T?Be:ut))Y=Math.max(f.top,Math.min(l.top,f.bottom-Gi))-i.top,ge=Math.min(400,T?Be:ut);else{B=!0,ge=Math.min(400,(k?i.right:f.right-i.left)-30);let Ei=f.bottom-i.bottom;Ei>=Gi||Ei>i.top?Y=l.bottom-i.top:(J="bottom",Y=i.bottom-l.top)}let Yn=(i.bottom-i.top)/m.offsetHeight,Dr=(i.right-i.left)/m.offsetWidth;return{style:`${J}: ${Y/Yn}px; max-width: ${ge/Dr}px`,class:"cm-completionInfo-"+(B?k?"left-narrow":"right-narrow":T?"left":"right")}}function Qr(o){let i=o.addToOptions.slice();return o.icons&&i.push({render(l){let h=document.createElement("div");return h.classList.add("cm-completionIcon"),l.type&&h.classList.add(...l.type.split(/\s+/g).map(f=>"cm-completionIcon-"+f)),h.setAttribute("aria-hidden","true"),h},position:20}),i.push({render(l,h,f,m){let k=document.createElement("span");k.className="cm-completionLabel";let T=l.displayLabel||l.label,B=0;for(let J=0;J<m.length;){let Y=m[J++],ge=m[J++];Y>B&&k.appendChild(document.createTextNode(T.slice(B,Y)));let Be=k.appendChild(document.createElement("span"));Be.appendChild(document.createTextNode(T.slice(Y,ge))),Be.className="cm-completionMatchedText",B=ge}return B<T.length&&k.appendChild(document.createTextNode(T.slice(B))),k},position:50},{render(l){if(!l.detail)return null;let h=document.createElement("span");return h.className="cm-completionDetail",h.textContent=l.detail,h},position:80}),i.sort((l,h)=>l.position-h.position).map(l=>l.render)}function wr(o,i,l){if(o<=l)return{from:0,to:o};if(i<0&&(i=0),i<=o>>1){let f=Math.floor(i/l);return{from:f*l,to:(f+1)*l}}let h=Math.floor((o-i)/l);return{from:o-(h+1)*l,to:o-h*l}}class Sr{constructor(i,l,h){this.view=i,this.stateField=l,this.applyCompletion=h,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:B=>this.placeInfo(B),key:this},this.space=null,this.currentClass="";let f=i.state.field(l),{options:m,selected:k}=f.open,T=i.state.facet(mi);this.optionContent=Qr(T),this.optionClass=T.optionClass,this.tooltipClass=T.tooltipClass,this.range=wr(m.length,k,T.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(i.state),this.dom.addEventListener("mousedown",B=>{let{options:J}=i.state.field(l).open;for(let Y=B.target,ge;Y&&Y!=this.dom;Y=Y.parentNode)if(Y.nodeName=="LI"&&(ge=/-(\d+)$/.exec(Y.id))&&+ge[1]<J.length){this.applyCompletion(i,J[+ge[1]]),B.preventDefault();return}}),this.dom.addEventListener("focusout",B=>{let J=i.state.field(this.stateField,!1);J&&J.tooltip&&i.state.facet(mi).closeOnBlur&&B.relatedTarget!=i.contentDOM&&i.dispatch({effects:xn.of(null)})}),this.showOptions(m,f.id)}mount(){this.updateSel()}showOptions(i,l){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(i,l,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(i){var l;let h=i.state.field(this.stateField),f=i.startState.field(this.stateField);if(this.updateTooltipClass(i.state),h!=f){let{options:m,selected:k,disabled:T}=h.open;(!f.open||f.open.options!=m)&&(this.range=wr(m.length,k,i.state.facet(mi).maxRenderedOptions),this.showOptions(m,h.id)),this.updateSel(),T!=((l=f.open)===null||l===void 0?void 0:l.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!T)}}updateTooltipClass(i){let l=this.tooltipClass(i);if(l!=this.currentClass){for(let h of this.currentClass.split(" "))h&&this.dom.classList.remove(h);for(let h of l.split(" "))h&&this.dom.classList.add(h);this.currentClass=l}}positioned(i){this.space=i,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let i=this.view.state.field(this.stateField),l=i.open;if((l.selected>-1&&l.selected<this.range.from||l.selected>=this.range.to)&&(this.range=wr(l.options.length,l.selected,this.view.state.facet(mi).maxRenderedOptions),this.showOptions(l.options,i.id)),this.updateSelectedOption(l.selected)){this.destroyInfo();let{completion:h}=l.options[l.selected],{info:f}=h;if(!f)return;let m=typeof f=="string"?document.createTextNode(f):f(h);if(!m)return;"then"in m?m.then(k=>{k&&this.view.state.field(this.stateField,!1)==i&&this.addInfoPane(k,h)}).catch(k=>(0,G.OO)(this.view.state,k,"completion info")):this.addInfoPane(m,h)}}addInfoPane(i,l){this.destroyInfo();let h=this.info=document.createElement("div");if(h.className="cm-tooltip cm-completionInfo",i.nodeType!=null)h.appendChild(i),this.infoDestroy=null;else{let{dom:f,destroy:m}=i;h.appendChild(f),this.infoDestroy=m||null}this.dom.appendChild(h),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(i){let l=null;for(let h=this.list.firstChild,f=this.range.from;h;h=h.nextSibling,f++)h.nodeName!="LI"||!h.id?f--:f==i?h.hasAttribute("aria-selected")||(h.setAttribute("aria-selected","true"),l=h):h.hasAttribute("aria-selected")&&h.removeAttribute("aria-selected");return l&&_i(this.list,l),l}measureInfo(){let i=this.dom.querySelector("[aria-selected]");if(!i||!this.info)return null;let l=this.dom.getBoundingClientRect(),h=this.info.getBoundingClientRect(),f=i.getBoundingClientRect(),m=this.space;if(!m){let k=this.dom.ownerDocument.defaultView||window;m={left:0,top:0,right:k.innerWidth,bottom:k.innerHeight}}return f.top>Math.min(m.bottom,l.bottom)-10||f.bottom<Math.max(m.top,l.top)+10?null:this.view.state.facet(mi).positionInfo(this.view,l,f,h,m,this.dom)}placeInfo(i){this.info&&(i?(i.style&&(this.info.style.cssText=i.style),this.info.className="cm-tooltip cm-completionInfo "+(i.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(i,l,h){const f=document.createElement("ul");f.id=l,f.setAttribute("role","listbox"),f.setAttribute("aria-expanded","true"),f.setAttribute("aria-label",this.view.state.phrase("Completions"));let m=null;for(let k=h.from;k<h.to;k++){let{completion:T,match:B}=i[k],{section:J}=T;if(J){let Be=typeof J=="string"?J:J.name;if(Be!=m&&(k>h.from||h.from==0))if(m=Be,typeof J!="string"&&J.header)f.appendChild(J.header(J));else{let ut=f.appendChild(document.createElement("completion-section"));ut.textContent=Be}}const Y=f.appendChild(document.createElement("li"));Y.id=l+"-"+k,Y.setAttribute("role","option");let ge=this.optionClass(T);ge&&(Y.className=ge);for(let Be of this.optionContent){let ut=Be(T,this.view.state,this.view,B);ut&&Y.appendChild(ut)}}return h.from&&f.classList.add("cm-completionListIncompleteTop"),h.to<i.length&&f.classList.add("cm-completionListIncompleteBottom"),f}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function kr(o,i){return l=>new Sr(l,o,i)}function _i(o,i){let l=o.getBoundingClientRect(),h=i.getBoundingClientRect(),f=l.height/o.offsetHeight;h.top<l.top?o.scrollTop-=(l.top-h.top)/f:h.bottom>l.bottom&&(o.scrollTop+=(h.bottom-l.bottom)/f)}function Re(o){return(o.boost||0)*100+(o.apply?10:0)+(o.info?5:0)+(o.type?1:0)}function ai(o,i){let l=[],h=null,f=B=>{l.push(B);let{section:J}=B.completion;if(J){h||(h=[]);let Y=typeof J=="string"?J:J.name;h.some(ge=>ge.name==Y)||h.push(typeof J=="string"?{name:Y}:J)}};for(let B of o)if(B.hasResult()){let J=B.result.getMatch;if(B.result.filter===!1)for(let Y of B.result.options)f(new xr(Y,B.source,J?J(Y):[],1e9-l.length));else{let Y=new Dn(i.sliceDoc(B.from,B.to));for(let ge of B.result.options)if(Y.match(ge.label)){let Be=ge.displayLabel?J?J(ge,Y.matched):[]:Y.matched;f(new xr(ge,B.source,Be,Y.score+(ge.boost||0)))}}}if(h){let B=Object.create(null),J=0,Y=(ge,Be)=>{var ut,ti;return((ut=ge.rank)!==null&&ut!==void 0?ut:1e9)-((ti=Be.rank)!==null&&ti!==void 0?ti:1e9)||(ge.name<Be.name?-1:1)};for(let ge of h.sort(Y))J-=1e5,B[ge.name]=J;for(let ge of l){let{section:Be}=ge.completion;Be&&(ge.score+=B[typeof Be=="string"?Be:Be.name])}}let m=[],k=null,T=i.facet(mi).compareCompletions;for(let B of l.sort((J,Y)=>Y.score-J.score||T(J.completion,Y.completion))){let J=B.completion;!k||k.label!=J.label||k.detail!=J.detail||k.type!=null&&J.type!=null&&k.type!=J.type||k.apply!=J.apply||k.boost!=J.boost?m.push(B):Re(B.completion)>Re(k)&&(m[m.length-1]=B),k=B.completion}return m}class wn{constructor(i,l,h,f,m,k){this.options=i,this.attrs=l,this.tooltip=h,this.timestamp=f,this.selected=m,this.disabled=k}setSelected(i,l){return i==this.selected||i>=this.options.length?this:new wn(this.options,_r(l,i),this.tooltip,this.timestamp,i,this.disabled)}static build(i,l,h,f,m){let k=ai(i,l);if(!k.length)return f&&i.some(B=>B.state==1)?new wn(f.options,f.attrs,f.tooltip,f.timestamp,f.selected,!0):null;let T=l.facet(mi).selectOnOpen?0:-1;if(f&&f.selected!=T&&f.selected!=-1){let B=f.options[f.selected].completion;for(let J=0;J<k.length;J++)if(k[J].completion==B){T=J;break}}return new wn(k,_r(h,T),{pos:i.reduce((B,J)=>J.hasResult()?Math.min(B,J.from):B,1e8),create:Te,above:m.aboveCursor},f?f.timestamp:Date.now(),T,!1)}map(i){return new wn(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:i.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class Ln{constructor(i,l,h){this.active=i,this.id=l,this.open=h}static start(){return new Ln(zn,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(i){let{state:l}=i,h=l.facet(mi),m=(h.override||l.languageDataAt("autocomplete",Qi(l)).map(ps)).map(T=>(this.active.find(J=>J.source==T)||new on(T,this.active.some(J=>J.state!=0)?1:0)).update(i,h));m.length==this.active.length&&m.every((T,B)=>T==this.active[B])&&(m=this.active);let k=this.open;k&&i.docChanged&&(k=k.map(i.changes)),i.selection||m.some(T=>T.hasResult()&&i.changes.touchesRange(T.from,T.to))||!Hs(m,this.active)?k=wn.build(m,l,this.id,k,h):k&&k.disabled&&!m.some(T=>T.state==1)&&(k=null),!k&&m.every(T=>T.state!=1)&&m.some(T=>T.hasResult())&&(m=m.map(T=>T.hasResult()?new on(T.source,0):T));for(let T of i.effects)T.is(ts)&&(k=k&&k.setSelected(T.value,this.id));return m==this.active&&k==this.open?this:new Ln(m,this.id,k)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:Vs}}function Hs(o,i){if(o==i)return!0;for(let l=0,h=0;;){for(;l<o.length&&!o[l].hasResult;)l++;for(;h<i.length&&!i[h].hasResult;)h++;let f=l==o.length,m=h==i.length;if(f||m)return f==m;if(o[l++].result!=i[h++].result)return!1}}const Vs={"aria-autocomplete":"list"};function _r(o,i){let l={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":o};return i>-1&&(l["aria-activedescendant"]=o+"-"+i),l}const zn=[];function ms(o){return o.isUserEvent("input.type")?"input":o.isUserEvent("delete.backward")?"delete":null}class on{constructor(i,l,h=-1){this.source=i,this.state=l,this.explicitPos=h}hasResult(){return!1}update(i,l){let h=ms(i),f=this;h?f=f.handleUserEvent(i,h,l):i.docChanged?f=f.handleChange(i):i.selection&&f.state!=0&&(f=new on(f.source,0));for(let m of i.effects)if(m.is(ar))f=new on(f.source,1,m.value?Qi(i.state):-1);else if(m.is(xn))f=new on(f.source,0);else if(m.is(es))for(let k of m.value)k.source==f.source&&(f=k);return f}handleUserEvent(i,l,h){return l=="delete"||!h.activateOnTyping?this.map(i.changes):new on(this.source,1)}handleChange(i){return i.changes.touchesRange(Qi(i.startState))?new on(this.source,0):this.map(i.changes)}map(i){return i.empty||this.explicitPos<0?this:new on(this.source,this.state,i.mapPos(this.explicitPos))}}class Gn extends on{constructor(i,l,h,f,m){super(i,2,l),this.result=h,this.from=f,this.to=m}hasResult(){return!0}handleUserEvent(i,l,h){var f;let m=i.changes.mapPos(this.from),k=i.changes.mapPos(this.to,1),T=Qi(i.state);if((this.explicitPos<0?T<=m:T<this.from)||T>k||l=="delete"&&Qi(i.startState)==this.from)return new on(this.source,l=="input"&&h.activateOnTyping?1:0);let B=this.explicitPos<0?-1:i.changes.mapPos(this.explicitPos),J;return Cr(this.result.validFor,i.state,m,k)?new Gn(this.source,B,this.result,m,k):this.result.update&&(J=this.result.update(this.result,m,k,new sn(i.state,T,B>=0)))?new Gn(this.source,B,J,J.from,(f=J.to)!==null&&f!==void 0?f:Qi(i.state)):new on(this.source,1,B)}handleChange(i){return i.changes.touchesRange(this.from,this.to)?new on(this.source,0):this.map(i.changes)}map(i){return i.empty?this:new Gn(this.source,this.explicitPos<0?-1:i.mapPos(this.explicitPos),this.result,i.mapPos(this.from),i.mapPos(this.to,1))}}function Cr(o,i,l,h){if(!o)return!1;let f=i.sliceDoc(l,h);return typeof o=="function"?o(f,l,h,i):En(o,!0).test(f)}const es=L.Py.define({map(o,i){return o.map(l=>l.map(i))}}),ts=L.Py.define(),xi=L.QQ.define({create(){return Ln.start()},update(o,i){return o.update(i)},provide:o=>[G.hJ.from(o,i=>i.tooltip),G.tk.contentAttributes.from(o,i=>i.attrs)]});function Qe(o,i){const l=i.completion.apply||i.completion.label;let h=o.state.field(xi).active.find(f=>f.source==i.source);return h instanceof Gn?(typeof l=="string"?o.dispatch(Object.assign(Object.assign({},Un(o.state,l,h.from,h.to)),{annotations:Jn.of(i.completion)})):l(o,i.completion,h.from,h.to),!0):!1}const Te=kr(xi,Qe);function we(o,i="option"){return l=>{let h=l.state.field(xi,!1);if(!h||!h.open||h.open.disabled||Date.now()-h.open.timestamp<l.state.facet(mi).interactionDelay)return!1;let f=1,m;i=="page"&&(m=(0,G.gB)(l,h.open.tooltip))&&(f=Math.max(2,Math.floor(m.dom.offsetHeight/m.dom.querySelector("li").offsetHeight)-1));let{length:k}=h.open.options,T=h.open.selected>-1?h.open.selected+f*(o?1:-1):o?0:k-1;return T<0?T=i=="page"?0:k-1:T>=k&&(T=i=="page"?k-1:0),l.dispatch({effects:ts.of(T)}),!0}}const ze=o=>{let i=o.state.field(xi,!1);return o.state.readOnly||!i||!i.open||i.open.selected<0||i.open.disabled||Date.now()-i.open.timestamp<o.state.facet(mi).interactionDelay?!1:Qe(o,i.open.options[i.open.selected])},xt=o=>o.state.field(xi,!1)?(o.dispatch({effects:ar.of(!0)}),!0):!1,wt=o=>{let i=o.state.field(xi,!1);return!i||!i.active.some(l=>l.state!=0)?!1:(o.dispatch({effects:xn.of(null)}),!0)};class gi{constructor(i,l){this.active=i,this.context=l,this.time=Date.now(),this.updates=[],this.done=void 0}}const Mi=50,Sn=1e3,gs=G.lg.fromClass(class{constructor(o){this.view=o,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let i of o.state.field(xi).active)i.state==1&&this.startQuery(i)}update(o){let i=o.state.field(xi);if(!o.selectionSet&&!o.docChanged&&o.startState.field(xi)==i)return;let l=o.transactions.some(h=>(h.selection||h.docChanged)&&!ms(h));for(let h=0;h<this.running.length;h++){let f=this.running[h];if(l||f.updates.length+o.transactions.length>Mi&&Date.now()-f.time>Sn){for(let m of f.context.abortListeners)try{m()}catch(k){(0,G.OO)(this.view.state,k)}f.context.abortListeners=null,this.running.splice(h--,1)}else f.updates.push(...o.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=i.active.some(h=>h.state==1&&!this.running.some(f=>f.active.source==h.source))?setTimeout(()=>this.startUpdate(),50):-1,this.composing!=0)for(let h of o.transactions)ms(h)=="input"?this.composing=2:this.composing==2&&h.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:o}=this.view,i=o.field(xi);for(let l of i.active)l.state==1&&!this.running.some(h=>h.active.source==l.source)&&this.startQuery(l)}startQuery(o){let{state:i}=this.view,l=Qi(i),h=new sn(i,l,o.explicitPos==l),f=new gi(o,h);this.running.push(f),Promise.resolve(o.source(h)).then(m=>{f.context.aborted||(f.done=m||null,this.scheduleAccept())},m=>{this.view.dispatch({effects:xn.of(null)}),(0,G.OO)(this.view.state,m)})}scheduleAccept(){this.running.every(o=>o.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(mi).updateSyncTime))}accept(){var o;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let i=[],l=this.view.state.facet(mi);for(let h=0;h<this.running.length;h++){let f=this.running[h];if(f.done===void 0)continue;if(this.running.splice(h--,1),f.done){let k=new Gn(f.active.source,f.active.explicitPos,f.done,f.done.from,(o=f.done.to)!==null&&o!==void 0?o:Qi(f.updates.length?f.updates[0].startState:this.view.state));for(let T of f.updates)k=k.update(T,l);if(k.hasResult()){i.push(k);continue}}let m=this.view.state.field(xi).active.find(k=>k.source==f.active.source);if(m&&m.state==1)if(f.done==null){let k=new on(f.active.source,0);for(let T of f.updates)k=k.update(T,l);k.state!=1&&i.push(k)}else this.startQuery(m)}i.length&&this.view.dispatch({effects:es.of(i)})}},{eventHandlers:{blur(o){let i=this.view.state.field(xi,!1);if(i&&i.tooltip&&this.view.state.facet(mi).closeOnBlur){let l=i.open&&(0,G.gB)(this.view,i.open.tooltip);(!l||!l.dom.contains(o.relatedTarget))&&this.view.dispatch({effects:xn.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:ar.of(!1)}),20),this.composing=0}}}),is=G.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class so{constructor(i,l,h,f){this.field=i,this.line=l,this.from=h,this.to=f}}class ys{constructor(i,l,h){this.field=i,this.from=l,this.to=h}map(i){let l=i.mapPos(this.from,-1,MapMode.TrackDel),h=i.mapPos(this.to,1,MapMode.TrackDel);return l==null||h==null?null:new ys(this.field,l,h)}}class oo{constructor(i,l){this.lines=i,this.fieldPositions=l}instantiate(i,l){let h=[],f=[l],m=i.doc.lineAt(l),k=/^\s*/.exec(m.text)[0];for(let B of this.lines){if(h.length){let J=k,Y=/^\t*/.exec(B)[0].length;for(let ge=0;ge<Y;ge++)J+=i.facet(indentUnit);f.push(l+J.length-Y),B=J+B.slice(Y)}h.push(B),l+=B.length+1}let T=this.fieldPositions.map(B=>new ys(B.field,f[B.line]+B.from,f[B.line]+B.to));return{text:h,ranges:T}}static parse(i){let l=[],h=[],f=[],m;for(let k of i.split(/\r\n?|\n/)){for(;m=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(k);){let T=m[1]?+m[1]:null,B=m[2]||m[3]||"",J=-1;for(let Y=0;Y<l.length;Y++)(T!=null?l[Y].seq==T:B&&l[Y].name==B)&&(J=Y);if(J<0){let Y=0;for(;Y<l.length&&(T==null||l[Y].seq!=null&&l[Y].seq<T);)Y++;l.splice(Y,0,{seq:T,name:B}),J=Y;for(let ge of f)ge.field>=J&&ge.field++}f.push(new so(J,h.length,m.index,m.index+B.length)),k=k.slice(0,m.index)+B+k.slice(m.index+m[0].length)}for(let T;T=/\\([{}])/.exec(k);){k=k.slice(0,T.index)+T[1]+k.slice(T.index+T[0].length);for(let B of f)B.line==h.length&&B.from>T.index&&(B.from--,B.to--)}h.push(k)}return new oo(h,f)}}let So=G.p.widget({widget:new class extends G.l9{toDOM(){let o=document.createElement("span");return o.className="cm-snippetFieldPosition",o}ignoreEvent(){return!1}}}),vs=G.p.mark({class:"cm-snippetField"});class ns{constructor(i,l){this.ranges=i,this.active=l,this.deco=G.p.set(i.map(h=>(h.from==h.to?So:vs).range(h.from,h.to)))}map(i){let l=[];for(let h of this.ranges){let f=h.map(i);if(!f)return null;l.push(f)}return new ns(l,this.active)}selectionInsideField(i){return i.ranges.every(l=>this.ranges.some(h=>h.field==this.active&&h.from<=l.from&&h.to>=l.to))}}const bs=L.Py.define({map(o,i){return o&&o.map(i)}}),ko=L.Py.define(),Vr=L.QQ.define({create(){return null},update(o,i){for(let l of i.effects){if(l.is(bs))return l.value;if(l.is(ko)&&o)return new ns(o.ranges,l.value)}return o&&i.docChanged&&(o=o.map(i.changes)),o&&i.selection&&!o.selectionInsideField(i.selection)&&(o=null),o},provide:o=>G.tk.decorations.from(o,i=>i?i.deco:G.p.none)});function xs(o,i){return L.jT.create(o.filter(l=>l.field==i).map(l=>L.jT.range(l.from,l.to)))}function lo(o){let i=oo.parse(o);return(l,h,f,m)=>{let{text:k,ranges:T}=i.instantiate(l.state,f),B={changes:{from:f,to:m,insert:Text.of(k)},scrollIntoView:!0,annotations:h?Jn.of(h):void 0};if(T.length&&(B.selection=xs(T,0)),T.length>1){let J=new ns(T,0),Y=B.effects=[bs.of(J)];l.state.field(Vr,!1)===void 0&&Y.push(StateEffect.appendConfig.of([Vr,Yo,qo,is]))}l.dispatch(l.state.update(B))}}function Co(o){return({state:i,dispatch:l})=>{let h=i.field(Vr,!1);if(!h||o<0&&h.active==0)return!1;let f=h.active+o,m=o>0&&!h.ranges.some(k=>k.field==f+o);return l(i.update({selection:xs(h.ranges,f),effects:bs.of(m?null:new ns(h.ranges,f)),scrollIntoView:!0})),!0}}const Go=({state:o,dispatch:i})=>o.field(Vr,!1)?(i(o.update({effects:bs.of(null)})),!0):!1,ao=Co(1),Xo=Co(-1);function ho(o){let i=o.field(Vr,!1);return!!(i&&i.ranges.some(l=>l.field==i.active+1))}function xl(o){let i=o.field(Vr,!1);return!!(i&&i.active>0)}const Ao=[{key:"Tab",run:ao,shift:Xo},{key:"Escape",run:Go}],To=L.r$.define({combine(o){return o.length?o[0]:Ao}}),Yo=L.Wl.highest(G.$f.compute([To],o=>o.facet(To)));function wl(o,i){return Object.assign(Object.assign({},i),{apply:lo(o)})}const qo=G.tk.domEventHandlers({mousedown(o,i){let l=i.state.field(Vr,!1),h;if(!l||(h=i.posAtCoords({x:o.clientX,y:o.clientY}))==null)return!1;let f=l.ranges.find(m=>m.from<=h&&m.to>=h);return!f||f.field==l.active?!1:(i.dispatch({selection:xs(l.ranges,f.field),effects:bs.of(l.ranges.some(m=>m.field>f.field)?new ns(l.ranges,f.field):null),scrollIntoView:!0}),!0)}});function Qo(o){let i=o.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${i}]+`,"ug")}catch{return new RegExp(`[w${i}]`,"g")}}function co(o,i){return new RegExp(i(o.source),o.unicode?"u":"")}const _o=null;function el(o){return _o[o]||(_o[o]=new WeakMap)}function Mo(o,i,l,h,f){for(let m=o.iterLines(),k=0;!m.next().done;){let{value:T}=m,B;for(i.lastIndex=0;B=i.exec(T);)if(!h[B[0]]&&k+B.index!=f&&(l.push({type:"text",label:B[0]}),h[B[0]]=!0,l.length>=2e3))return;k+=T.length+1}}function Eo(o,i,l,h,f){let m=o.length>=1e3,k=m&&i.get(o);if(k)return k;let T=[],B=Object.create(null);if(o.children){let J=0;for(let Y of o.children){if(Y.length>=1e3)for(let ge of Eo(Y,i,l,h-J,f-J))B[ge.label]||(B[ge.label]=!0,T.push(ge));else Mo(Y,l,T,B,f-J);J+=Y.length+1}}else Mo(o,l,T,B,f);return m&&T.length<2e3&&i.set(o,T),T}const Sl=o=>{let i=o.state.languageDataAt("wordChars",o.pos).join(""),l=Qo(i),h=o.matchBefore(co(l,k=>k+"$"));if(!h&&!o.explicit)return null;let f=h?h.from:o.pos,m=Eo(o.state.doc,el(i),l,5e4,f);return{from:f,options:m,validFor:co(l,k=>"^"+k)}},ws={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},hr=L.Py.define({map(o,i){let l=i.mapPos(o,-1,L.gc.TrackAfter);return l==null?void 0:l}}),fo=new class extends L.uU{};fo.startSide=1,fo.endSide=-1;const Do=L.QQ.define({create(){return L.Xs.empty},update(o,i){if(o=o.map(i.changes),i.selection){let l=i.state.doc.lineAt(i.selection.main.head);o=o.update({filter:h=>h>=l.from&&h<=l.to})}for(let l of i.effects)l.is(hr)&&(o=o.update({add:[fo.range(l.value,l.value+1)]}));return o}});function Oo(){return[il,Do]}const uo="()[]{}<>";function Po(o){for(let i=0;i<uo.length;i+=2)if(uo.charCodeAt(i)==o)return uo.charAt(i+1);return(0,L.bg)(o<128?o:o+1)}function Ro(o,i){return o.languageDataAt("closeBrackets",i)[0]||ws}const tl=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),il=G.tk.inputHandler.of((o,i,l,h)=>{if((tl?o.composing:o.compositionStarted)||o.state.readOnly)return!1;let f=o.state.selection.main;if(h.length>2||h.length==2&&(0,L.nZ)((0,L.gm)(h,0))==1||i!=f.from||l!=f.to)return!1;let m=kl(o.state,h);return m?(o.dispatch(m),!0):!1}),Bo=[{key:"Backspace",run:({state:o,dispatch:i})=>{if(o.readOnly)return!1;let h=Ro(o,o.selection.main.head).brackets||ws.brackets,f=null,m=o.changeByRange(k=>{if(k.empty){let T=Io(o.doc,k.head);for(let B of h)if(B==T&&zr(o.doc,k.head)==Po((0,L.gm)(B,0)))return{changes:{from:k.head-B.length,to:k.head+B.length},range:L.jT.cursor(k.head-B.length)}}return{range:f=k}});return f||i(o.update(m,{scrollIntoView:!0,userEvent:"delete.backward"})),!f}}];function kl(o,i){let l=Ro(o,o.selection.main.head),h=l.brackets||ws.brackets;for(let f of h){let m=Po((0,L.gm)(f,0));if(i==f)return m==f?rl(o,f,h.indexOf(f+f+f)>-1,l):$s(o,f,m,l.before||ws.before);if(i==m&&Lo(o,o.selection.main.from))return nl(o,f,m)}return null}function Lo(o,i){let l=!1;return o.field(Do).between(0,o.doc.length,h=>{h==i&&(l=!0)}),l}function zr(o,i){let l=o.sliceString(i,i+2);return l.slice(0,(0,L.nZ)((0,L.gm)(l,0)))}function Io(o,i){let l=o.sliceString(i-2,i);return(0,L.nZ)((0,L.gm)(l,0))==l.length?l:l.slice(1)}function $s(o,i,l,h){let f=null,m=o.changeByRange(k=>{if(!k.empty)return{changes:[{insert:i,from:k.from},{insert:l,from:k.to}],effects:hr.of(k.to+i.length),range:L.jT.range(k.anchor+i.length,k.head+i.length)};let T=zr(o.doc,k.head);return!T||/\s/.test(T)||h.indexOf(T)>-1?{changes:{insert:i+l,from:k.head},effects:hr.of(k.head+i.length),range:L.jT.cursor(k.head+i.length)}:{range:f=k}});return f?null:o.update(m,{scrollIntoView:!0,userEvent:"input.type"})}function nl(o,i,l){let h=null,f=o.changeByRange(m=>m.empty&&zr(o.doc,m.head)==l?{changes:{from:m.head,to:m.head+l.length,insert:l},range:L.jT.cursor(m.head+l.length)}:h={range:m});return h?null:o.update(f,{scrollIntoView:!0,userEvent:"input.type"})}function rl(o,i,l,h){let f=h.stringPrefixes||ws.stringPrefixes,m=null,k=o.changeByRange(T=>{if(!T.empty)return{changes:[{insert:i,from:T.from},{insert:i,from:T.to}],effects:hr.of(T.to+i.length),range:L.jT.range(T.anchor+i.length,T.head+i.length)};let B=T.head,J=zr(o.doc,B),Y;if(J==i){if(js(o,B))return{changes:{insert:i+i,from:B},effects:hr.of(B+i.length),range:L.jT.cursor(B+i.length)};if(Lo(o,B)){let Be=l&&o.sliceDoc(B,B+i.length*3)==i+i+i?i+i+i:i;return{changes:{from:B,to:B+Be.length,insert:Be},range:L.jT.cursor(B+Be.length)}}}else{if(l&&o.sliceDoc(B-2*i.length,B)==i+i&&(Y=ks(o,B-2*i.length,f))>-1&&js(o,Y))return{changes:{insert:i+i+i+i,from:B},effects:hr.of(B+i.length),range:L.jT.cursor(B+i.length)};if(o.charCategorizer(B)(J)!=L.D0.Word&&ks(o,B,f)>-1&&!Ss(o,B,i,f))return{changes:{insert:i+i,from:B},effects:hr.of(B+i.length),range:L.jT.cursor(B+i.length)}}return{range:m=T}});return m?null:o.update(k,{scrollIntoView:!0,userEvent:"input.type"})}function js(o,i){let l=(0,Ce.qz)(o).resolveInner(i+1);return l.parent&&l.from==i}function Ss(o,i,l,h){let f=(0,Ce.qz)(o).resolveInner(i,-1),m=h.reduce((k,T)=>Math.max(k,T.length),0);for(let k=0;k<5;k++){let T=o.sliceDoc(f.from,Math.min(f.to,f.from+l.length+m)),B=T.indexOf(l);if(!B||B>-1&&h.indexOf(T.slice(0,B))>-1){let Y=f.firstChild;for(;Y&&Y.from==f.from&&Y.to-Y.from>l.length+B;){if(o.sliceDoc(Y.to-l.length,Y.to)==l)return!1;Y=Y.firstChild}return!0}let J=f.to==i&&f.parent;if(!J)break;f=J}return!1}function ks(o,i,l){let h=o.charCategorizer(i);if(h(o.sliceDoc(i-1,i))!=L.D0.Word)return i;for(let f of l){let m=i-f.length;if(o.sliceDoc(m,i)==f&&h(o.sliceDoc(m-1,m))!=L.D0.Word)return m}return-1}function sl(o={}){return[xi,mi.of(o),gs,Zs,is]}const No=[{key:"Ctrl-Space",run:xt},{key:"Escape",run:wt},{key:"ArrowDown",run:we(!0)},{key:"ArrowUp",run:we(!1)},{key:"PageDown",run:we(!0,"page")},{key:"PageUp",run:we(!1,"page")},{key:"Enter",run:ze}],Zs=L.Wl.highest(G.$f.computeN([mi],o=>o.facet(mi).defaultKeymap?[No]:[]));function Cl(o){let i=o.field(xi,!1);return i&&i.active.some(l=>l.state==1)?"pending":i&&i.active.some(l=>l.state!=0)?"active":null}const Fo=new WeakMap;function Al(o){var i;let l=(i=o.field(xi,!1))===null||i===void 0?void 0:i.open;if(!l||l.disabled)return[];let h=Fo.get(l.options);return h||Fo.set(l.options,h=l.options.map(f=>f.completion)),h}function Tl(o){var i;let l=(i=o.field(xi,!1))===null||i===void 0?void 0:i.open;return l&&!l.disabled&&l.selected>=0?l.options[l.selected].completion:null}function Pl(o){var i;let l=(i=o.field(xi,!1))===null||i===void 0?void 0:i.open;return l&&!l.disabled&&l.selected>=0?l.selected:null}function Ml(o){return ts.of(o)}class El{constructor(i,l,h){this.from=i,this.to=l,this.diagnostic=h}}class rs{constructor(i,l,h){this.diagnostics=i,this.panel=l,this.selected=h}static init(i,l,h){let f=i,m=h.facet(Us).markerFilter;m&&(f=m(f));let k=G.p.set(f.map(T=>T.from==T.to||T.from==T.to-1&&h.doc.lineAt(T.from).to==T.from?G.p.widget({widget:new vo(T),diagnostic:T}).range(T.from):G.p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+T.severity+(T.markClass?" "+T.markClass:"")},diagnostic:T}).range(T.from,T.to)),!0);return new rs(k,l,Ar(k))}}function Ar(o,i=null,l=0){let h=null;return o.between(l,1e9,(f,m,{spec:k})=>{if(!(i&&k.diagnostic!=i))return h=new El(f,m,k.diagnostic),!1}),h}function ol(o,i){let l=o.startState.doc.lineAt(i.pos);return!!(o.effects.some(h=>h.is($r))||o.changes.touchesRange(l.from,l.to))}function Wo(o,i){return o.field(Ai,!1)?i:i.concat(L.Py.appendConfig.of(s))}function ll(o,i){return{effects:Wo(o,[$r.of(i)])}}const $r=L.Py.define(),Ks=L.Py.define(),Js=L.Py.define(),Ai=L.QQ.define({create(){return new rs(G.p.none,null,null)},update(o,i){if(i.docChanged){let l=o.diagnostics.map(i.changes),h=null;if(o.selected){let f=i.changes.mapPos(o.selected.from,1);h=Ar(l,o.selected.diagnostic,f)||Ar(l,null,f)}o=new rs(l,o.panel,h)}for(let l of i.effects)l.is($r)?o=rs.init(l.value,o.panel,i.state):l.is(Ks)?o=new rs(o.diagnostics,l.value?Xs.open:null,o.selected):l.is(Js)&&(o=new rs(o.diagnostics,o.panel,l.value));return o},provide:o=>[G.mH.from(o,i=>i.panel),G.tk.decorations.from(o,i=>i.diagnostics)]});function po(o){let i=o.field(Ai,!1);return i?i.diagnostics.size:0}const al=G.p.mark({class:"cm-lintRange cm-lintRange-active"});function Cs(o,i,l){let{diagnostics:h}=o.state.field(Ai),f=[],m=2e8,k=0;h.between(i-(l<0?1:0),i+(l>0?1:0),(B,J,{spec:Y})=>{i>=B&&i<=J&&(B==J||(i>B||l>0)&&(i<J||l<0))&&(f.push(Y.diagnostic),m=Math.min(B,m),k=Math.max(J,k))});let T=o.state.facet(Us).tooltipFilter;return T&&(f=T(f)),f.length?{pos:m,end:k,above:o.state.doc.lineAt(m).to<k,create(){return{dom:Ho(o,f)}}}:null}function Ho(o,i){return hi("ul",{class:"cm-tooltip-lint"},i.map(l=>jr(o,l,!1)))}const mo=o=>{let i=o.state.field(Ai,!1);(!i||!i.panel)&&o.dispatch({effects:Wo(o.state,[Ks.of(!0)])});let l=(0,G.Sd)(o,Xs.open);return l&&l.dom.querySelector(".cm-panel-lint ul").focus(),!0},go=o=>{let i=o.state.field(Ai,!1);return!i||!i.panel?!1:(o.dispatch({effects:Ks.of(!1)}),!0)},hl=o=>{let i=o.state.field(Ai,!1);if(!i)return!1;let l=o.state.selection.main,h=i.diagnostics.iter(l.to+1);return!h.value&&(h=i.diagnostics.iter(0),!h.value||h.from==l.from&&h.to==l.to)?!1:(o.dispatch({selection:{anchor:h.from,head:h.to},scrollIntoView:!0}),!0)},cl=o=>{let{state:i}=o,l=i.field(Ai,!1);if(!l)return!1;let h=i.selection.main,f,m,k,T;return l.diagnostics.between(0,i.doc.length,(B,J)=>{J<h.to&&(f==null||f<B)&&(f=B,m=J),(k==null||B>k)&&(k=B,T=J)}),k==null||f==null&&k==h.from?!1:(o.dispatch({selection:{anchor:f!=null?f:k,head:m!=null?m:T},scrollIntoView:!0}),!0)},yo=[{key:"Mod-Shift-m",run:mo,preventDefault:!0},{key:"F8",run:hl}],Vo=null,Us=L.r$.define({combine(o){return Object.assign({sources:o.map(i=>i.source)},(0,L.BO)(o.map(i=>i.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(i,l)=>i?l?h=>i(h)||l(h):i:l}))}});function fl(o,i={}){return[Us.of({source:o,config:i}),Vo,s]}function Dl(o){let i=o.plugin(Vo);i&&i.force()}function zo(o){let i=[];if(o)e:for(let{name:l}of o){for(let h=0;h<l.length;h++){let f=l[h];if(/[a-zA-Z]/.test(f)&&!i.some(m=>m.toLowerCase()==f.toLowerCase())){i.push(f);continue e}}i.push("")}return i}function jr(o,i,l){var h;let f=l?zo(i.actions):[];return hi("li",{class:"cm-diagnostic cm-diagnostic-"+i.severity},hi("span",{class:"cm-diagnosticText"},i.renderMessage?i.renderMessage():i.message),(h=i.actions)===null||h===void 0?void 0:h.map((m,k)=>{let T=!1,B=Be=>{if(Be.preventDefault(),T)return;T=!0;let ut=Ar(o.state.field(Ai).diagnostics,i);ut&&m.apply(o,ut.from,ut.to)},{name:J}=m,Y=f[k]?J.indexOf(f[k]):-1,ge=Y<0?J:[J.slice(0,Y),hi("u",J.slice(Y,Y+1)),J.slice(Y+1)];return hi("button",{type:"button",class:"cm-diagnosticAction",onclick:B,onmousedown:B,"aria-label":` Action: ${J}${Y<0?"":` (access key "${f[k]})"`}.`},ge)}),i.source&&hi("div",{class:"cm-diagnosticSource"},i.source))}class vo extends G.l9{constructor(i){super(),this.diagnostic=i}eq(i){return i.diagnostic==this.diagnostic}toDOM(){return hi("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Gs{constructor(i,l){this.diagnostic=l,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=jr(i,l,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Xs{constructor(i){this.view=i,this.items=[];let l=f=>{if(f.keyCode==27)go(this.view),this.view.focus();else if(f.keyCode==38||f.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(f.keyCode==40||f.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(f.keyCode==36)this.moveSelection(0);else if(f.keyCode==35)this.moveSelection(this.items.length-1);else if(f.keyCode==13)this.view.focus();else if(f.keyCode>=65&&f.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:m}=this.items[this.selectedIndex],k=zo(m.actions);for(let T=0;T<k.length;T++)if(k[T].toUpperCase().charCodeAt(0)==f.keyCode){let B=Ar(this.view.state.field(Ai).diagnostics,m);B&&m.actions[T].apply(i,B.from,B.to)}}else return;f.preventDefault()},h=f=>{for(let m=0;m<this.items.length;m++)this.items[m].dom.contains(f.target)&&this.moveSelection(m)};this.list=hi("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:l,onclick:h}),this.dom=hi("div",{class:"cm-panel-lint"},this.list,hi("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>go(this.view)},"\xD7")),this.update()}get selectedIndex(){let i=this.view.state.field(Ai).selected;if(!i)return-1;for(let l=0;l<this.items.length;l++)if(this.items[l].diagnostic==i.diagnostic)return l;return-1}update(){let{diagnostics:i,selected:l}=this.view.state.field(Ai),h=0,f=!1,m=null;for(i.between(0,this.view.state.doc.length,(k,T,{spec:B})=>{let J=-1,Y;for(let ge=h;ge<this.items.length;ge++)if(this.items[ge].diagnostic==B.diagnostic){J=ge;break}J<0?(Y=new Gs(this.view,B.diagnostic),this.items.splice(h,0,Y),f=!0):(Y=this.items[J],J>h&&(this.items.splice(h,J-h),f=!0)),l&&Y.diagnostic==l.diagnostic?Y.dom.hasAttribute("aria-selected")||(Y.dom.setAttribute("aria-selected","true"),m=Y):Y.dom.hasAttribute("aria-selected")&&Y.dom.removeAttribute("aria-selected"),h++});h<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)f=!0,this.items.pop();this.items.length==0&&(this.items.push(new Gs(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),f=!0),m?(this.list.setAttribute("aria-activedescendant",m.id),this.view.requestMeasure({key:this,read:()=>({sel:m.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:k,panel:T})=>{let B=T.height/this.list.offsetHeight;k.top<T.top?this.list.scrollTop-=(T.top-k.top)/B:k.bottom>T.bottom&&(this.list.scrollTop+=(k.bottom-T.bottom)/B)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),f&&this.sync()}sync(){let i=this.list.firstChild;function l(){let h=i;i=h.nextSibling,h.remove()}for(let h of this.items)if(h.dom.parentNode==this.list){for(;i!=h.dom;)l();i=h.dom.nextSibling}else this.list.insertBefore(h.dom,i);for(;i;)l()}moveSelection(i){if(this.selectedIndex<0)return;let l=this.view.state.field(Ai),h=Ar(l.diagnostics,this.items[i].diagnostic);h&&this.view.dispatch({selection:{anchor:h.from,head:h.to},scrollIntoView:!0,effects:Js.of(h)})}static open(i){return new Xs(i)}}function Ys(o,i='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${i}>${encodeURIComponent(o)}</svg>')`}function As(o){return Ys(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${o}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const ul=G.tk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:As("#d11")},".cm-lintRange-warning":{backgroundImage:As("orange")},".cm-lintRange-info":{backgroundImage:As("#999")},".cm-lintRange-hint":{backgroundImage:As("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function $o(o){return o=="error"?4:o=="warning"?3:o=="info"?2:1}class dl extends G.SJ{constructor(i){super(),this.diagnostics=i,this.severity=i.reduce((l,h)=>$o(l)<$o(h.severity)?h.severity:l,"hint")}toDOM(i){let l=document.createElement("div");l.className="cm-lint-marker cm-lint-marker-"+this.severity;let h=this.diagnostics,f=i.state.facet(e).tooltipFilter;return f&&(h=f(h)),h.length&&(l.onmouseover=()=>pl(i,l,h)),l}}function jo(o,i){let l=h=>{let f=i.getBoundingClientRect();if(!(h.clientX>f.left-10&&h.clientX<f.right+10&&h.clientY>f.top-10&&h.clientY<f.bottom+10)){for(let m=h.target;m;m=m.parentNode)if(m.nodeType==1&&m.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",l),o.state.field(yl)&&o.dispatch({effects:bo.of(null)})}};window.addEventListener("mousemove",l)}function pl(o,i,l){function h(){let k=o.elementAtHeight(i.getBoundingClientRect().top+5-o.documentTop);o.coordsAtPos(k.from)&&o.dispatch({effects:bo.of({pos:k.from,above:!1,create(){return{dom:Ho(o,l),getCoords:()=>i.getBoundingClientRect()}}})}),i.onmouseout=i.onmousemove=null,jo(o,i)}let{hoverTime:f}=o.state.facet(e),m=setTimeout(h,f);i.onmouseout=()=>{clearTimeout(m),i.onmouseout=i.onmousemove=null},i.onmousemove=()=>{clearTimeout(m),m=setTimeout(h,f)}}function Zo(o,i){let l=Object.create(null);for(let f of i){let m=o.lineAt(f.from);(l[m.from]||(l[m.from]=[])).push(f)}let h=[];for(let f in l)h.push(new dl(l[f]).range(+f));return L.Xs.of(h,!0)}const ml=(0,G.v5)({class:"cm-gutter-lint",markers:o=>o.state.field(gl)}),gl=L.QQ.define({create(){return L.Xs.empty},update(o,i){o=o.map(i.changes);let l=i.state.facet(e).markerFilter;for(let h of i.effects)if(h.is($r)){let f=h.value;l&&(f=l(f||[])),o=Zo(i.state.doc,f.slice(0))}return o}}),bo=L.Py.define(),yl=L.QQ.define({create(){return null},update(o,i){return o&&i.docChanged&&(o=ol(i,o)?null:Object.assign(Object.assign({},o),{pos:i.changes.mapPos(o.pos)})),i.effects.reduce((l,h)=>h.is(bo)?h.value:l,o)},provide:o=>G.hJ.from(o)}),Ol=G.tk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Ys('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Ys('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Ys('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),s=[Ai,G.tk.decorations.compute([Ai],o=>{let{selected:i,panel:l}=o.field(Ai);return!i||!l||i.from==i.to?G.p.none:G.p.set([al.range(i.from,i.to)])}),(0,G.bF)(Cs,{hideOn:ol}),ul],e=L.r$.define({combine(o){return(0,L.BO)(o,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function t(o={}){return[e.of(o),gl,ml,Ol,yl]}function n(o,i){let l=o.field(Ai,!1);if(l&&l.diagnostics.size)for(let h=RangeSet.iter([l.diagnostics]);h.value;h.next())i(h.value.spec.diagnostic,h.from,h.to)}var r=function(i){i===void 0&&(i={});var{crosshairCursor:l=!1}=i,h=[];i.closeBracketsKeymap!==!1&&(h=h.concat(Bo)),i.defaultKeymap!==!1&&(h=h.concat(as)),i.searchKeymap!==!1&&(h=h.concat(qr)),i.historyKeymap!==!1&&(h=h.concat(w)),i.foldKeymap!==!1&&(h=h.concat(Ce.e7)),i.completionKeymap!==!1&&(h=h.concat(No)),i.lintKeymap!==!1&&(h=h.concat(yo));var f=[];return i.lineNumbers!==!1&&f.push((0,G.Eu)()),i.highlightActiveLineGutter!==!1&&f.push((0,G.HQ)()),i.highlightSpecialChars!==!1&&f.push((0,G.AE)()),i.history!==!1&&f.push(ct()),i.foldGutter!==!1&&f.push((0,Ce.mi)()),i.drawSelection!==!1&&f.push((0,G.Uw)()),i.dropCursor!==!1&&f.push((0,G.qr)()),i.allowMultipleSelections!==!1&&f.push(L.yy.allowMultipleSelections.of(!0)),i.indentOnInput!==!1&&f.push((0,Ce.nY)()),i.syntaxHighlighting!==!1&&f.push((0,Ce.nF)(Ce.R_,{fallback:!0})),i.bracketMatching!==!1&&f.push((0,Ce.n$)()),i.closeBrackets!==!1&&f.push(Oo()),i.autocompletion!==!1&&f.push(sl()),i.rectangularSelection!==!1&&f.push((0,G.Zs)()),l!==!1&&f.push((0,G.S2)()),i.highlightActiveLine!==!1&&f.push((0,G.ZO)()),i.highlightSelectionMatches!==!1&&f.push(Is()),i.tabSize&&typeof i.tabSize=="number"&&f.push(Ce.c.of(" ".repeat(i.tabSize))),f.concat([G.$f.of(h.flat())]).filter(Boolean)},c=function(i){i===void 0&&(i={});var l=[];i.defaultKeymap!==!1&&(l=l.concat(defaultKeymap)),i.historyKeymap!==!1&&(l=l.concat(historyKeymap));var h=[];return i.highlightSpecialChars!==!1&&h.push(highlightSpecialChars()),i.history!==!1&&h.push(history()),i.drawSelection!==!1&&h.push(drawSelection()),i.syntaxHighlighting!==!1&&h.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),h.concat([keymap.of(l.flat())]).filter(Boolean)},u=q(86253);const y="#e5c07b",b="#e06c75",M="#56b6c2",A="#ffffff",F="#abb2bf",$="#7d8799",X="#61afef",_="#98c379",le="#d19a66",re="#c678dd",pe="#21252b",Ze="#2c313a",ft="#282c34",Ke="#353a42",ht="#3E4451",St="#528bff",Hi={chalky:y,coral:b,cyan:M,invalid:A,ivory:F,stone:$,malibu:X,sage:_,whiskey:le,violet:re,darkBackground:pe,highlightBackground:Ze,background:ft,tooltipBackground:Ke,selection:ht,cursor:St},en=G.tk.theme({"&":{color:F,backgroundColor:ft},".cm-content":{caretColor:St},".cm-cursor, .cm-dropCursor":{borderLeftColor:St},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:ht},".cm-panels":{backgroundColor:pe,color:F},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:ft,color:$,border:"none"},".cm-activeLineGutter":{backgroundColor:Ze},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Ke},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ke,borderBottomColor:Ke},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Ze,color:F}}},{dark:!0}),Tr=Ce.Qf.define([{tag:u.pJ.keyword,color:re},{tag:[u.pJ.name,u.pJ.deleted,u.pJ.character,u.pJ.propertyName,u.pJ.macroName],color:b},{tag:[u.pJ.function(u.pJ.variableName),u.pJ.labelName],color:X},{tag:[u.pJ.color,u.pJ.constant(u.pJ.name),u.pJ.standard(u.pJ.name)],color:le},{tag:[u.pJ.definition(u.pJ.name),u.pJ.separator],color:F},{tag:[u.pJ.typeName,u.pJ.className,u.pJ.number,u.pJ.changed,u.pJ.annotation,u.pJ.modifier,u.pJ.self,u.pJ.namespace],color:y},{tag:[u.pJ.operator,u.pJ.operatorKeyword,u.pJ.url,u.pJ.escape,u.pJ.regexp,u.pJ.link,u.pJ.special(u.pJ.string)],color:M},{tag:[u.pJ.meta,u.pJ.comment],color:$},{tag:u.pJ.strong,fontWeight:"bold"},{tag:u.pJ.emphasis,fontStyle:"italic"},{tag:u.pJ.strikethrough,textDecoration:"line-through"},{tag:u.pJ.link,color:$,textDecoration:"underline"},{tag:u.pJ.heading,fontWeight:"bold",color:b},{tag:[u.pJ.atom,u.pJ.bool,u.pJ.special(u.pJ.variableName)],color:le},{tag:[u.pJ.processingInstruction,u.pJ.string,u.pJ.inserted],color:_},{tag:u.pJ.invalid,color:A}]),qs=[en,(0,Ce.nF)(Tr)];var Ko=G.tk.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),Qs=function(i){i===void 0&&(i={});var{indentWithTab:l=!0,editable:h=!0,readOnly:f=!1,theme:m="light",placeholder:k="",basicSetup:T=!0}=i,B=[];switch(l&&B.unshift(G.$f.of([Es])),T&&(typeof T=="boolean"?B.unshift(r()):B.unshift(r(T))),k&&B.unshift((0,G.W$)(k)),m){case"light":B.push(Ko);break;case"dark":B.push(qs);break;case"none":break;default:B.push(m);break}return h===!1&&B.push(G.tk.editable.of(!1)),f&&B.push(L.yy.readOnly.of(!0)),[...B]},_s=o=>({line:o.state.doc.lineAt(o.state.selection.main.from),lineCount:o.state.doc.lines,lineBreak:o.state.lineBreak,length:o.state.doc.length,readOnly:o.state.readOnly,tabSize:o.state.tabSize,selection:o.state.selection,selectionAsSingle:o.state.selection.asSingle().main,ranges:o.state.selection.ranges,selectionCode:o.state.sliceDoc(o.state.selection.main.from,o.state.selection.main.to),selections:o.state.selection.ranges.map(i=>o.state.sliceDoc(i.from,i.to)),selectedText:o.state.selection.ranges.some(i=>!i.empty)}),Mr=L.q6.define(),Er=[];function ss(o){var{value:i,selection:l,onChange:h,onStatistics:f,onCreateEditor:m,onUpdate:k,extensions:T=Er,autoFocus:B,theme:J="light",height:Y=null,minHeight:ge=null,maxHeight:Be=null,width:ut=null,minWidth:ti=null,maxWidth:Gi=null,placeholder:Yn="",editable:Dr=!0,readOnly:Ei=!1,indentWithTab:fr=!0,basicSetup:In=!0,root:ln,initialState:Or}=o,[Pr,Jo]=(0,de.useState)(),[an,Kr]=(0,de.useState)(),[eo,to]=(0,de.useState)(),vl=G.tk.theme({"&":{height:Y,minHeight:ge,maxHeight:Be,width:ut,minWidth:ti,maxWidth:Gi},"& .cm-scroller":{height:"100% !important"}}),bl=G.tk.updateListener.of(ur=>{if(ur.docChanged&&typeof h=="function"&&!ur.transactions.some(Bl=>Bl.annotation(Mr))){var wo=ur.state.doc,Uo=wo.toString();h(Uo,ur)}f&&f(_s(ur))}),Rl=Qs({theme:J,editable:Dr,readOnly:Ei,placeholder:Yn,indentWithTab:fr,basicSetup:In}),xo=[bl,vl,...Rl];return k&&typeof k=="function"&&xo.push(G.tk.updateListener.of(k)),xo=xo.concat(T),(0,de.useEffect)(()=>{if(Pr&&!eo){var ur={doc:i,selection:l,extensions:xo},wo=Or?L.yy.fromJSON(Or.json,ur,Or.fields):L.yy.create(ur);if(to(wo),!an){var Uo=new G.tk({state:wo,parent:Pr,root:ln});Kr(Uo),m&&m(Uo,wo)}}return()=>{an&&(to(void 0),Kr(void 0))}},[Pr,eo]),(0,de.useEffect)(()=>Jo(o.container),[o.container]),(0,de.useEffect)(()=>()=>{an&&(an.destroy(),Kr(void 0))},[an]),(0,de.useEffect)(()=>{B&&an&&an.focus()},[B,an]),(0,de.useEffect)(()=>{an&&an.dispatch({effects:L.Py.reconfigure.of(xo)})},[J,T,Y,ge,Be,ut,ti,Gi,Yn,Dr,Ei,fr,In,h,k]),(0,de.useEffect)(()=>{if(i!==void 0){var ur=an?an.state.doc.toString():"";an&&i!==ur&&an.dispatch({changes:{from:0,to:ur.length,insert:i||""},annotations:[Mr.of(!0)]})}},[i,an]),{state:eo,setState:to,view:an,setView:Kr,container:Pr,setContainer:Jo}}var Zr=q(52322),Ts=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],Xn=(0,de.forwardRef)((o,i)=>{var{className:l,value:h="",selection:f,extensions:m=[],onChange:k,onStatistics:T,onCreateEditor:B,onUpdate:J,autoFocus:Y,theme:ge="light",height:Be,minHeight:ut,maxHeight:ti,width:Gi,minWidth:Yn,maxWidth:Dr,basicSetup:Ei,placeholder:fr,indentWithTab:In,editable:ln,readOnly:Or,root:Pr,initialState:Jo}=o,an=(0,Se.Z)(o,Ts),Kr=(0,de.useRef)(null),{state:eo,view:to,container:vl}=ss({container:Kr.current,root:Pr,value:h,autoFocus:Y,theme:ge,height:Be,minHeight:ut,maxHeight:ti,width:Gi,minWidth:Yn,maxWidth:Dr,basicSetup:Ei,placeholder:fr,indentWithTab:In,editable:ln,readOnly:Or,selection:f,onChange:k,onStatistics:T,onCreateEditor:B,onUpdate:J,extensions:m,initialState:Jo});if((0,de.useImperativeHandle)(i,()=>({editor:Kr.current,state:eo,view:to}),[Kr,vl,eo,to]),typeof h!="string")throw new Error("value must be typeof string but got "+typeof h);var bl=typeof ge=="string"?"cm-theme-"+ge:"cm-theme";return(0,Zr.jsx)("div",(0,p.Z)({ref:Kr,className:""+bl+(l?" "+l:"")},an))});Xn.displayName="CodeMirror";const cr=Xn},77120:(kn,Wt,q)=>{q.d(Wt,{Gn:()=>oe,K0:()=>ki,Qf:()=>vi,R_:()=>nn,SS:()=>Ge,Um:()=>x,c:()=>ri,e7:()=>We,il:()=>Le,mi:()=>Vi,n$:()=>R,nF:()=>Ni,nY:()=>ie,qz:()=>_e,y1:()=>Si});var p=q(21649),Se=q(1727),de=q(65329),L=q(86253),G=q(37207),Ce;const Ie=new p.md;function vt(O){return Se.r$.define({combine:O?g=>g.concat(O):void 0})}const dt=new p.md;class bt{constructor(g,S,P=[],W=""){this.data=g,this.name=W,Se.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(Se.yy.prototype,"tree",{get(){return _e(this)}}),this.parser=S,this.extension=[Ot.of(this),Se.yy.languageData.of((K,U,ce)=>{let ae=$e(K,U,ce),Ee=ae.type.prop(Ie);if(!Ee)return[];let Ve=K.facet(Ee),jt=ae.type.prop(dt);if(jt){let Ki=ae.resolve(U-ae.from,ce);for(let Oi of jt)if(Oi.test(Ki,K)){let gn=K.facet(Oi.facet);return Oi.type=="replace"?gn:gn.concat(Ve)}}return Ve})].concat(P)}isActiveAt(g,S,P=-1){return $e(g,S,P).type.prop(Ie)==this.data}findRegions(g){let S=g.facet(Ot);if((S==null?void 0:S.data)==this.data)return[{from:0,to:g.doc.length}];if(!S||!S.allowsNesting)return[];let P=[],W=(K,U)=>{if(K.prop(Ie)==this.data){P.push({from:U,to:U+K.length});return}let ce=K.prop(p.md.mounted);if(ce){if(ce.tree.prop(Ie)==this.data){if(ce.overlay)for(let ae of ce.overlay)P.push({from:ae.from+U,to:ae.to+U});else P.push({from:U,to:U+K.length});return}else if(ce.overlay){let ae=P.length;if(W(ce.tree,ce.overlay[0].from+U),P.length>ae)return}}for(let ae=0;ae<K.children.length;ae++){let Ee=K.children[ae];Ee instanceof p.mp&&W(Ee,K.positions[ae]+U)}};return W(_e(g),0),P}get allowsNesting(){return!0}}bt.setState=Se.Py.define();function $e(O,g,S){let P=O.facet(Ot),W=_e(O).topNode;if(!P||P.allowsNesting)for(let K=W;K;K=K.enter(g,S,p.vj.ExcludeBuffers))K.type.isTop&&(W=K);return W}class nt extends null{constructor(g,S,P){super(g,S,[],P),this.parser=S}static define(g){let S=vt(g.languageData);return new nt(S,g.parser.configure({props:[Ie.add(P=>P.isTop?S:void 0)]}),g.name)}configure(g,S){return new nt(this.data,this.parser.configure(g),S||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function _e(O){let g=O.field(bt.state,!1);return g?g.tree:p.mp.empty}function mt(O,g,S=50){var P;let W=(P=O.field(bt.state,!1))===null||P===void 0?void 0:P.context;if(!W)return null;let K=W.viewport;W.updateViewport({from:0,to:g});let U=W.isDone(g)||W.work(S,g)?W.tree:null;return W.updateViewport(K),U}function yi(O,g=O.doc.length){var S;return((S=O.field(bt.state,!1))===null||S===void 0?void 0:S.context.isDone(g))||!1}function Xt(O,g=O.viewport.to,S=100){let P=mt(O.state,g,S);return P!=_e(O.state)&&O.dispatch({}),!!P}function me(O){var g;return((g=O.plugin(Jt))===null||g===void 0?void 0:g.isWorking())||!1}class pt{constructor(g){this.doc=g,this.cursorPos=0,this.string="",this.cursor=g.iter()}get length(){return this.doc.length}syncTo(g){return this.string=this.cursor.next(g-this.cursorPos).value,this.cursorPos=g+this.string.length,this.cursorPos-this.string.length}chunk(g){return this.syncTo(g),this.string}get lineChunks(){return!0}read(g,S){let P=this.cursorPos-this.string.length;return g<P||S>=this.cursorPos?this.doc.sliceString(g,S):this.string.slice(g-P,S-P)}}let Kt=null;class wi{constructor(g,S,P=[],W,K,U,ce,ae){this.parser=g,this.state=S,this.fragments=P,this.tree=W,this.treeLen=K,this.viewport=U,this.skipped=ce,this.scheduleOn=ae,this.parse=null,this.tempSkipped=[]}static create(g,S,P){return new wi(g,S,[],p.mp.empty,0,P,[],null)}startParse(){return this.parser.startParse(new pt(this.state.doc),this.fragments)}work(g,S){return S!=null&&S>=this.state.doc.length&&(S=void 0),this.tree!=p.mp.empty&&this.isDone(S!=null?S:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var P;if(typeof g=="number"){let W=Date.now()+g;g=()=>Date.now()>W}for(this.parse||(this.parse=this.startParse()),S!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>S)&&S<this.state.doc.length&&this.parse.stopAt(S);;){let W=this.parse.advance();if(W)if(this.fragments=this.withoutTempSkipped(p.i9.addTree(W,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(P=this.parse.stoppedAt)!==null&&P!==void 0?P:this.state.doc.length,this.tree=W,this.parse=null,this.treeLen<(S!=null?S:this.state.doc.length))this.parse=this.startParse();else return!0;if(g())return!1}})}takeTree(){let g,S;this.parse&&(g=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>g)&&this.parse.stopAt(g),this.withContext(()=>{for(;!(S=this.parse.advance()););}),this.treeLen=g,this.tree=S,this.fragments=this.withoutTempSkipped(p.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(g){let S=Kt;Kt=this;try{return g()}finally{Kt=S}}withoutTempSkipped(g){for(let S;S=this.tempSkipped.pop();)g=ui(g,S.from,S.to);return g}changes(g,S){let{fragments:P,tree:W,treeLen:K,viewport:U,skipped:ce}=this;if(this.takeTree(),!g.empty){let ae=[];if(g.iterChangedRanges((Ee,Ve,jt,Ki)=>ae.push({fromA:Ee,toA:Ve,fromB:jt,toB:Ki})),P=p.i9.applyChanges(P,ae),W=p.mp.empty,K=0,U={from:g.mapPos(U.from,-1),to:g.mapPos(U.to,1)},this.skipped.length){ce=[];for(let Ee of this.skipped){let Ve=g.mapPos(Ee.from,1),jt=g.mapPos(Ee.to,-1);Ve<jt&&ce.push({from:Ve,to:jt})}}}return new wi(this.parser,S,P,W,K,U,ce,this.scheduleOn)}updateViewport(g){if(this.viewport.from==g.from&&this.viewport.to==g.to)return!1;this.viewport=g;let S=this.skipped.length;for(let P=0;P<this.skipped.length;P++){let{from:W,to:K}=this.skipped[P];W<g.to&&K>g.from&&(this.fragments=ui(this.fragments,W,K),this.skipped.splice(P--,1))}return this.skipped.length>=S?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(g,S){this.skipped.push({from:g,to:S})}static getSkippingParser(g){return new class extends p._b{createParse(S,P,W){let K=W[0].from,U=W[W.length-1].to;return{parsedPos:K,advance(){let ae=Kt;if(ae){for(let Ee of W)ae.tempSkipped.push(Ee);g&&(ae.scheduleOn=ae.scheduleOn?Promise.all([ae.scheduleOn,g]):g)}return this.parsedPos=U,new p.mp(p.Jq.none,[],[],U-K)},stoppedAt:null,stopAt(){}}}}}isDone(g){g=Math.min(g,this.state.doc.length);let S=this.fragments;return this.treeLen>=g&&S.length&&S[0].from==0&&S[0].to>=g}static get(){return Kt}}function ui(O,g,S){return p.i9.applyChanges(O,[{fromA:g,toA:S,fromB:g,toB:S}])}class Et{constructor(g){this.context=g,this.tree=g.tree}apply(g){if(!g.docChanged&&this.tree==this.context.tree)return this;let S=this.context.changes(g.changes,g.state),P=this.context.treeLen==g.startState.doc.length?void 0:Math.max(g.changes.mapPos(this.context.treeLen),S.viewport.to);return S.work(20,P)||S.takeTree(),new Et(S)}static init(g){let S=Math.min(3e3,g.doc.length),P=wi.create(g.facet(Ot).parser,g,{from:0,to:S});return P.work(20,S)||P.takeTree(),new Et(P)}}bt.state=Se.QQ.define({create:Et.init,update(O,g){for(let S of g.effects)if(S.is(bt.setState))return S.value;return g.startState.facet(Ot)!=g.state.facet(Ot)?Et.init(g.state):O.apply(g)}});let ii=O=>{let g=setTimeout(()=>O(),500);return()=>clearTimeout(g)};typeof requestIdleCallback!="undefined"&&(ii=O=>{let g=-1,S=setTimeout(()=>{g=requestIdleCallback(O,{timeout:500-100})},100);return()=>g<0?clearTimeout(S):cancelIdleCallback(g)});const Di=typeof navigator!="undefined"&&(!((Ce=navigator.scheduling)===null||Ce===void 0)&&Ce.isInputPending)?()=>navigator.scheduling.isInputPending():null,Jt=de.lg.fromClass(class{constructor(g){this.view=g,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(g){let S=this.view.state.field(bt.state).context;(S.updateViewport(g.view.viewport)||this.view.viewport.to>S.treeLen)&&this.scheduleWork(),(g.docChanged||g.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(S)}scheduleWork(){if(this.working)return;let{state:g}=this.view,S=g.field(bt.state);(S.tree!=S.context.tree||!S.context.isDone(g.doc.length))&&(this.working=ii(this.work))}work(g){this.working=null;let S=Date.now();if(this.chunkEnd<S&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=S+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:P,viewport:{to:W}}=this.view,K=P.field(bt.state);if(K.tree==K.context.tree&&K.context.isDone(W+1e5))return;let U=Date.now()+Math.min(this.chunkBudget,100,g&&!Di?Math.max(25,g.timeRemaining()-5):1e9),ce=K.context.treeLen<W&&P.doc.length>W+1e3,ae=K.context.work(()=>Di&&Di()||Date.now()>U,W+(ce?0:1e5));this.chunkBudget-=Date.now()-S,(ae||this.chunkBudget<=0)&&(K.context.takeTree(),this.view.dispatch({effects:bt.setState.of(new Et(K.context))})),this.chunkBudget>0&&!(ae&&!ce)&&this.scheduleWork(),this.checkAsyncSchedule(K.context)}checkAsyncSchedule(g){g.scheduleOn&&(this.workScheduled++,g.scheduleOn.then(()=>this.scheduleWork()).catch(S=>(0,de.OO)(this.view.state,S)).then(()=>this.workScheduled--),g.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ot=Se.r$.define({combine(O){return O.length?O[0]:null},enables:O=>[bt.state,Jt,de.tk.contentAttributes.compute([O],g=>{let S=g.facet(O);return S&&S.name?{"data-language":S.name}:{}})]});class Tt{constructor(g,S=[]){this.language=g,this.support=S,this.extension=[g,S]}}class ct{constructor(g,S,P,W,K,U=void 0){this.name=g,this.alias=S,this.extensions=P,this.filename=W,this.loadFunc=K,this.support=U,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(g=>this.support=g,g=>{throw this.loading=null,g}))}static of(g){let{load:S,support:P}=g;if(!S){if(!P)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");S=()=>Promise.resolve(P)}return new ct(g.name,(g.alias||[]).concat(g.name).map(W=>W.toLowerCase()),g.extensions||[],g.filename,S,P)}static matchFilename(g,S){for(let W of g)if(W.filename&&W.filename.test(S))return W;let P=/\.([^.]+)$/.exec(S);if(P){for(let W of g)if(W.extensions.indexOf(P[1])>-1)return W}return null}static matchLanguageName(g,S,P=!0){S=S.toLowerCase();for(let W of g)if(W.alias.some(K=>K==S))return W;if(P)for(let W of g)for(let K of W.alias){let U=S.indexOf(K);if(U>-1&&(K.length>2||!/\w/.test(S[U-1])&&!/\w/.test(S[U+K.length])))return W}return null}}const Yt=Se.r$.define(),ri=Se.r$.define({combine:O=>{if(!O.length)return"  ";let g=O[0];if(!g||/\S/.test(g)||Array.from(g).some(S=>S!=g[0]))throw new Error("Invalid indent unit: "+JSON.stringify(O[0]));return g}});function Si(O){let g=O.facet(ri);return g.charCodeAt(0)==9?O.tabSize*g.length:g.length}function Ge(O,g){let S="",P=O.tabSize,W=O.facet(ri)[0];if(W=="	"){for(;g>=P;)S+="	",g-=P;W=" "}for(let K=0;K<g;K++)S+=W;return S}function ki(O,g){O instanceof Se.yy&&(O=new oe(O));for(let P of O.state.facet(Yt)){let W=P(O,g);if(W!==void 0)return W}let S=_e(O.state);return S.length>=g?ke(O,S,g):null}function Xe(O,g,S){let P=Object.create(null),W=new oe(O,{overrideIndentation:U=>{var ce;return(ce=P[U])!==null&&ce!==void 0?ce:-1}}),K=[];for(let U=g;U<=S;){let ce=O.doc.lineAt(U);U=ce.to+1;let ae=ki(W,ce.from);if(ae==null)continue;/\S/.test(ce.text)||(ae=0);let Ee=/^\s*/.exec(ce.text)[0],Ve=Ge(O,ae);Ee!=Ve&&(P[ce.from]=ae,K.push({from:ce.from,to:ce.from+Ee.length,insert:Ve}))}return O.changes(K)}class oe{constructor(g,S={}){this.state=g,this.options=S,this.unit=Si(g)}lineAt(g,S=1){let P=this.state.doc.lineAt(g),{simulateBreak:W,simulateDoubleBreak:K}=this.options;return W!=null&&W>=P.from&&W<=P.to?K&&W==g?{text:"",from:g}:(S<0?W<g:W<=g)?{text:P.text.slice(W-P.from),from:W}:{text:P.text.slice(0,W-P.from),from:P.from}:P}textAfterPos(g,S=1){if(this.options.simulateDoubleBreak&&g==this.options.simulateBreak)return"";let{text:P,from:W}=this.lineAt(g,S);return P.slice(g-W,Math.min(P.length,g+100-W))}column(g,S=1){let{text:P,from:W}=this.lineAt(g,S),K=this.countColumn(P,g-W),U=this.options.overrideIndentation?this.options.overrideIndentation(W):-1;return U>-1&&(K+=U-this.countColumn(P,P.search(/\S|$/))),K}countColumn(g,S=g.length){return(0,Se.IS)(g,this.state.tabSize,S)}lineIndent(g,S=1){let{text:P,from:W}=this.lineAt(g,S),K=this.options.overrideIndentation;if(K){let U=K(W);if(U>-1)return U}return this.countColumn(P,P.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const ye=new p.md;function ke(O,g,S){let P=g.resolveStack(S),W=P.node.enterUnfinishedNodesBefore(S);if(W!=P.node){let K=[];for(let U=W;U!=P.node;U=U.parent)K.push(U);for(let U=K.length-1;U>=0;U--)P={node:K[U],next:P}}return Me(P,O,S)}function Me(O,g,S){for(let P=O;P;P=P.next){let W=Dt(P.node);if(W)return W(Qt.create(g,S,P))}return 0}function Fe(O){return O.pos==O.options.simulateBreak&&O.options.simulateDoubleBreak}function Dt(O){let g=O.type.prop(ye);if(g)return g;let S=O.firstChild,P;if(S&&(P=S.type.prop(p.md.closedBy))){let W=O.lastChild,K=W&&P.indexOf(W.name)>-1;return U=>kt(U,!0,1,void 0,K&&!Fe(U)?W.from:void 0)}return O.parent==null?lt:null}function lt(){return 0}class Qt extends oe{constructor(g,S,P){super(g.state,g.options),this.base=g,this.pos=S,this.context=P}get node(){return this.context.node}static create(g,S,P){return new Qt(g,S,P)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(g){let S=this.state.doc.lineAt(g.from);for(;;){let P=g.resolve(S.from);for(;P.parent&&P.parent.from==P.from;)P=P.parent;if(et(P,g))break;S=this.state.doc.lineAt(P.from)}return this.lineIndent(S.from)}continue(){return Me(this.context.next,this.base,this.pos)}}function et(O,g){for(let S=g;S;S=S.parent)if(O==S)return!0;return!1}function Li(O){let g=O.node,S=g.childAfter(g.from),P=g.lastChild;if(!S)return null;let W=O.options.simulateBreak,K=O.state.doc.lineAt(S.from),U=W==null||W<=K.from?K.to:Math.min(K.to,W);for(let ce=S.to;;){let ae=g.childAfter(ce);if(!ae||ae==P)return null;if(!ae.type.isSkipped)return ae.from<U?S:null;ce=ae.to}}function Rt({closing:O,align:g=!0,units:S=1}){return P=>kt(P,g,S,O)}function kt(O,g,S,P,W){let K=O.textAfter,U=K.match(/^\s*/)[0].length,ce=P&&K.slice(U,U+P.length)==P||W==O.pos+U,ae=g?Li(O):null;return ae?ce?O.column(ae.from):O.column(ae.to):O.baseIndent+(ce?0:O.unit*S)}const _t=O=>O.baseIndent;function Xi({except:O,units:g=1}={}){return S=>{let P=O&&O.test(S.textAfter);return S.baseIndent+(P?0:g*S.unit)}}const hn=200;function ie(){return Se.yy.transactionFilter.of(O=>{if(!O.docChanged||!O.isUserEvent("input.type")&&!O.isUserEvent("input.complete"))return O;let g=O.startState.languageDataAt("indentOnInput",O.startState.selection.main.head);if(!g.length)return O;let S=O.newDoc,{head:P}=O.newSelection.main,W=S.lineAt(P);if(P>W.from+hn)return O;let K=S.sliceString(W.from,P);if(!g.some(Ee=>Ee.test(K)))return O;let{state:U}=O,ce=-1,ae=[];for(let{head:Ee}of U.selection.ranges){let Ve=U.doc.lineAt(Ee);if(Ve.from==ce)continue;ce=Ve.from;let jt=ki(U,Ve.from);if(jt==null)continue;let Ki=/^\s*/.exec(Ve.text)[0],Oi=Ge(U,jt);Ki!=Oi&&ae.push({from:Ve.from,to:Ve.from+Ki.length,insert:Oi})}return ae.length?[O,{changes:ae,sequential:!0}]:O})}const w=Se.r$.define(),C=new p.md;function N(O){let g=O.firstChild,S=O.lastChild;return g&&g.to<S.from?{from:g.to,to:S.type.isError?O.to:S.from}:null}function I(O,g,S){let P=_e(O);if(P.length<S)return null;let W=P.resolveStack(S,1),K=null;for(let U=W;U;U=U.next){let ce=U.node;if(ce.to<=S||ce.from>S)continue;if(K&&ce.from<g)break;let ae=ce.type.prop(C);if(ae&&(ce.to<P.length-50||P.length==O.doc.length||!Z(ce))){let Ee=ae(ce,O);Ee&&Ee.from<=S&&Ee.from>=g&&Ee.to>S&&(K=Ee)}}return K}function Z(O){let g=O.lastChild;return g&&g.to==O.to&&g.type.isError}function ee(O,g,S){for(let P of O.facet(w)){let W=P(O,g,S);if(W)return W}return I(O,g,S)}function se(O,g){let S=g.mapPos(O.from,1),P=g.mapPos(O.to,-1);return S>=P?void 0:{from:S,to:P}}const xe=Se.Py.define({map:se}),He=Se.Py.define({map:se});function Oe(O){let g=[];for(let{head:S}of O.state.selection.ranges)g.some(P=>P.from<=S&&P.to>=S)||g.push(O.lineBlockAt(S));return g}const Je=Se.QQ.define({create(){return de.p.none},update(O,g){O=O.map(g.changes);for(let S of g.effects)if(S.is(xe)&&!ei(O,S.value.from,S.value.to)){let{preparePlaceholder:P}=g.state.facet(st),W=P?de.p.replace({widget:new Lt(P(g.state,S.value))}):at;O=O.update({add:[W.range(S.value.from,S.value.to)]})}else S.is(He)&&(O=O.update({filter:(P,W)=>S.value.from!=P||S.value.to!=W,filterFrom:S.value.from,filterTo:S.value.to}));if(g.selection){let S=!1,{head:P}=g.selection.main;O.between(P,P,(W,K)=>{W<P&&K>P&&(S=!0)}),S&&(O=O.update({filterFrom:P,filterTo:P,filter:(W,K)=>K<=P||W>=P}))}return O},provide:O=>de.tk.decorations.from(O),toJSON(O,g){let S=[];return O.between(0,g.doc.length,(P,W)=>{S.push(P,W)}),S},fromJSON(O){if(!Array.isArray(O)||O.length%2)throw new RangeError("Invalid JSON for fold state");let g=[];for(let S=0;S<O.length;){let P=O[S++],W=O[S++];if(typeof P!="number"||typeof W!="number")throw new RangeError("Invalid JSON for fold state");g.push(at.range(P,W))}return de.p.set(g,!0)}});function tt(O){return O.field(Je,!1)||RangeSet.empty}function rt(O,g,S){var P;let W=null;return(P=O.field(Je,!1))===null||P===void 0||P.between(g,S,(K,U)=>{(!W||W.from>K)&&(W={from:K,to:U})}),W}function ei(O,g,S){let P=!1;return O.between(g,g,(W,K)=>{W==g&&K==S&&(P=!0)}),P}function ci(O,g){return O.field(Je,!1)?g:g.concat(Se.Py.appendConfig.of(ot()))}const Vt=O=>{for(let g of Oe(O)){let S=ee(O.state,g.from,g.to);if(S)return O.dispatch({effects:ci(O.state,[xe.of(S),Ct(O,S)])}),!0}return!1},zt=O=>{if(!O.state.field(Je,!1))return!1;let g=[];for(let S of Oe(O)){let P=rt(O.state,S.from,S.to);P&&g.push(He.of(P),Ct(O,P,!1))}return g.length&&O.dispatch({effects:g}),g.length>0};function Ct(O,g,S=!0){let P=O.state.doc.lineAt(g.from).number,W=O.state.doc.lineAt(g.to).number;return de.tk.announce.of(`${O.state.phrase(S?"Folded lines":"Unfolded lines")} ${P} ${O.state.phrase("to")} ${W}.`)}const Bt=O=>{let{state:g}=O,S=[];for(let P=0;P<g.doc.length;){let W=O.lineBlockAt(P),K=ee(g,W.from,W.to);K&&S.push(xe.of(K)),P=(K?O.lineBlockAt(K.to):W).to+1}return S.length&&O.dispatch({effects:ci(O.state,S)}),!!S.length},Ci=O=>{let g=O.state.field(Je,!1);if(!g||!g.size)return!1;let S=[];return g.between(0,O.state.doc.length,(P,W)=>{S.push(He.of({from:P,to:W}))}),O.dispatch({effects:S}),!0};function it(O,g){for(let S=g;;){let P=ee(O.state,S.from,S.to);if(P&&P.to>g.from)return P;if(!S.from)return null;S=O.lineBlockAt(S.from-1)}}const Ye=O=>{let g=[];for(let S of Oe(O)){let P=rt(O.state,S.from,S.to);if(P)g.push(He.of(P),Ct(O,P,!1));else{let W=it(O,S);W&&g.push(xe.of(W),Ct(O,W))}}return g.length>0&&O.dispatch({effects:ci(O.state,g)}),!!g.length},We=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:Vt},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:zt},{key:"Ctrl-Alt-[",run:Bt},{key:"Ctrl-Alt-]",run:Ci}],Ut={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},st=Se.r$.define({combine(O){return(0,Se.BO)(O,Ut)}});function ot(O){let g=[Je,fi];return O&&g.push(st.of(O)),g}function gt(O,g){let{state:S}=O,P=S.facet(st),W=U=>{let ce=O.lineBlockAt(O.posAtDOM(U.target)),ae=rt(O.state,ce.from,ce.to);ae&&O.dispatch({effects:He.of(ae)}),U.preventDefault()};if(P.placeholderDOM)return P.placeholderDOM(O,W,g);let K=document.createElement("span");return K.textContent=P.placeholderText,K.setAttribute("aria-label",S.phrase("folded code")),K.title=S.phrase("unfold"),K.className="cm-foldPlaceholder",K.onclick=W,K}const at=de.p.replace({widget:new class extends de.l9{toDOM(O){return gt(O,null)}}});class Lt extends de.l9{constructor(g){super(),this.value=g}eq(g){return this.value==g.value}toDOM(g){return gt(g,this.value)}}const $t={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class qe extends de.SJ{constructor(g,S){super(),this.config=g,this.open=S}eq(g){return this.config==g.config&&this.open==g.open}toDOM(g){if(this.config.markerDOM)return this.config.markerDOM(this.open);let S=document.createElement("span");return S.textContent=this.open?this.config.openText:this.config.closedText,S.title=g.state.phrase(this.open?"Fold line":"Unfold line"),S}}function Vi(O={}){let g=Object.assign(Object.assign({},$t),O),S=new qe(g,!0),P=new qe(g,!1),W=de.lg.fromClass(class{constructor(U){this.from=U.viewport.from,this.markers=this.buildMarkers(U)}update(U){(U.docChanged||U.viewportChanged||U.startState.facet(Ot)!=U.state.facet(Ot)||U.startState.field(Je,!1)!=U.state.field(Je,!1)||_e(U.startState)!=_e(U.state)||g.foldingChanged(U))&&(this.markers=this.buildMarkers(U.view))}buildMarkers(U){let ce=new Se.f_;for(let ae of U.viewportLineBlocks){let Ee=rt(U.state,ae.from,ae.to)?P:ee(U.state,ae.from,ae.to)?S:null;Ee&&ce.add(ae.from,ae.from,Ee)}return ce.finish()}}),{domEventHandlers:K}=g;return[W,(0,de.v5)({class:"cm-foldGutter",markers(U){var ce;return((ce=U.plugin(W))===null||ce===void 0?void 0:ce.markers)||Se.Xs.empty},initialSpacer(){return new qe(g,!1)},domEventHandlers:Object.assign(Object.assign({},K),{click:(U,ce,ae)=>{if(K.click&&K.click(U,ce,ae))return!0;let Ee=rt(U.state,ce.from,ce.to);if(Ee)return U.dispatch({effects:He.of(Ee)}),!0;let Ve=ee(U.state,ce.from,ce.to);return Ve?(U.dispatch({effects:xe.of(Ve)}),!0):!1}})}),ot()]}const fi=de.tk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class vi{constructor(g,S){this.specs=g;let P;function W(ce){let ae=G.V.newName();return(P||(P=Object.create(null)))["."+ae]=ce,ae}const K=typeof S.all=="string"?S.all:S.all?W(S.all):void 0,U=S.scope;this.scope=U instanceof bt?ce=>ce.prop(Ie)==U.data:U?ce=>ce==U:void 0,this.style=(0,L.QR)(g.map(ce=>({tag:ce.tag,class:ce.class||W(Object.assign({},ce,{tag:null}))})),{all:K}).style,this.module=P?new G.V(P):null,this.themeType=S.themeType}static define(g,S){return new vi(g,S||{})}}const tn=Se.r$.define(),Ti=Se.r$.define({combine(O){return O.length?[O[0]]:null}});function Ht(O){let g=O.facet(tn);return g.length?g:O.facet(Ti)}function Ni(O,g){let S=[$i],P;return O instanceof vi&&(O.module&&S.push(de.tk.styleModule.of(O.module)),P=O.themeType),g!=null&&g.fallback?S.push(Ti.of(O)):P?S.push(tn.computeN([de.tk.darkTheme],W=>W.facet(de.tk.darkTheme)==(P=="dark")?[O]:[])):S.push(tn.of(O)),S}function zi(O,g,S){let P=Ht(O),W=null;if(P){for(let K of P)if(!K.scope||S&&K.scope(S)){let U=K.style(g);U&&(W=W?W+" "+U:U)}}return W}class Yi{constructor(g){this.markCache=Object.create(null),this.tree=_e(g.state),this.decorations=this.buildDeco(g,Ht(g.state))}update(g){let S=_e(g.state),P=Ht(g.state),W=P!=Ht(g.startState);S.length<g.view.viewport.to&&!W&&S.type==this.tree.type?this.decorations=this.decorations.map(g.changes):(S!=this.tree||g.viewportChanged||W)&&(this.tree=S,this.decorations=this.buildDeco(g.view,P))}buildDeco(g,S){if(!S||!this.tree.length)return de.p.none;let P=new Se.f_;for(let{from:W,to:K}of g.visibleRanges)(0,L.bW)(this.tree,S,(U,ce,ae)=>{P.add(U,ce,this.markCache[ae]||(this.markCache[ae]=de.p.mark({class:ae})))},W,K);return P.finish()}}const $i=Se.Wl.high(de.lg.fromClass(Yi,{decorations:O=>O.decorations})),nn=vi.define([{tag:L.pJ.meta,color:"#404740"},{tag:L.pJ.link,textDecoration:"underline"},{tag:L.pJ.heading,textDecoration:"underline",fontWeight:"bold"},{tag:L.pJ.emphasis,fontStyle:"italic"},{tag:L.pJ.strong,fontWeight:"bold"},{tag:L.pJ.strikethrough,textDecoration:"line-through"},{tag:L.pJ.keyword,color:"#708"},{tag:[L.pJ.atom,L.pJ.bool,L.pJ.url,L.pJ.contentSeparator,L.pJ.labelName],color:"#219"},{tag:[L.pJ.literal,L.pJ.inserted],color:"#164"},{tag:[L.pJ.string,L.pJ.deleted],color:"#a11"},{tag:[L.pJ.regexp,L.pJ.escape,L.pJ.special(L.pJ.string)],color:"#e40"},{tag:L.pJ.definition(L.pJ.variableName),color:"#00f"},{tag:L.pJ.local(L.pJ.variableName),color:"#30a"},{tag:[L.pJ.typeName,L.pJ.namespace],color:"#085"},{tag:L.pJ.className,color:"#167"},{tag:[L.pJ.special(L.pJ.variableName),L.pJ.macroName],color:"#256"},{tag:L.pJ.definition(L.pJ.propertyName),color:"#00c"},{tag:L.pJ.comment,color:"#940"},{tag:L.pJ.invalid,color:"#f00"}]),si=de.tk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Zi=1e4,$n="()[]{}",cn=Se.r$.define({combine(O){return(0,Se.BO)(O,{afterCursor:!0,brackets:$n,maxScanDistance:Zi,renderMatch:On})}}),di=de.p.mark({class:"cm-matchingBracket"}),Nn=de.p.mark({class:"cm-nonmatchingBracket"});function On(O){let g=[],S=O.matched?di:Nn;return g.push(S.range(O.start.from,O.start.to)),O.end&&g.push(S.range(O.end.from,O.end.to)),g}const Fn=[Se.QQ.define({create(){return de.p.none},update(O,g){if(!g.docChanged&&!g.selection)return O;let S=[],P=g.state.facet(cn);for(let W of g.state.selection.ranges){if(!W.empty)continue;let K=x(g.state,W.head,-1,P)||W.head>0&&x(g.state,W.head-1,1,P)||P.afterCursor&&(x(g.state,W.head,1,P)||W.head<g.state.doc.length&&x(g.state,W.head+1,-1,P));K&&(S=S.concat(P.renderMatch(K,g.state)))}return de.p.set(S,!0)},provide:O=>de.tk.decorations.from(O)}),si];function R(O={}){return[cn.of(O),Fn]}const a=new p.md;function d(O,g,S){let P=O.prop(g<0?p.md.openedBy:p.md.closedBy);if(P)return P;if(O.name.length==1){let W=S.indexOf(O.name);if(W>-1&&W%2==(g<0?1:0))return[S[W+g]]}return null}function v(O){let g=O.type.prop(a);return g?g(O.node):O}function x(O,g,S,P={}){let W=P.maxScanDistance||Zi,K=P.brackets||$n,U=_e(O),ce=U.resolveInner(g,S);for(let ae=ce;ae;ae=ae.parent){let Ee=d(ae.type,S,K);if(Ee&&ae.from<ae.to){let Ve=v(ae);if(Ve&&(S>0?g>=Ve.from&&g<Ve.to:g>Ve.from&&g<=Ve.to))return E(O,g,S,ae,Ve,Ee,K)}}return D(O,g,S,U,ce.type,W,K)}function E(O,g,S,P,W,K,U){let ce=P.parent,ae={from:W.from,to:W.to},Ee=0,Ve=ce==null?void 0:ce.cursor();if(Ve&&(S<0?Ve.childBefore(P.from):Ve.childAfter(P.to)))do if(S<0?Ve.to<=P.from:Ve.from>=P.to){if(Ee==0&&K.indexOf(Ve.type.name)>-1&&Ve.from<Ve.to){let jt=v(Ve);return{start:ae,end:jt?{from:jt.from,to:jt.to}:void 0,matched:!0}}else if(d(Ve.type,S,U))Ee++;else if(d(Ve.type,-S,U)){if(Ee==0){let jt=v(Ve);return{start:ae,end:jt&&jt.from<jt.to?{from:jt.from,to:jt.to}:void 0,matched:!1}}Ee--}}while(S<0?Ve.prevSibling():Ve.nextSibling());return{start:ae,matched:!1}}function D(O,g,S,P,W,K,U){let ce=S<0?O.sliceDoc(g-1,g):O.sliceDoc(g,g+1),ae=U.indexOf(ce);if(ae<0||ae%2==0!=S>0)return null;let Ee={from:S<0?g-1:g,to:S>0?g+1:g},Ve=O.doc.iterRange(g,S>0?O.doc.length:0),jt=0;for(let Ki=0;!Ve.next().done&&Ki<=K;){let Oi=Ve.value;S<0&&(Ki+=Oi.length);let gn=g+Ki*S;for(let Cn=S>0?0:Oi.length-1,It=S>0?Oi.length:-1;Cn!=It;Cn+=S){let qi=U.indexOf(Oi[Cn]);if(!(qi<0||P.resolveInner(gn+Cn,1).type!=W))if(qi%2==0==S>0)jt++;else{if(jt==1)return{start:Ee,end:{from:gn+Cn,to:gn+Cn+1},matched:qi>>1==ae>>1};jt--}}S>0&&(Ki+=Oi.length)}return Ve.done?{start:Ee,matched:!1}:null}function V(O,g,S,P=0,W=0){g==null&&(g=O.search(/[^\s\u00a0]/),g==-1&&(g=O.length));let K=W;for(let U=P;U<g;U++)O.charCodeAt(U)==9?K+=S-K%S:K++;return K}class j{constructor(g,S,P,W){this.string=g,this.tabSize=S,this.indentUnit=P,this.overrideIndent=W,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(g){let S=this.string.charAt(this.pos),P;if(typeof g=="string"?P=S==g:P=S&&(g instanceof RegExp?g.test(S):g(S)),P)return++this.pos,S}eatWhile(g){let S=this.pos;for(;this.eat(g););return this.pos>S}eatSpace(){let g=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>g}skipToEnd(){this.pos=this.string.length}skipTo(g){let S=this.string.indexOf(g,this.pos);if(S>-1)return this.pos=S,!0}backUp(g){this.pos-=g}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=V(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var g;return(g=this.overrideIndent)!==null&&g!==void 0?g:V(this.string,null,this.tabSize)}match(g,S,P){if(typeof g=="string"){let W=U=>P?U.toLowerCase():U,K=this.string.substr(this.pos,g.length);return W(K)==W(g)?(S!==!1&&(this.pos+=g.length),!0):null}else{let W=this.string.slice(this.pos).match(g);return W&&W.index>0?null:(W&&S!==!1&&(this.pos+=W[0].length),W)}}current(){return this.string.slice(this.start,this.pos)}}function ne(O){return{name:O.name||"",token:O.token,blankLine:O.blankLine||(()=>{}),startState:O.startState||(()=>!0),copyState:O.copyState||fe,indent:O.indent||(()=>null),languageData:O.languageData||{},tokenTable:O.tokenTable||mn}}function fe(O){if(typeof O!="object")return O;let g={};for(let S in O){let P=O[S];g[S]=P instanceof Array?P.slice():P}return g}const ve=new WeakMap;class Le extends bt{constructor(g){let S=vt(g.languageData),P=ne(g),W,K=new class extends p._b{createParse(U,ce,ae){return new bi(W,U,ce,ae)}};super(S,K,[Yt.of((U,ce)=>this.getIndent(U,ce))],g.name),this.topNode=Qn(S),W=this,this.streamParser=P,this.stateAfter=new p.md({perNode:!0}),this.tokenTable=g.tokenTable?new dr(P.tokenTable):Lr}static define(g){return new Le(g)}getIndent(g,S){let P=_e(g.state),W=P.resolve(S);for(;W&&W.type!=this.topNode;)W=W.parent;if(!W)return null;let K,{overrideIndentation:U}=g.options;U&&(K=ve.get(g.state),K!=null&&K<S-1e4&&(K=void 0));let ce=Pe(this,P,0,W.from,K!=null?K:S),ae,Ee;if(ce?(Ee=ce.state,ae=ce.pos+1):(Ee=this.streamParser.startState(g.unit),ae=0),S-ae>1e4)return null;for(;ae<S;){let jt=g.state.doc.lineAt(ae),Ki=Math.min(S,jt.to);if(jt.length){let Oi=U?U(jt.from):-1,gn=new j(jt.text,g.state.tabSize,g.unit,Oi<0?void 0:Oi);for(;gn.pos<Ki-jt.from;)jn(this.streamParser.token,gn,Ee)}else this.streamParser.blankLine(Ee,g.unit);if(Ki==S)break;ae=jt.to+1}let Ve=g.lineAt(S);return U&&K==null&&ve.set(g.state,Ve.from),this.streamParser.indent(Ee,/^\s*(.*)/.exec(Ve.text)[1],g)}get allowsNesting(){return!1}}function Pe(O,g,S,P,W){let K=S>=P&&S+g.length<=W&&g.prop(O.stateAfter);if(K)return{state:O.streamParser.copyState(K),pos:S+g.length};for(let U=g.children.length-1;U>=0;U--){let ce=g.children[U],ae=S+g.positions[U],Ee=ce instanceof p.mp&&ae<W&&Pe(O,ce,ae,P,W);if(Ee)return Ee}return null}function Gt(O,g,S,P,W){if(W&&S<=0&&P>=g.length)return g;!W&&g.type==O.topNode&&(W=!0);for(let K=g.children.length-1;K>=0;K--){let U=g.positions[K],ce=g.children[K],ae;if(U<P&&ce instanceof p.mp){if(!(ae=Gt(O,ce,S-U,P-U,W)))break;return W?new p.mp(g.type,g.children.slice(0,K).concat(ae),g.positions.slice(0,K+1),U+ae.length):ae}}return null}function pi(O,g,S,P){for(let W of g){let K=W.from+(W.openStart?25:0),U=W.to-(W.openEnd?25:0),ce=K<=S&&U>S&&Pe(O,W.tree,0-W.offset,S,U),ae;if(ce&&(ae=Gt(O,W.tree,S+W.offset,ce.pos+W.offset,!1)))return{state:ce.state,tree:ae}}return{state:O.streamParser.startState(P?Si(P):4),tree:p.mp.empty}}class bi{constructor(g,S,P,W){this.lang=g,this.input=S,this.fragments=P,this.ranges=W,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=W[W.length-1].to;let K=wi.get(),U=W[0].from,{state:ce,tree:ae}=pi(g,P,U,K==null?void 0:K.state);this.state=ce,this.parsedPos=this.chunkStart=U+ae.length;for(let Ee=0;Ee<ae.children.length;Ee++)this.chunks.push(ae.children[Ee]),this.chunkPos.push(ae.positions[Ee]);K&&this.parsedPos<K.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(Si(K.state)),K.skipUntilInView(this.parsedPos,K.viewport.from),this.parsedPos=K.viewport.from),this.moveRangeIndex()}advance(){let g=wi.get(),S=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),P=Math.min(S,this.chunkStart+2048);for(g&&(P=Math.min(P,g.viewport.to));this.parsedPos<P;)this.parseLine(g);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=S?this.finish():g&&this.parsedPos>=g.viewport.to?(g.skipUntilInView(this.parsedPos,S),this.finish()):null}stopAt(g){this.stoppedAt=g}lineAfter(g){let S=this.input.chunk(g);if(this.input.lineChunks)S==`
`&&(S="");else{let P=S.indexOf(`
`);P>-1&&(S=S.slice(0,P))}return g+S.length<=this.to?S:S.slice(0,this.to-g)}nextLine(){let g=this.parsedPos,S=this.lineAfter(g),P=g+S.length;for(let W=this.rangeIndex;;){let K=this.ranges[W].to;if(K>=P||(S=S.slice(0,K-(P-S.length)),W++,W==this.ranges.length))break;let U=this.ranges[W].from,ce=this.lineAfter(U);S+=ce,P=U+ce.length}return{line:S,end:P}}skipGapsTo(g,S,P){for(;;){let W=this.ranges[this.rangeIndex].to,K=g+S;if(P>0?W>K:W>=K)break;let U=this.ranges[++this.rangeIndex].from;S+=U-W}return S}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(g,S,P,W,K){if(this.ranges.length>1){K=this.skipGapsTo(S,K,1),S+=K;let U=this.chunk.length;K=this.skipGapsTo(P,K,-1),P+=K,W+=this.chunk.length-U}return this.chunk.push(g,S,P,W),K}parseLine(g){let{line:S,end:P}=this.nextLine(),W=0,{streamParser:K}=this.lang,U=new j(S,g?g.state.tabSize:4,g?Si(g.state):2);if(U.eol())K.blankLine(this.state,U.indentUnit);else for(;!U.eol();){let ce=jn(K.token,U,this.state);if(ce&&(W=this.emitToken(this.lang.tokenTable.resolve(ce),this.parsedPos+U.start,this.parsedPos+U.pos,4,W)),U.start>1e4)break}this.parsedPos=P,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let g=p.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:qt,topID:0,maxBufferLength:2048,reused:this.chunkReused});g=new p.mp(g.type,g.children,g.positions,g.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(g),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new p.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function jn(O,g,S){g.start=g.pos;for(let P=0;P<10;P++){let W=O(g,S);if(g.pos>g.start)return W}throw new Error("Stream parser failed to advance stream.")}const mn=Object.create(null),Pn=[p.Jq.none],qt=new p.Lj(Pn),Rr=[],Br=Object.create(null),Jr=Object.create(null);for(let[O,g]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])Jr[O]=Rn(mn,g);class dr{constructor(g){this.extra=g,this.table=Object.assign(Object.create(null),Jr)}resolve(g){return g?this.table[g]||(this.table[g]=Rn(this.extra,g)):0}}const Lr=new dr(mn);function pr(O,g){Rr.indexOf(O)>-1||(Rr.push(O),console.warn(g))}function Rn(O,g){let S=[];for(let ce of g.split(" ")){let ae=[];for(let Ee of ce.split(".")){let Ve=O[Ee]||L.pJ[Ee];Ve?typeof Ve=="function"?ae.length?ae=ae.map(Ve):pr(Ee,`Modifier ${Ee} used at start of tag`):ae.length?pr(Ee,`Tag ${Ee} used as modifier`):ae=Array.isArray(Ve)?Ve:[Ve]:pr(Ee,`Unknown highlighting tag ${Ee}`)}for(let Ee of ae)S.push(Ee)}if(!S.length)return 0;let P=g.replace(/ /g,"_"),W=P+" "+S.map(ce=>ce.id),K=Br[W];if(K)return K.id;let U=Br[W]=p.Jq.define({id:Pn.length,name:P,props:[(0,L.Gv)({[P]:S})]});return Pn.push(U),U.id}function Qn(O){let g=p.Jq.define({id:Pn.length,name:"Document",props:[Ie.add(()=>O)],top:!0});return Pn.push(g),g}},42123:(kn,Wt,q)=>{q.d(Wt,{r:()=>de});var p=["true","false","on","off","yes","no"],Se=new RegExp("\\b(("+p.join(")|(")+"))$","i");const de={name:"yaml",token:function(L,G){var Ce=L.peek(),Ie=G.escaped;if(G.escaped=!1,Ce=="#"&&(L.pos==0||/\s/.test(L.string.charAt(L.pos-1))))return L.skipToEnd(),"comment";if(L.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(G.literal&&L.indentation()>G.keyCol)return L.skipToEnd(),"string";if(G.literal&&(G.literal=!1),L.sol()){if(G.keyCol=0,G.pair=!1,G.pairStart=!1,L.match("---")||L.match("..."))return"def";if(L.match(/^\s*-\s+/))return"meta"}if(L.match(/^(\{|\}|\[|\])/))return Ce=="{"?G.inlinePairs++:Ce=="}"?G.inlinePairs--:Ce=="["?G.inlineList++:G.inlineList--,"meta";if(G.inlineList>0&&!Ie&&Ce==",")return L.next(),"meta";if(G.inlinePairs>0&&!Ie&&Ce==",")return G.keyCol=0,G.pair=!1,G.pairStart=!1,L.next(),"meta";if(G.pairStart){if(L.match(/^\s*(\||\>)\s*/))return G.literal=!0,"meta";if(L.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(G.inlinePairs==0&&L.match(/^\s*-?[0-9\.\,]+\s?$/)||G.inlinePairs>0&&L.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(L.match(Se))return"keyword"}return!G.pair&&L.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(G.pair=!0,G.keyCol=L.indentation(),"atom"):G.pair&&L.match(/^:\s*/)?(G.pairStart=!0,"meta"):(G.pairStart=!1,G.escaped=Ce=="\\",L.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},1727:(kn,Wt,q)=>{q.d(Wt,{BO:()=>Vi,D0:()=>ot,Gz:()=>Fn,IS:()=>qn,Py:()=>Vt,QQ:()=>Rt,Wl:()=>Xi,Xs:()=>Ht,YW:()=>zt,as:()=>Tt,bg:()=>Et,cp:()=>Xt,f_:()=>zi,gc:()=>Jt,gm:()=>ui,jT:()=>oe,n0:()=>Ot,nZ:()=>ii,q6:()=>rt,r$:()=>Me,uU:()=>fi,xv:()=>p,yy:()=>qe});class p{lineAt(a){if(a<0||a>this.length)throw new RangeError(`Invalid position ${a} in document of length ${this.length}`);return this.lineInner(a,!1,1,0)}line(a){if(a<1||a>this.lines)throw new RangeError(`Invalid line number ${a} in ${this.lines}-line document`);return this.lineInner(a,!0,1,0)}replace(a,d,v){[a,d]=$e(this,a,d);let x=[];return this.decompose(0,a,x,2),v.length&&v.decompose(0,v.length,x,3),this.decompose(d,this.length,x,1),de.from(x,this.length-(d-a)+v.length)}append(a){return this.replace(this.length,this.length,a)}slice(a,d=this.length){[a,d]=$e(this,a,d);let v=[];return this.decompose(a,d,v,0),de.from(v,d-a)}eq(a){if(a==this)return!0;if(a.length!=this.length||a.lines!=this.lines)return!1;let d=this.scanIdentical(a,1),v=this.length-this.scanIdentical(a,-1),x=new Ie(this),E=new Ie(a);for(let D=d,V=d;;){if(x.next(D),E.next(D),D=0,x.lineBreak!=E.lineBreak||x.done!=E.done||x.value!=E.value)return!1;if(V+=x.value.length,x.done||V>=v)return!0}}iter(a=1){return new Ie(this,a)}iterRange(a,d=this.length){return new vt(this,a,d)}iterLines(a,d){let v;if(a==null)v=this.iter();else{d==null&&(d=this.lines+1);let x=this.line(a).from;v=this.iterRange(x,Math.max(x,d==this.lines+1?this.length:d<=1?0:this.line(d-1).to))}return new dt(v)}toString(){return this.sliceString(0)}toJSON(){let a=[];return this.flatten(a),a}constructor(){}static of(a){if(a.length==0)throw new RangeError("A document must have at least one line");return a.length==1&&!a[0]?p.empty:a.length<=32?new Se(a):de.from(Se.split(a,[]))}}class Se extends p{constructor(a,d=L(a)){super(),this.text=a,this.length=d}get lines(){return this.text.length}get children(){return null}lineInner(a,d,v,x){for(let E=0;;E++){let D=this.text[E],V=x+D.length;if((d?v:V)>=a)return new bt(x,V,v,D);x=V+1,v++}}decompose(a,d,v,x){let E=a<=0&&d>=this.length?this:new Se(Ce(this.text,a,d),Math.min(d,this.length)-Math.max(0,a));if(x&1){let D=v.pop(),V=G(E.text,D.text.slice(),0,E.length);if(V.length<=32)v.push(new Se(V,D.length+E.length));else{let j=V.length>>1;v.push(new Se(V.slice(0,j)),new Se(V.slice(j)))}}else v.push(E)}replace(a,d,v){if(!(v instanceof Se))return super.replace(a,d,v);[a,d]=$e(this,a,d);let x=G(this.text,G(v.text,Ce(this.text,0,a)),d),E=this.length+v.length-(d-a);return x.length<=32?new Se(x,E):de.from(Se.split(x,[]),E)}sliceString(a,d=this.length,v=`
`){[a,d]=$e(this,a,d);let x="";for(let E=0,D=0;E<=d&&D<this.text.length;D++){let V=this.text[D],j=E+V.length;E>a&&D&&(x+=v),a<j&&d>E&&(x+=V.slice(Math.max(0,a-E),d-E)),E=j+1}return x}flatten(a){for(let d of this.text)a.push(d)}scanIdentical(){return 0}static split(a,d){let v=[],x=-1;for(let E of a)v.push(E),x+=E.length+1,v.length==32&&(d.push(new Se(v,x)),v=[],x=-1);return x>-1&&d.push(new Se(v,x)),d}}class de extends p{constructor(a,d){super(),this.children=a,this.length=d,this.lines=0;for(let v of a)this.lines+=v.lines}lineInner(a,d,v,x){for(let E=0;;E++){let D=this.children[E],V=x+D.length,j=v+D.lines-1;if((d?j:V)>=a)return D.lineInner(a,d,v,x);x=V+1,v=j+1}}decompose(a,d,v,x){for(let E=0,D=0;D<=d&&E<this.children.length;E++){let V=this.children[E],j=D+V.length;if(a<=j&&d>=D){let ne=x&((D<=a?1:0)|(j>=d?2:0));D>=a&&j<=d&&!ne?v.push(V):V.decompose(a-D,d-D,v,ne)}D=j+1}}replace(a,d,v){if([a,d]=$e(this,a,d),v.lines<this.lines)for(let x=0,E=0;x<this.children.length;x++){let D=this.children[x],V=E+D.length;if(a>=E&&d<=V){let j=D.replace(a-E,d-E,v),ne=this.lines-D.lines+j.lines;if(j.lines<ne>>5-1&&j.lines>ne>>5+1){let fe=this.children.slice();return fe[x]=j,new de(fe,this.length-(d-a)+v.length)}return super.replace(E,V,j)}E=V+1}return super.replace(a,d,v)}sliceString(a,d=this.length,v=`
`){[a,d]=$e(this,a,d);let x="";for(let E=0,D=0;E<this.children.length&&D<=d;E++){let V=this.children[E],j=D+V.length;D>a&&E&&(x+=v),a<j&&d>D&&(x+=V.sliceString(a-D,d-D,v)),D=j+1}return x}flatten(a){for(let d of this.children)d.flatten(a)}scanIdentical(a,d){if(!(a instanceof de))return 0;let v=0,[x,E,D,V]=d>0?[0,0,this.children.length,a.children.length]:[this.children.length-1,a.children.length-1,-1,-1];for(;;x+=d,E+=d){if(x==D||E==V)return v;let j=this.children[x],ne=a.children[E];if(j!=ne)return v+j.scanIdentical(ne,d);v+=j.length+1}}static from(a,d=a.reduce((v,x)=>v+x.length+1,-1)){let v=0;for(let Pe of a)v+=Pe.lines;if(v<32){let Pe=[];for(let Gt of a)Gt.flatten(Pe);return new Se(Pe,d)}let x=Math.max(32,v>>5),E=x<<1,D=x>>1,V=[],j=0,ne=-1,fe=[];function ve(Pe){let Gt;if(Pe.lines>E&&Pe instanceof de)for(let pi of Pe.children)ve(pi);else Pe.lines>D&&(j>D||!j)?(Le(),V.push(Pe)):Pe instanceof Se&&j&&(Gt=fe[fe.length-1])instanceof Se&&Pe.lines+Gt.lines<=32?(j+=Pe.lines,ne+=Pe.length+1,fe[fe.length-1]=new Se(Gt.text.concat(Pe.text),Gt.length+1+Pe.length)):(j+Pe.lines>x&&Le(),j+=Pe.lines,ne+=Pe.length+1,fe.push(Pe))}function Le(){j!=0&&(V.push(fe.length==1?fe[0]:de.from(fe,ne)),ne=-1,j=fe.length=0)}for(let Pe of a)ve(Pe);return Le(),V.length==1?V[0]:new de(V,d)}}p.empty=new Se([""],0);function L(R){let a=-1;for(let d of R)a+=d.length+1;return a}function G(R,a,d=0,v=1e9){for(let x=0,E=0,D=!0;E<R.length&&x<=v;E++){let V=R[E],j=x+V.length;j>=d&&(j>v&&(V=V.slice(0,v-x)),x<d&&(V=V.slice(d-x)),D?(a[a.length-1]+=V,D=!1):a.push(V)),x=j+1}return a}function Ce(R,a,d){return G(R,[""],a,d)}class Ie{constructor(a,d=1){this.dir=d,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[a],this.offsets=[d>0?1:(a instanceof Se?a.text.length:a.children.length)<<1]}nextInner(a,d){for(this.done=this.lineBreak=!1;;){let v=this.nodes.length-1,x=this.nodes[v],E=this.offsets[v],D=E>>1,V=x instanceof Se?x.text.length:x.children.length;if(D==(d>0?V:0)){if(v==0)return this.done=!0,this.value="",this;d>0&&this.offsets[v-1]++,this.nodes.pop(),this.offsets.pop()}else if((E&1)==(d>0?0:1)){if(this.offsets[v]+=d,a==0)return this.lineBreak=!0,this.value=`
`,this;a--}else if(x instanceof Se){let j=x.text[D+(d<0?-1:0)];if(this.offsets[v]+=d,j.length>Math.max(0,a))return this.value=a==0?j:d>0?j.slice(a):j.slice(0,j.length-a),this;a-=j.length}else{let j=x.children[D+(d<0?-1:0)];a>j.length?(a-=j.length,this.offsets[v]+=d):(d<0&&this.offsets[v]--,this.nodes.push(j),this.offsets.push(d>0?1:(j instanceof Se?j.text.length:j.children.length)<<1))}}}next(a=0){return a<0&&(this.nextInner(-a,-this.dir),a=this.value.length),this.nextInner(a,this.dir)}}class vt{constructor(a,d,v){this.value="",this.done=!1,this.cursor=new Ie(a,d>v?-1:1),this.pos=d>v?a.length:0,this.from=Math.min(d,v),this.to=Math.max(d,v)}nextInner(a,d){if(d<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;a+=Math.max(0,d<0?this.pos-this.to:this.from-this.pos);let v=d<0?this.pos-this.from:this.to-this.pos;a>v&&(a=v),v-=a;let{value:x}=this.cursor.next(a);return this.pos+=(x.length+a)*d,this.value=x.length<=v?x:d<0?x.slice(x.length-v):x.slice(0,v),this.done=!this.value,this}next(a=0){return a<0?a=Math.max(a,this.from-this.pos):a>0&&(a=Math.min(a,this.to-this.pos)),this.nextInner(a,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class dt{constructor(a){this.inner=a,this.afterBreak=!0,this.value="",this.done=!1}next(a=0){let{done:d,lineBreak:v,value:x}=this.inner.next(a);return d&&this.afterBreak?(this.value="",this.afterBreak=!1):d?(this.done=!0,this.value=""):v?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=x,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(p.prototype[Symbol.iterator]=function(){return this.iter()},Ie.prototype[Symbol.iterator]=vt.prototype[Symbol.iterator]=dt.prototype[Symbol.iterator]=function(){return this});class bt{constructor(a,d,v,x){this.from=a,this.to=d,this.number=v,this.text=x}get length(){return this.to-this.from}}function $e(R,a,d){return a=Math.max(0,Math.min(R.length,a)),[a,Math.max(a,Math.min(R.length,d))]}let nt="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(R=>R?parseInt(R,36):1);for(let R=1;R<nt.length;R++)nt[R]+=nt[R-1];function _e(R){for(let a=1;a<nt.length;a+=2)if(nt[a]>R)return nt[a-1]<=R;return!1}function mt(R){return R>=127462&&R<=127487}const yi=8205;function Xt(R,a,d=!0,v=!0){return(d?me:pt)(R,a,v)}function me(R,a,d){if(a==R.length)return a;a&&Kt(R.charCodeAt(a))&&wi(R.charCodeAt(a-1))&&a--;let v=ui(R,a);for(a+=ii(v);a<R.length;){let x=ui(R,a);if(v==yi||x==yi||d&&_e(x))a+=ii(x),v=x;else if(mt(x)){let E=0,D=a-2;for(;D>=0&&mt(ui(R,D));)E++,D-=2;if(E%2==0)break;a+=2}else break}return a}function pt(R,a,d){for(;a>0;){let v=me(R,a-2,d);if(v<a)return v;a--}return 0}function Kt(R){return R>=56320&&R<57344}function wi(R){return R>=55296&&R<56320}function ui(R,a){let d=R.charCodeAt(a);if(!wi(d)||a+1==R.length)return d;let v=R.charCodeAt(a+1);return Kt(v)?(d-55296<<10)+(v-56320)+65536:d}function Et(R){return R<=65535?String.fromCharCode(R):(R-=65536,String.fromCharCode((R>>10)+55296,(R&1023)+56320))}function ii(R){return R<65536?1:2}const Di=/\r\n?|\n/;var Jt=function(R){return R[R.Simple=0]="Simple",R[R.TrackDel=1]="TrackDel",R[R.TrackBefore=2]="TrackBefore",R[R.TrackAfter=3]="TrackAfter",R}(Jt||(Jt={}));class Ot{constructor(a){this.sections=a}get length(){let a=0;for(let d=0;d<this.sections.length;d+=2)a+=this.sections[d];return a}get newLength(){let a=0;for(let d=0;d<this.sections.length;d+=2){let v=this.sections[d+1];a+=v<0?this.sections[d]:v}return a}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(a){for(let d=0,v=0,x=0;d<this.sections.length;){let E=this.sections[d++],D=this.sections[d++];D<0?(a(v,x,E),x+=E):x+=D,v+=E}}iterChangedRanges(a,d=!1){ri(this,a,d)}get invertedDesc(){let a=[];for(let d=0;d<this.sections.length;){let v=this.sections[d++],x=this.sections[d++];x<0?a.push(v,x):a.push(x,v)}return new Ot(a)}composeDesc(a){return this.empty?a:a.empty?this:Ge(this,a)}mapDesc(a,d=!1){return a.empty?this:Si(this,a,d)}mapPos(a,d=-1,v=Jt.Simple){let x=0,E=0;for(let D=0;D<this.sections.length;){let V=this.sections[D++],j=this.sections[D++],ne=x+V;if(j<0){if(ne>a)return E+(a-x);E+=V}else{if(v!=Jt.Simple&&ne>=a&&(v==Jt.TrackDel&&x<a&&ne>a||v==Jt.TrackBefore&&x<a||v==Jt.TrackAfter&&ne>a))return null;if(ne>a||ne==a&&d<0&&!V)return a==x||d<0?E:E+j;E+=j}x=ne}if(a>x)throw new RangeError(`Position ${a} is out of range for changeset of length ${x}`);return E}touchesRange(a,d=a){for(let v=0,x=0;v<this.sections.length&&x<=d;){let E=this.sections[v++],D=this.sections[v++],V=x+E;if(D>=0&&x<=d&&V>=a)return x<a&&V>d?"cover":!0;x=V}return!1}toString(){let a="";for(let d=0;d<this.sections.length;){let v=this.sections[d++],x=this.sections[d++];a+=(a?" ":"")+v+(x>=0?":"+x:"")}return a}toJSON(){return this.sections}static fromJSON(a){if(!Array.isArray(a)||a.length%2||a.some(d=>typeof d!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ot(a)}static create(a){return new Ot(a)}}class Tt extends Ot{constructor(a,d){super(a),this.inserted=d}apply(a){if(this.length!=a.length)throw new RangeError("Applying change set to a document with the wrong length");return ri(this,(d,v,x,E,D)=>a=a.replace(x,x+(v-d),D),!1),a}mapDesc(a,d=!1){return Si(this,a,d,!0)}invert(a){let d=this.sections.slice(),v=[];for(let x=0,E=0;x<d.length;x+=2){let D=d[x],V=d[x+1];if(V>=0){d[x]=V,d[x+1]=D;let j=x>>1;for(;v.length<j;)v.push(p.empty);v.push(D?a.slice(E,E+D):p.empty)}E+=D}return new Tt(d,v)}compose(a){return this.empty?a:a.empty?this:Ge(this,a,!0)}map(a,d=!1){return a.empty?this:Si(this,a,d,!0)}iterChanges(a,d=!1){ri(this,a,d)}get desc(){return Ot.create(this.sections)}filter(a){let d=[],v=[],x=[],E=new ki(this);e:for(let D=0,V=0;;){let j=D==a.length?1e9:a[D++];for(;V<j||V==j&&E.len==0;){if(E.done)break e;let fe=Math.min(E.len,j-V);ct(x,fe,-1);let ve=E.ins==-1?-1:E.off==0?E.ins:0;ct(d,fe,ve),ve>0&&Yt(v,d,E.text),E.forward(fe),V+=fe}let ne=a[D++];for(;V<ne;){if(E.done)break e;let fe=Math.min(E.len,ne-V);ct(d,fe,-1),ct(x,fe,E.ins==-1?-1:E.off==0?E.ins:0),E.forward(fe),V+=fe}}return{changes:new Tt(d,v),filtered:Ot.create(x)}}toJSON(){let a=[];for(let d=0;d<this.sections.length;d+=2){let v=this.sections[d],x=this.sections[d+1];x<0?a.push(v):x==0?a.push([v]):a.push([v].concat(this.inserted[d>>1].toJSON()))}return a}static of(a,d,v){let x=[],E=[],D=0,V=null;function j(fe=!1){if(!fe&&!x.length)return;D<d&&ct(x,d-D,-1);let ve=new Tt(x,E);V=V?V.compose(ve.map(V)):ve,x=[],E=[],D=0}function ne(fe){if(Array.isArray(fe))for(let ve of fe)ne(ve);else if(fe instanceof Tt){if(fe.length!=d)throw new RangeError(`Mismatched change set length (got ${fe.length}, expected ${d})`);j(),V=V?V.compose(fe.map(V)):fe}else{let{from:ve,to:Le=ve,insert:Pe}=fe;if(ve>Le||ve<0||Le>d)throw new RangeError(`Invalid change range ${ve} to ${Le} (in doc of length ${d})`);let Gt=Pe?typeof Pe=="string"?p.of(Pe.split(v||Di)):Pe:p.empty,pi=Gt.length;if(ve==Le&&pi==0)return;ve<D&&j(),ve>D&&ct(x,ve-D,-1),ct(x,Le-ve,pi),Yt(E,x,Gt),D=Le}}return ne(a),j(!V),V}static empty(a){return new Tt(a?[a,-1]:[],[])}static fromJSON(a){if(!Array.isArray(a))throw new RangeError("Invalid JSON representation of ChangeSet");let d=[],v=[];for(let x=0;x<a.length;x++){let E=a[x];if(typeof E=="number")d.push(E,-1);else{if(!Array.isArray(E)||typeof E[0]!="number"||E.some((D,V)=>V&&typeof D!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(E.length==1)d.push(E[0],0);else{for(;v.length<x;)v.push(p.empty);v[x]=p.of(E.slice(1)),d.push(E[0],v[x].length)}}}return new Tt(d,v)}static createSet(a,d){return new Tt(a,d)}}function ct(R,a,d,v=!1){if(a==0&&d<=0)return;let x=R.length-2;x>=0&&d<=0&&d==R[x+1]?R[x]+=a:a==0&&R[x]==0?R[x+1]+=d:v?(R[x]+=a,R[x+1]+=d):R.push(a,d)}function Yt(R,a,d){if(d.length==0)return;let v=a.length-2>>1;if(v<R.length)R[R.length-1]=R[R.length-1].append(d);else{for(;R.length<v;)R.push(p.empty);R.push(d)}}function ri(R,a,d){let v=R.inserted;for(let x=0,E=0,D=0;D<R.sections.length;){let V=R.sections[D++],j=R.sections[D++];if(j<0)x+=V,E+=V;else{let ne=x,fe=E,ve=p.empty;for(;ne+=V,fe+=j,j&&v&&(ve=ve.append(v[D-2>>1])),!(d||D==R.sections.length||R.sections[D+1]<0);)V=R.sections[D++],j=R.sections[D++];a(x,ne,E,fe,ve),x=ne,E=fe}}}function Si(R,a,d,v=!1){let x=[],E=v?[]:null,D=new ki(R),V=new ki(a);for(let j=-1;;)if(D.ins==-1&&V.ins==-1){let ne=Math.min(D.len,V.len);ct(x,ne,-1),D.forward(ne),V.forward(ne)}else if(V.ins>=0&&(D.ins<0||j==D.i||D.off==0&&(V.len<D.len||V.len==D.len&&!d))){let ne=V.len;for(ct(x,V.ins,-1);ne;){let fe=Math.min(D.len,ne);D.ins>=0&&j<D.i&&D.len<=fe&&(ct(x,0,D.ins),E&&Yt(E,x,D.text),j=D.i),D.forward(fe),ne-=fe}V.next()}else if(D.ins>=0){let ne=0,fe=D.len;for(;fe;)if(V.ins==-1){let ve=Math.min(fe,V.len);ne+=ve,fe-=ve,V.forward(ve)}else if(V.ins==0&&V.len<fe)fe-=V.len,V.next();else break;ct(x,ne,j<D.i?D.ins:0),E&&j<D.i&&Yt(E,x,D.text),j=D.i,D.forward(D.len-fe)}else{if(D.done&&V.done)return E?Tt.createSet(x,E):Ot.create(x);throw new Error("Mismatched change set lengths")}}function Ge(R,a,d=!1){let v=[],x=d?[]:null,E=new ki(R),D=new ki(a);for(let V=!1;;){if(E.done&&D.done)return x?Tt.createSet(v,x):Ot.create(v);if(E.ins==0)ct(v,E.len,0,V),E.next();else if(D.len==0&&!D.done)ct(v,0,D.ins,V),x&&Yt(x,v,D.text),D.next();else{if(E.done||D.done)throw new Error("Mismatched change set lengths");{let j=Math.min(E.len2,D.len),ne=v.length;if(E.ins==-1){let fe=D.ins==-1?-1:D.off?0:D.ins;ct(v,j,fe,V),x&&fe&&Yt(x,v,D.text)}else D.ins==-1?(ct(v,E.off?0:E.len,j,V),x&&Yt(x,v,E.textBit(j))):(ct(v,E.off?0:E.len,D.off?0:D.ins,V),x&&!D.off&&Yt(x,v,D.text));V=(E.ins>j||D.ins>=0&&D.len>j)&&(V||v.length>ne),E.forward2(j),D.forward(j)}}}}class ki{constructor(a){this.set=a,this.i=0,this.next()}next(){let{sections:a}=this.set;this.i<a.length?(this.len=a[this.i++],this.ins=a[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:a}=this.set,d=this.i-2>>1;return d>=a.length?p.empty:a[d]}textBit(a){let{inserted:d}=this.set,v=this.i-2>>1;return v>=d.length&&!a?p.empty:d[v].slice(this.off,a==null?void 0:this.off+a)}forward(a){a==this.len?this.next():(this.len-=a,this.off+=a)}forward2(a){this.ins==-1?this.forward(a):a==this.ins?this.next():(this.ins-=a,this.off+=a)}}class Xe{constructor(a,d,v){this.from=a,this.to=d,this.flags=v}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let a=this.flags&7;return a==7?null:a}get goalColumn(){let a=this.flags>>6;return a==16777215?void 0:a}map(a,d=-1){let v,x;return this.empty?v=x=a.mapPos(this.from,d):(v=a.mapPos(this.from,1),x=a.mapPos(this.to,-1)),v==this.from&&x==this.to?this:new Xe(v,x,this.flags)}extend(a,d=a){if(a<=this.anchor&&d>=this.anchor)return oe.range(a,d);let v=Math.abs(a-this.anchor)>Math.abs(d-this.anchor)?a:d;return oe.range(this.anchor,v)}eq(a){return this.anchor==a.anchor&&this.head==a.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(a){if(!a||typeof a.anchor!="number"||typeof a.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return oe.range(a.anchor,a.head)}static create(a,d,v){return new Xe(a,d,v)}}class oe{constructor(a,d){this.ranges=a,this.mainIndex=d}map(a,d=-1){return a.empty?this:oe.create(this.ranges.map(v=>v.map(a,d)),this.mainIndex)}eq(a){if(this.ranges.length!=a.ranges.length||this.mainIndex!=a.mainIndex)return!1;for(let d=0;d<this.ranges.length;d++)if(!this.ranges[d].eq(a.ranges[d]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new oe([this.main],0)}addRange(a,d=!0){return oe.create([a].concat(this.ranges),d?0:this.mainIndex+1)}replaceRange(a,d=this.mainIndex){let v=this.ranges.slice();return v[d]=a,oe.create(v,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(a=>a.toJSON()),main:this.mainIndex}}static fromJSON(a){if(!a||!Array.isArray(a.ranges)||typeof a.main!="number"||a.main>=a.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new oe(a.ranges.map(d=>Xe.fromJSON(d)),a.main)}static single(a,d=a){return new oe([oe.range(a,d)],0)}static create(a,d=0){if(a.length==0)throw new RangeError("A selection needs at least one range");for(let v=0,x=0;x<a.length;x++){let E=a[x];if(E.empty?E.from<=v:E.from<v)return oe.normalized(a.slice(),d);v=E.to}return new oe(a,d)}static cursor(a,d=0,v,x){return Xe.create(a,a,(d==0?0:d<0?8:16)|(v==null?7:Math.min(6,v))|(x!=null?x:16777215)<<6)}static range(a,d,v,x){let E=(v!=null?v:16777215)<<6|(x==null?7:Math.min(6,x));return d<a?Xe.create(d,a,48|E):Xe.create(a,d,(d>a?8:0)|E)}static normalized(a,d=0){let v=a[d];a.sort((x,E)=>x.from-E.from),d=a.indexOf(v);for(let x=1;x<a.length;x++){let E=a[x],D=a[x-1];if(E.empty?E.from<=D.to:E.from<D.to){let V=D.from,j=Math.max(E.to,D.to);x<=d&&d--,a.splice(--x,2,E.anchor>E.head?oe.range(j,V):oe.range(V,j))}}return new oe(a,d)}}function ye(R,a){for(let d of R.ranges)if(d.to>a)throw new RangeError("Selection points outside of document")}let ke=0;class Me{constructor(a,d,v,x,E){this.combine=a,this.compareInput=d,this.compare=v,this.isStatic=x,this.id=ke++,this.default=a([]),this.extensions=typeof E=="function"?E(this):E}get reader(){return this}static define(a={}){return new Me(a.combine||(d=>d),a.compareInput||((d,v)=>d===v),a.compare||(a.combine?(d,v)=>d===v:Fe),!!a.static,a.enables)}of(a){return new Dt([],this,0,a)}compute(a,d){if(this.isStatic)throw new Error("Can't compute a static facet");return new Dt(a,this,1,d)}computeN(a,d){if(this.isStatic)throw new Error("Can't compute a static facet");return new Dt(a,this,2,d)}from(a,d){return d||(d=v=>v),this.compute([a],v=>d(v.field(a)))}}function Fe(R,a){return R==a||R.length==a.length&&R.every((d,v)=>d===a[v])}class Dt{constructor(a,d,v,x){this.dependencies=a,this.facet=d,this.type=v,this.value=x,this.id=ke++}dynamicSlot(a){var d;let v=this.value,x=this.facet.compareInput,E=this.id,D=a[E]>>1,V=this.type==2,j=!1,ne=!1,fe=[];for(let ve of this.dependencies)ve=="doc"?j=!0:ve=="selection"?ne=!0:((d=a[ve.id])!==null&&d!==void 0?d:1)&1||fe.push(a[ve.id]);return{create(ve){return ve.values[D]=v(ve),1},update(ve,Le){if(j&&Le.docChanged||ne&&(Le.docChanged||Le.selection)||Qt(ve,fe)){let Pe=v(ve);if(V?!lt(Pe,ve.values[D],x):!x(Pe,ve.values[D]))return ve.values[D]=Pe,1}return 0},reconfigure:(ve,Le)=>{let Pe,Gt=Le.config.address[E];if(Gt!=null){let pi=Z(Le,Gt);if(this.dependencies.every(bi=>bi instanceof Me?Le.facet(bi)===ve.facet(bi):bi instanceof Rt?Le.field(bi,!1)==ve.field(bi,!1):!0)||(V?lt(Pe=v(ve),pi,x):x(Pe=v(ve),pi)))return ve.values[D]=pi,0}else Pe=v(ve);return ve.values[D]=Pe,1}}}}function lt(R,a,d){if(R.length!=a.length)return!1;for(let v=0;v<R.length;v++)if(!d(R[v],a[v]))return!1;return!0}function Qt(R,a){let d=!1;for(let v of a)I(R,v)&1&&(d=!0);return d}function et(R,a,d){let v=d.map(j=>R[j.id]),x=d.map(j=>j.type),E=v.filter(j=>!(j&1)),D=R[a.id]>>1;function V(j){let ne=[];for(let fe=0;fe<v.length;fe++){let ve=Z(j,v[fe]);if(x[fe]==2)for(let Le of ve)ne.push(Le);else ne.push(ve)}return a.combine(ne)}return{create(j){for(let ne of v)I(j,ne);return j.values[D]=V(j),1},update(j,ne){if(!Qt(j,E))return 0;let fe=V(j);return a.compare(fe,j.values[D])?0:(j.values[D]=fe,1)},reconfigure(j,ne){let fe=Qt(j,v),ve=ne.config.facets[a.id],Le=ne.facet(a);if(ve&&!fe&&Fe(d,ve))return j.values[D]=Le,0;let Pe=V(j);return a.compare(Pe,Le)?(j.values[D]=Le,0):(j.values[D]=Pe,1)}}}const Li=Me.define({static:!0});class Rt{constructor(a,d,v,x,E){this.id=a,this.createF=d,this.updateF=v,this.compareF=x,this.spec=E,this.provides=void 0}static define(a){let d=new Rt(ke++,a.create,a.update,a.compare||((v,x)=>v===x),a);return a.provide&&(d.provides=a.provide(d)),d}create(a){let d=a.facet(Li).find(v=>v.field==this);return((d==null?void 0:d.create)||this.createF)(a)}slot(a){let d=a[this.id]>>1;return{create:v=>(v.values[d]=this.create(v),1),update:(v,x)=>{let E=v.values[d],D=this.updateF(E,x);return this.compareF(E,D)?0:(v.values[d]=D,1)},reconfigure:(v,x)=>x.config.address[this.id]!=null?(v.values[d]=x.field(this),0):(v.values[d]=this.create(v),1)}}init(a){return[this,Li.of({field:this,create:a})]}get extension(){return this}}const kt={lowest:4,low:3,default:2,high:1,highest:0};function _t(R){return a=>new hn(a,R)}const Xi={highest:_t(kt.highest),high:_t(kt.high),default:_t(kt.default),low:_t(kt.low),lowest:_t(kt.lowest)};class hn{constructor(a,d){this.inner=a,this.prec=d}}class ie{of(a){return new w(this,a)}reconfigure(a){return ie.reconfigure.of({compartment:this,extension:a})}get(a){return a.config.compartments.get(this)}}class w{constructor(a,d){this.compartment=a,this.inner=d}}class C{constructor(a,d,v,x,E,D){for(this.base=a,this.compartments=d,this.dynamicSlots=v,this.address=x,this.staticValues=E,this.facets=D,this.statusTemplate=[];this.statusTemplate.length<v.length;)this.statusTemplate.push(0)}staticFacet(a){let d=this.address[a.id];return d==null?a.default:this.staticValues[d>>1]}static resolve(a,d,v){let x=[],E=Object.create(null),D=new Map;for(let Le of N(a,d,D))Le instanceof Rt?x.push(Le):(E[Le.facet.id]||(E[Le.facet.id]=[])).push(Le);let V=Object.create(null),j=[],ne=[];for(let Le of x)V[Le.id]=ne.length<<1,ne.push(Pe=>Le.slot(Pe));let fe=v==null?void 0:v.config.facets;for(let Le in E){let Pe=E[Le],Gt=Pe[0].facet,pi=fe&&fe[Le]||[];if(Pe.every(bi=>bi.type==0))if(V[Gt.id]=j.length<<1|1,Fe(pi,Pe))j.push(v.facet(Gt));else{let bi=Gt.combine(Pe.map(jn=>jn.value));j.push(v&&Gt.compare(bi,v.facet(Gt))?v.facet(Gt):bi)}else{for(let bi of Pe)bi.type==0?(V[bi.id]=j.length<<1|1,j.push(bi.value)):(V[bi.id]=ne.length<<1,ne.push(jn=>bi.dynamicSlot(jn)));V[Gt.id]=ne.length<<1,ne.push(bi=>et(bi,Gt,Pe))}}let ve=ne.map(Le=>Le(V));return new C(a,D,ve,V,j,E)}}function N(R,a,d){let v=[[],[],[],[],[]],x=new Map;function E(D,V){let j=x.get(D);if(j!=null){if(j<=V)return;let ne=v[j].indexOf(D);ne>-1&&v[j].splice(ne,1),D instanceof w&&d.delete(D.compartment)}if(x.set(D,V),Array.isArray(D))for(let ne of D)E(ne,V);else if(D instanceof w){if(d.has(D.compartment))throw new RangeError("Duplicate use of compartment in extensions");let ne=a.get(D.compartment)||D.inner;d.set(D.compartment,ne),E(ne,V)}else if(D instanceof hn)E(D.inner,D.prec);else if(D instanceof Rt)v[V].push(D),D.provides&&E(D.provides,V);else if(D instanceof Dt)v[V].push(D),D.facet.extensions&&E(D.facet.extensions,kt.default);else{let ne=D.extension;if(!ne)throw new Error(`Unrecognized extension value in extension set (${D}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);E(ne,V)}}return E(R,kt.default),v.reduce((D,V)=>D.concat(V))}function I(R,a){if(a&1)return 2;let d=a>>1,v=R.status[d];if(v==4)throw new Error("Cyclic dependency between fields and/or facets");if(v&2)return v;R.status[d]=4;let x=R.computeSlot(R,R.config.dynamicSlots[d]);return R.status[d]=2|x}function Z(R,a){return a&1?R.config.staticValues[a>>1]:R.values[a>>1]}const ee=Me.define(),se=Me.define({combine:R=>R.some(a=>a),static:!0}),xe=Me.define({combine:R=>R.length?R[0]:void 0,static:!0}),He=Me.define(),Oe=Me.define(),Je=Me.define(),tt=Me.define({combine:R=>R.length?R[0]:!1});class rt{constructor(a,d){this.type=a,this.value=d}static define(){return new ei}}class ei{of(a){return new rt(this,a)}}class ci{constructor(a){this.map=a}of(a){return new Vt(this,a)}}class Vt{constructor(a,d){this.type=a,this.value=d}map(a){let d=this.type.map(this.value,a);return d===void 0?void 0:d==this.value?this:new Vt(this.type,d)}is(a){return this.type==a}static define(a={}){return new ci(a.map||(d=>d))}static mapEffects(a,d){if(!a.length)return a;let v=[];for(let x of a){let E=x.map(d);E&&v.push(E)}return v}}Vt.reconfigure=Vt.define(),Vt.appendConfig=Vt.define();class zt{constructor(a,d,v,x,E,D){this.startState=a,this.changes=d,this.selection=v,this.effects=x,this.annotations=E,this.scrollIntoView=D,this._doc=null,this._state=null,v&&ye(v,d.newLength),E.some(V=>V.type==zt.time)||(this.annotations=E.concat(zt.time.of(Date.now())))}static create(a,d,v,x,E,D){return new zt(a,d,v,x,E,D)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(a){for(let d of this.annotations)if(d.type==a)return d.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(a){let d=this.annotation(zt.userEvent);return!!(d&&(d==a||d.length>a.length&&d.slice(0,a.length)==a&&d[a.length]=="."))}}zt.time=rt.define(),zt.userEvent=rt.define(),zt.addToHistory=rt.define(),zt.remote=rt.define();function Ct(R,a){let d=[];for(let v=0,x=0;;){let E,D;if(v<R.length&&(x==a.length||a[x]>=R[v]))E=R[v++],D=R[v++];else if(x<a.length)E=a[x++],D=a[x++];else return d;!d.length||d[d.length-1]<E?d.push(E,D):d[d.length-1]<D&&(d[d.length-1]=D)}}function Bt(R,a,d){var v;let x,E,D;return d?(x=a.changes,E=Tt.empty(a.changes.length),D=R.changes.compose(a.changes)):(x=a.changes.map(R.changes),E=R.changes.mapDesc(a.changes,!0),D=R.changes.compose(x)),{changes:D,selection:a.selection?a.selection.map(E):(v=R.selection)===null||v===void 0?void 0:v.map(x),effects:Vt.mapEffects(R.effects,x).concat(Vt.mapEffects(a.effects,E)),annotations:R.annotations.length?R.annotations.concat(a.annotations):a.annotations,scrollIntoView:R.scrollIntoView||a.scrollIntoView}}function Ci(R,a,d){let v=a.selection,x=st(a.annotations);return a.userEvent&&(x=x.concat(zt.userEvent.of(a.userEvent))),{changes:a.changes instanceof Tt?a.changes:Tt.of(a.changes||[],d,R.facet(xe)),selection:v&&(v instanceof oe?v:oe.single(v.anchor,v.head)),effects:st(a.effects),annotations:x,scrollIntoView:!!a.scrollIntoView}}function it(R,a,d){let v=Ci(R,a.length?a[0]:{},R.doc.length);a.length&&a[0].filter===!1&&(d=!1);for(let E=1;E<a.length;E++){a[E].filter===!1&&(d=!1);let D=!!a[E].sequential;v=Bt(v,Ci(R,a[E],D?v.changes.newLength:R.doc.length),D)}let x=zt.create(R,v.changes,v.selection,v.effects,v.annotations,v.scrollIntoView);return We(d?Ye(x):x)}function Ye(R){let a=R.startState,d=!0;for(let x of a.facet(He)){let E=x(R);if(E===!1){d=!1;break}Array.isArray(E)&&(d=d===!0?E:Ct(d,E))}if(d!==!0){let x,E;if(d===!1)E=R.changes.invertedDesc,x=Tt.empty(a.doc.length);else{let D=R.changes.filter(d);x=D.changes,E=D.filtered.mapDesc(D.changes).invertedDesc}R=zt.create(a,x,R.selection&&R.selection.map(E),Vt.mapEffects(R.effects,E),R.annotations,R.scrollIntoView)}let v=a.facet(Oe);for(let x=v.length-1;x>=0;x--){let E=v[x](R);E instanceof zt?R=E:Array.isArray(E)&&E.length==1&&E[0]instanceof zt?R=E[0]:R=it(a,st(E),!1)}return R}function We(R){let a=R.startState,d=a.facet(Je),v=R;for(let x=d.length-1;x>=0;x--){let E=d[x](R);E&&Object.keys(E).length&&(v=Bt(v,Ci(a,E,R.changes.newLength),!0))}return v==R?R:zt.create(a,R.changes,R.selection,v.effects,v.annotations,v.scrollIntoView)}const Ut=[];function st(R){return R==null?Ut:Array.isArray(R)?R:[R]}var ot=function(R){return R[R.Word=0]="Word",R[R.Space=1]="Space",R[R.Other=2]="Other",R}(ot||(ot={}));const gt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let at;try{at=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Lt(R){if(at)return at.test(R);for(let a=0;a<R.length;a++){let d=R[a];if(/\w/.test(d)||d>"\x80"&&(d.toUpperCase()!=d.toLowerCase()||gt.test(d)))return!0}return!1}function $t(R){return a=>{if(!/\S/.test(a))return ot.Space;if(Lt(a))return ot.Word;for(let d=0;d<R.length;d++)if(a.indexOf(R[d])>-1)return ot.Word;return ot.Other}}class qe{constructor(a,d,v,x,E,D){this.config=a,this.doc=d,this.selection=v,this.values=x,this.status=a.statusTemplate.slice(),this.computeSlot=E,D&&(D._state=this);for(let V=0;V<this.config.dynamicSlots.length;V++)I(this,V<<1);this.computeSlot=null}field(a,d=!0){let v=this.config.address[a.id];if(v==null){if(d)throw new RangeError("Field is not present in this state");return}return I(this,v),Z(this,v)}update(...a){return it(this,a,!0)}applyTransaction(a){let d=this.config,{base:v,compartments:x}=d;for(let V of a.effects)V.is(ie.reconfigure)?(d&&(x=new Map,d.compartments.forEach((j,ne)=>x.set(ne,j)),d=null),x.set(V.value.compartment,V.value.extension)):V.is(Vt.reconfigure)?(d=null,v=V.value):V.is(Vt.appendConfig)&&(d=null,v=st(v).concat(V.value));let E;d?E=a.startState.values.slice():(d=C.resolve(v,x,this),E=new qe(d,this.doc,this.selection,d.dynamicSlots.map(()=>null),(j,ne)=>ne.reconfigure(j,this),null).values);let D=a.startState.facet(se)?a.newSelection:a.newSelection.asSingle();new qe(d,a.newDoc,D,E,(V,j)=>j.update(V,a),a)}replaceSelection(a){return typeof a=="string"&&(a=this.toText(a)),this.changeByRange(d=>({changes:{from:d.from,to:d.to,insert:a},range:oe.cursor(d.from+a.length)}))}changeByRange(a){let d=this.selection,v=a(d.ranges[0]),x=this.changes(v.changes),E=[v.range],D=st(v.effects);for(let V=1;V<d.ranges.length;V++){let j=a(d.ranges[V]),ne=this.changes(j.changes),fe=ne.map(x);for(let Le=0;Le<V;Le++)E[Le]=E[Le].map(fe);let ve=x.mapDesc(ne,!0);E.push(j.range.map(ve)),x=x.compose(fe),D=Vt.mapEffects(D,fe).concat(Vt.mapEffects(st(j.effects),ve))}return{changes:x,selection:oe.create(E,d.mainIndex),effects:D}}changes(a=[]){return a instanceof Tt?a:Tt.of(a,this.doc.length,this.facet(qe.lineSeparator))}toText(a){return p.of(a.split(this.facet(qe.lineSeparator)||Di))}sliceDoc(a=0,d=this.doc.length){return this.doc.sliceString(a,d,this.lineBreak)}facet(a){let d=this.config.address[a.id];return d==null?a.default:(I(this,d),Z(this,d))}toJSON(a){let d={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(a)for(let v in a){let x=a[v];x instanceof Rt&&this.config.address[x.id]!=null&&(d[v]=x.spec.toJSON(this.field(a[v]),this))}return d}static fromJSON(a,d={},v){if(!a||typeof a.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let x=[];if(v){for(let E in v)if(Object.prototype.hasOwnProperty.call(a,E)){let D=v[E],V=a[E];x.push(D.init(j=>D.spec.fromJSON(V,j)))}}return qe.create({doc:a.doc,selection:oe.fromJSON(a.selection),extensions:d.extensions?x.concat([d.extensions]):x})}static create(a={}){let d=C.resolve(a.extensions||[],new Map),v=a.doc instanceof p?a.doc:p.of((a.doc||"").split(d.staticFacet(qe.lineSeparator)||Di)),x=a.selection?a.selection instanceof oe?a.selection:oe.single(a.selection.anchor,a.selection.head):oe.single(0);return ye(x,v.length),d.staticFacet(se)||(x=x.asSingle()),new qe(d,v,x,d.dynamicSlots.map(()=>null),(E,D)=>D.create(E),null)}get tabSize(){return this.facet(qe.tabSize)}get lineBreak(){return this.facet(qe.lineSeparator)||`
`}get readOnly(){return this.facet(tt)}phrase(a,...d){for(let v of this.facet(qe.phrases))if(Object.prototype.hasOwnProperty.call(v,a)){a=v[a];break}return d.length&&(a=a.replace(/\$(\$|\d*)/g,(v,x)=>{if(x=="$")return"$";let E=+(x||1);return!E||E>d.length?v:d[E-1]})),a}languageDataAt(a,d,v=-1){let x=[];for(let E of this.facet(ee))for(let D of E(this,d,v))Object.prototype.hasOwnProperty.call(D,a)&&x.push(D[a]);return x}charCategorizer(a){return $t(this.languageDataAt("wordChars",a).join(""))}wordAt(a){let{text:d,from:v,length:x}=this.doc.lineAt(a),E=this.charCategorizer(a),D=a-v,V=a-v;for(;D>0;){let j=Xt(d,D,!1);if(E(d.slice(j,D))!=ot.Word)break;D=j}for(;V<x;){let j=Xt(d,V);if(E(d.slice(V,j))!=ot.Word)break;V=j}return D==V?null:oe.range(D+v,V+v)}}qe.allowMultipleSelections=se,qe.tabSize=Me.define({combine:R=>R.length?R[0]:4}),qe.lineSeparator=xe,qe.readOnly=tt,qe.phrases=Me.define({compare(R,a){let d=Object.keys(R),v=Object.keys(a);return d.length==v.length&&d.every(x=>R[x]==a[x])}}),qe.languageData=ee,qe.changeFilter=He,qe.transactionFilter=Oe,qe.transactionExtender=Je,ie.reconfigure=Vt.define();function Vi(R,a,d={}){let v={};for(let x of R)for(let E of Object.keys(x)){let D=x[E],V=v[E];if(V===void 0)v[E]=D;else if(!(V===D||D===void 0))if(Object.hasOwnProperty.call(d,E))v[E]=d[E](V,D);else throw new Error("Config merge conflict for field "+E)}for(let x in a)v[x]===void 0&&(v[x]=a[x]);return v}class fi{eq(a){return this==a}range(a,d=a){return vi.create(a,d,this)}}fi.prototype.startSide=fi.prototype.endSide=0,fi.prototype.point=!1,fi.prototype.mapMode=Jt.TrackDel;class vi{constructor(a,d,v){this.from=a,this.to=d,this.value=v}static create(a,d,v){return new vi(a,d,v)}}function tn(R,a){return R.from-a.from||R.value.startSide-a.value.startSide}class Ti{constructor(a,d,v,x){this.from=a,this.to=d,this.value=v,this.maxPoint=x}get length(){return this.to[this.to.length-1]}findIndex(a,d,v,x=0){let E=v?this.to:this.from;for(let D=x,V=E.length;;){if(D==V)return D;let j=D+V>>1,ne=E[j]-a||(v?this.value[j].endSide:this.value[j].startSide)-d;if(j==D)return ne>=0?D:V;ne>=0?V=j:D=j+1}}between(a,d,v,x){for(let E=this.findIndex(d,-1e9,!0),D=this.findIndex(v,1e9,!1,E);E<D;E++)if(x(this.from[E]+a,this.to[E]+a,this.value[E])===!1)return!1}map(a,d){let v=[],x=[],E=[],D=-1,V=-1;for(let j=0;j<this.value.length;j++){let ne=this.value[j],fe=this.from[j]+a,ve=this.to[j]+a,Le,Pe;if(fe==ve){let Gt=d.mapPos(fe,ne.startSide,ne.mapMode);if(Gt==null||(Le=Pe=Gt,ne.startSide!=ne.endSide&&(Pe=d.mapPos(fe,ne.endSide),Pe<Le)))continue}else if(Le=d.mapPos(fe,ne.startSide),Pe=d.mapPos(ve,ne.endSide),Le>Pe||Le==Pe&&ne.startSide>0&&ne.endSide<=0)continue;(Pe-Le||ne.endSide-ne.startSide)<0||(D<0&&(D=Le),ne.point&&(V=Math.max(V,Pe-Le)),v.push(ne),x.push(Le-D),E.push(Pe-D))}return{mapped:v.length?new Ti(x,E,v,V):null,pos:D}}}class Ht{constructor(a,d,v,x){this.chunkPos=a,this.chunk=d,this.nextLayer=v,this.maxPoint=x}static create(a,d,v,x){return new Ht(a,d,v,x)}get length(){let a=this.chunk.length-1;return a<0?0:Math.max(this.chunkEnd(a),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let a=this.nextLayer.size;for(let d of this.chunk)a+=d.value.length;return a}chunkEnd(a){return this.chunkPos[a]+this.chunk[a].length}update(a){let{add:d=[],sort:v=!1,filterFrom:x=0,filterTo:E=this.length}=a,D=a.filter;if(d.length==0&&!D)return this;if(v&&(d=d.slice().sort(tn)),this.isEmpty)return d.length?Ht.of(d):this;let V=new $i(this,null,-1).goto(0),j=0,ne=[],fe=new zi;for(;V.value||j<d.length;)if(j<d.length&&(V.from-d[j].from||V.startSide-d[j].value.startSide)>=0){let ve=d[j++];fe.addInner(ve.from,ve.to,ve.value)||ne.push(ve)}else V.rangeIndex==1&&V.chunkIndex<this.chunk.length&&(j==d.length||this.chunkEnd(V.chunkIndex)<d[j].from)&&(!D||x>this.chunkEnd(V.chunkIndex)||E<this.chunkPos[V.chunkIndex])&&fe.addChunk(this.chunkPos[V.chunkIndex],this.chunk[V.chunkIndex])?V.nextChunk():((!D||x>V.to||E<V.from||D(V.from,V.to,V.value))&&(fe.addInner(V.from,V.to,V.value)||ne.push(vi.create(V.from,V.to,V.value))),V.next());return fe.finishInner(this.nextLayer.isEmpty&&!ne.length?Ht.empty:this.nextLayer.update({add:ne,filter:D,filterFrom:x,filterTo:E}))}map(a){if(a.empty||this.isEmpty)return this;let d=[],v=[],x=-1;for(let D=0;D<this.chunk.length;D++){let V=this.chunkPos[D],j=this.chunk[D],ne=a.touchesRange(V,V+j.length);if(ne===!1)x=Math.max(x,j.maxPoint),d.push(j),v.push(a.mapPos(V));else if(ne===!0){let{mapped:fe,pos:ve}=j.map(V,a);fe&&(x=Math.max(x,fe.maxPoint),d.push(fe),v.push(ve))}}let E=this.nextLayer.map(a);return d.length==0?E:new Ht(v,d,E||Ht.empty,x)}between(a,d,v){if(!this.isEmpty){for(let x=0;x<this.chunk.length;x++){let E=this.chunkPos[x],D=this.chunk[x];if(d>=E&&a<=E+D.length&&D.between(E,a-E,d-E,v)===!1)return}this.nextLayer.between(a,d,v)}}iter(a=0){return nn.from([this]).goto(a)}get isEmpty(){return this.nextLayer==this}static iter(a,d=0){return nn.from(a).goto(d)}static compare(a,d,v,x,E=-1){let D=a.filter(ve=>ve.maxPoint>0||!ve.isEmpty&&ve.maxPoint>=E),V=d.filter(ve=>ve.maxPoint>0||!ve.isEmpty&&ve.maxPoint>=E),j=Yi(D,V,v),ne=new Zi(D,j,E),fe=new Zi(V,j,E);v.iterGaps((ve,Le,Pe)=>$n(ne,ve,fe,Le,Pe,x)),v.empty&&v.length==0&&$n(ne,0,fe,0,0,x)}static eq(a,d,v=0,x){x==null&&(x=1e9-1);let E=a.filter(fe=>!fe.isEmpty&&d.indexOf(fe)<0),D=d.filter(fe=>!fe.isEmpty&&a.indexOf(fe)<0);if(E.length!=D.length)return!1;if(!E.length)return!0;let V=Yi(E,D),j=new Zi(E,V,0).goto(v),ne=new Zi(D,V,0).goto(v);for(;;){if(j.to!=ne.to||!cn(j.active,ne.active)||j.point&&(!ne.point||!j.point.eq(ne.point)))return!1;if(j.to>x)return!0;j.next(),ne.next()}}static spans(a,d,v,x,E=-1){let D=new Zi(a,null,E).goto(d),V=d,j=D.openStart;for(;;){let ne=Math.min(D.to,v);if(D.point){let fe=D.activeForPoint(D.to),ve=D.pointFrom<d?fe.length+1:Math.min(fe.length,j);x.point(V,ne,D.point,fe,ve,D.pointRank),j=Math.min(D.openEnd(ne),fe.length)}else ne>V&&(x.span(V,ne,D.active,j),j=D.openEnd(ne));if(D.to>v)return j+(D.point&&D.to>v?1:0);V=D.to,D.next()}}static of(a,d=!1){let v=new zi;for(let x of a instanceof vi?[a]:d?Ni(a):a)v.add(x.from,x.to,x.value);return v.finish()}}Ht.empty=new Ht([],[],null,-1);function Ni(R){if(R.length>1)for(let a=R[0],d=1;d<R.length;d++){let v=R[d];if(tn(a,v)>0)return R.slice().sort(tn);a=v}return R}Ht.empty.nextLayer=Ht.empty;class zi{finishChunk(a){this.chunks.push(new Ti(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,a&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(a,d,v){this.addInner(a,d,v)||(this.nextLayer||(this.nextLayer=new zi)).add(a,d,v)}addInner(a,d,v){let x=a-this.lastTo||v.startSide-this.last.endSide;if(x<=0&&(a-this.lastFrom||v.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return x<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=a),this.from.push(a-this.chunkStart),this.to.push(d-this.chunkStart),this.last=v,this.lastFrom=a,this.lastTo=d,this.value.push(v),v.point&&(this.maxPoint=Math.max(this.maxPoint,d-a)),!0)}addChunk(a,d){if((a-this.lastTo||d.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,d.maxPoint),this.chunks.push(d),this.chunkPos.push(a);let v=d.value.length-1;return this.last=d.value[v],this.lastFrom=d.from[v]+a,this.lastTo=d.to[v]+a,!0}finish(){return this.finishInner(Ht.empty)}finishInner(a){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return a;let d=Ht.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(a):a,this.setMaxPoint);return this.from=null,d}}function Yi(R,a,d){let v=new Map;for(let E of R)for(let D=0;D<E.chunk.length;D++)E.chunk[D].maxPoint<=0&&v.set(E.chunk[D],E.chunkPos[D]);let x=new Set;for(let E of a)for(let D=0;D<E.chunk.length;D++){let V=v.get(E.chunk[D]);V!=null&&(d?d.mapPos(V):V)==E.chunkPos[D]&&!(d!=null&&d.touchesRange(V,V+E.chunk[D].length))&&x.add(E.chunk[D])}return x}class $i{constructor(a,d,v,x=0){this.layer=a,this.skip=d,this.minPoint=v,this.rank=x}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(a,d=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(a,d,!1),this}gotoInner(a,d,v){for(;this.chunkIndex<this.layer.chunk.length;){let x=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(x)||this.layer.chunkEnd(this.chunkIndex)<a||x.maxPoint<this.minPoint))break;this.chunkIndex++,v=!1}if(this.chunkIndex<this.layer.chunk.length){let x=this.layer.chunk[this.chunkIndex].findIndex(a-this.layer.chunkPos[this.chunkIndex],d,!0);(!v||this.rangeIndex<x)&&this.setRangeIndex(x)}this.next()}forward(a,d){(this.to-a||this.endSide-d)<0&&this.gotoInner(a,d,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let a=this.layer.chunkPos[this.chunkIndex],d=this.layer.chunk[this.chunkIndex],v=a+d.from[this.rangeIndex];if(this.from=v,this.to=a+d.to[this.rangeIndex],this.value=d.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(a){if(a==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=a}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(a){return this.from-a.from||this.startSide-a.startSide||this.rank-a.rank||this.to-a.to||this.endSide-a.endSide}}class nn{constructor(a){this.heap=a}static from(a,d=null,v=-1){let x=[];for(let E=0;E<a.length;E++)for(let D=a[E];!D.isEmpty;D=D.nextLayer)D.maxPoint>=v&&x.push(new $i(D,d,v,E));return x.length==1?x[0]:new nn(x)}get startSide(){return this.value?this.value.startSide:0}goto(a,d=-1e9){for(let v of this.heap)v.goto(a,d);for(let v=this.heap.length>>1;v>=0;v--)si(this.heap,v);return this.next(),this}forward(a,d){for(let v of this.heap)v.forward(a,d);for(let v=this.heap.length>>1;v>=0;v--)si(this.heap,v);(this.to-a||this.value.endSide-d)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let a=this.heap[0];this.from=a.from,this.to=a.to,this.value=a.value,this.rank=a.rank,a.value&&a.next(),si(this.heap,0)}}}function si(R,a){for(let d=R[a];;){let v=(a<<1)+1;if(v>=R.length)break;let x=R[v];if(v+1<R.length&&x.compare(R[v+1])>=0&&(x=R[v+1],v++),d.compare(x)<0)break;R[v]=d,R[a]=x,a=v}}class Zi{constructor(a,d,v){this.minPoint=v,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=nn.from(a,d,v)}goto(a,d=-1e9){return this.cursor.goto(a,d),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=a,this.endSide=d,this.openStart=-1,this.next(),this}forward(a,d){for(;this.minActive>-1&&(this.activeTo[this.minActive]-a||this.active[this.minActive].endSide-d)<0;)this.removeActive(this.minActive);this.cursor.forward(a,d)}removeActive(a){di(this.active,a),di(this.activeTo,a),di(this.activeRank,a),this.minActive=On(this.active,this.activeTo)}addActive(a){let d=0,{value:v,to:x,rank:E}=this.cursor;for(;d<this.activeRank.length&&this.activeRank[d]<=E;)d++;Nn(this.active,d,v),Nn(this.activeTo,d,x),Nn(this.activeRank,d,E),a&&Nn(a,d,this.cursor.from),this.minActive=On(this.active,this.activeTo)}next(){let a=this.to,d=this.point;this.point=null;let v=this.openStart<0?[]:null;for(;;){let x=this.minActive;if(x>-1&&(this.activeTo[x]-this.cursor.from||this.active[x].endSide-this.cursor.startSide)<0){if(this.activeTo[x]>a){this.to=this.activeTo[x],this.endSide=this.active[x].endSide;break}this.removeActive(x),v&&di(v,x)}else if(this.cursor.value)if(this.cursor.from>a){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let E=this.cursor.value;if(!E.point)this.addActive(v),this.cursor.next();else if(d&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=E,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=E.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(v){this.openStart=0;for(let x=v.length-1;x>=0&&v[x]<a;x--)this.openStart++}}activeForPoint(a){if(!this.active.length)return this.active;let d=[];for(let v=this.active.length-1;v>=0&&!(this.activeRank[v]<this.pointRank);v--)(this.activeTo[v]>a||this.activeTo[v]==a&&this.active[v].endSide>=this.point.endSide)&&d.push(this.active[v]);return d.reverse()}openEnd(a){let d=0;for(let v=this.activeTo.length-1;v>=0&&this.activeTo[v]>a;v--)d++;return d}}function $n(R,a,d,v,x,E){R.goto(a),d.goto(v);let D=v+x,V=v,j=v-a;for(;;){let ne=R.to+j-d.to||R.endSide-d.endSide,fe=ne<0?R.to+j:d.to,ve=Math.min(fe,D);if(R.point||d.point?R.point&&d.point&&(R.point==d.point||R.point.eq(d.point))&&cn(R.activeForPoint(R.to),d.activeForPoint(d.to))||E.comparePoint(V,ve,R.point,d.point):ve>V&&!cn(R.active,d.active)&&E.compareRange(V,ve,R.active,d.active),fe>D)break;V=fe,ne<=0&&R.next(),ne>=0&&d.next()}}function cn(R,a){if(R.length!=a.length)return!1;for(let d=0;d<R.length;d++)if(R[d]!=a[d]&&!R[d].eq(a[d]))return!1;return!0}function di(R,a){for(let d=a,v=R.length-1;d<v;d++)R[d]=R[d+1];R.pop()}function Nn(R,a,d){for(let v=R.length-1;v>=a;v--)R[v+1]=R[v];R[a]=d}function On(R,a){let d=-1,v=1e9;for(let x=0;x<a.length;x++)(a[x]-v||R[x].endSide-R[d].endSide)<0&&(d=x,v=a[x]);return d}function qn(R,a,d=R.length){let v=0;for(let x=0;x<d;)R.charCodeAt(x)==9?(v+=a-v%a,x++):(v++,x=Xt(R,x));return v}function Fn(R,a,d,v){for(let x=0,E=0;;){if(E>=a)return x;if(x==R.length)break;E+=R.charCodeAt(x)==9?d-E%d:1,x=Xt(R,x)}return v===!0?-1:R.length}},65329:(kn,Wt,q)=>{q.d(Wt,{p:()=>Ye,Nm:()=>j,tk:()=>Ft,SJ:()=>Ai,lg:()=>di,l9:()=>Ci,S2:()=>il,Uw:()=>gi,qr:()=>bs,Sd:()=>Wo,gB:()=>Tl,v5:()=>Ho,ZO:()=>el,HQ:()=>dl,AE:()=>xl,bF:()=>Al,$f:()=>Ln,Eu:()=>Ys,OO:()=>si,W$:()=>ws,Zs:()=>Po,$1:()=>_r,mH:()=>Js,hJ:()=>js});for(var p=q(1727),Se=q(37207),de={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},L={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},G=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Ce=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Ie=0;Ie<10;Ie++)de[48+Ie]=de[96+Ie]=String(Ie);for(var Ie=1;Ie<=24;Ie++)de[Ie+111]="F"+Ie;for(var Ie=65;Ie<=90;Ie++)de[Ie]=String.fromCharCode(Ie+32),L[Ie]=String.fromCharCode(Ie);for(var vt in de)L.hasOwnProperty(vt)||(L[vt]=de[vt]);function dt(s){var e=G&&s.metaKey&&s.shiftKey&&!s.ctrlKey&&!s.altKey||Ce&&s.shiftKey&&s.key&&s.key.length==1||s.key=="Unidentified",t=!e&&s.key||(s.shiftKey?L:de)[s.keyCode]||s.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function bt(s){let e;return s.nodeType==11?e=s.getSelection?s:s.ownerDocument:e=s,e.getSelection()}function $e(s,e){return e?s==e||s.contains(e.nodeType!=1?e.parentNode:e):!1}function nt(s){let e=s.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function _e(s,e){if(!e.anchorNode)return!1;try{return $e(s,e.anchorNode)}catch{return!1}}function mt(s){return s.nodeType==3?ct(s,0,s.nodeValue.length).getClientRects():s.nodeType==1?s.getClientRects():[]}function yi(s,e,t,n){return t?me(s,e,t,n,-1)||me(s,e,t,n,1):!1}function Xt(s){for(var e=0;;e++)if(s=s.previousSibling,!s)return e}function me(s,e,t,n,r){for(;;){if(s==t&&e==n)return!0;if(e==(r<0?0:pt(s))){if(s.nodeName=="DIV")return!1;let c=s.parentNode;if(!c||c.nodeType!=1)return!1;e=Xt(s)+(r<0?0:1),s=c}else if(s.nodeType==1){if(s=s.childNodes[e+(r<0?-1:0)],s.nodeType==1&&s.contentEditable=="false")return!1;e=r<0?pt(s):0}else return!1}}function pt(s){return s.nodeType==3?s.nodeValue.length:s.childNodes.length}function Kt(s,e){let t=e?s.left:s.right;return{left:t,right:t,top:s.top,bottom:s.bottom}}function wi(s){return{left:0,right:s.innerWidth,top:0,bottom:s.innerHeight}}function ui(s,e){let t=e.width/s.offsetWidth,n=e.height/s.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-s.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-s.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function Et(s,e,t,n,r,c,u,y){let b=s.ownerDocument,M=b.defaultView||window;for(let A=s,F=!1;A&&!F;)if(A.nodeType==1){let $,X=A==b.body,_=1,le=1;if(X)$=wi(M);else{if(/^(fixed|sticky)$/.test(getComputedStyle(A).position)&&(F=!0),A.scrollHeight<=A.clientHeight&&A.scrollWidth<=A.clientWidth){A=A.assignedSlot||A.parentNode;continue}let Ze=A.getBoundingClientRect();({scaleX:_,scaleY:le}=ui(A,Ze)),$={left:Ze.left,right:Ze.left+A.clientWidth*_,top:Ze.top,bottom:Ze.top+A.clientHeight*le}}let re=0,pe=0;if(r=="nearest")e.top<$.top?(pe=-($.top-e.top+u),t>0&&e.bottom>$.bottom+pe&&(pe=e.bottom-$.bottom+pe+u)):e.bottom>$.bottom&&(pe=e.bottom-$.bottom+u,t<0&&e.top-pe<$.top&&(pe=-($.top+pe-e.top+u)));else{let Ze=e.bottom-e.top,ft=$.bottom-$.top;pe=(r=="center"&&Ze<=ft?e.top+Ze/2-ft/2:r=="start"||r=="center"&&t<0?e.top-u:e.bottom-ft+u)-$.top}if(n=="nearest"?e.left<$.left?(re=-($.left-e.left+c),t>0&&e.right>$.right+re&&(re=e.right-$.right+re+c)):e.right>$.right&&(re=e.right-$.right+c,t<0&&e.left<$.left+re&&(re=-($.left+re-e.left+c))):re=(n=="center"?e.left+(e.right-e.left)/2-($.right-$.left)/2:n=="start"==y?e.left-c:e.right-($.right-$.left)+c)-$.left,re||pe)if(X)M.scrollBy(re,pe);else{let Ze=0,ft=0;if(pe){let Ke=A.scrollTop;A.scrollTop+=pe/le,ft=(A.scrollTop-Ke)*le}if(re){let Ke=A.scrollLeft;A.scrollLeft+=re/_,Ze=(A.scrollLeft-Ke)*_}e={left:e.left-Ze,top:e.top-ft,right:e.right-Ze,bottom:e.bottom-ft},Ze&&Math.abs(Ze-re)<1&&(n="nearest"),ft&&Math.abs(ft-pe)<1&&(r="nearest")}if(X)break;A=A.assignedSlot||A.parentNode}else if(A.nodeType==11)A=A.host;else break}function ii(s){let e=s.ownerDocument;for(let t=s.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class Di{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?pt(t):0),n,Math.min(e.focusOffset,n?pt(n):0))}set(e,t,n,r){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=r}}let Jt=null;function Ot(s){if(s.setActive)return s.setActive();if(Jt)return s.focus(Jt);let e=[];for(let t=s;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(s.focus(Jt==null?{get preventScroll(){return Jt={preventScroll:!0},!0}}:void 0),!Jt){Jt=!1;for(let t=0;t<e.length;){let n=e[t++],r=e[t++],c=e[t++];n.scrollTop!=r&&(n.scrollTop=r),n.scrollLeft!=c&&(n.scrollLeft=c)}}}let Tt;function ct(s,e,t=e){let n=Tt||(Tt=document.createRange());return n.setEnd(s,t),n.setStart(s,e),n}function Yt(s,e,t){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0},r=new KeyboardEvent("keydown",n);r.synthetic=!0,s.dispatchEvent(r);let c=new KeyboardEvent("keyup",n);return c.synthetic=!0,s.dispatchEvent(c),r.defaultPrevented||c.defaultPrevented}function ri(s){for(;s;){if(s&&(s.nodeType==9||s.nodeType==11&&s.host))return s;s=s.assignedSlot||s.parentNode}return null}function Si(s){for(;s.attributes.length;)s.removeAttributeNode(s.attributes[0])}function Ge(s,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,pt(t));;)if(n){if(t.nodeType!=1)return!1;let r=t.childNodes[n-1];r.contentEditable=="false"?n--:(t=r,n=pt(t))}else{if(t==s)return!0;n=Xt(t),t=t.parentNode}}function ki(s){return s.scrollTop>Math.max(1,s.scrollHeight-s.clientHeight-4)}class Xe{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Xe(e.parentNode,Xt(e),t)}static after(e,t){return new Xe(e.parentNode,Xt(e)+1,t)}}const oe=[];class ye{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,r=null,c;for(let u of this.children){if(u.flags&7){if(!u.dom&&(c=r?r.nextSibling:n.firstChild)){let y=ye.get(c);(!y||!y.parent&&y.canReuseDOM(u))&&u.reuseDOM(c)}u.sync(e,t),u.flags&=-8}if(c=r?r.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&c!=u.dom&&(t.written=!0),u.dom.parentNode==n)for(;c&&c!=u.dom;)c=ke(c);else n.insertBefore(u.dom,c);r=u.dom}for(c=r?r.nextSibling:n.firstChild,c&&t&&t.node==n&&(t.written=!0);c;)c=ke(c)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let r=pt(e)==0?0:t==0?-1:1;for(;;){let c=e.parentNode;if(c==this.dom)break;r==0&&c.firstChild!=c.lastChild&&(e==c.firstChild?r=-1:r=1),e=c}r<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!ye.get(n);)n=n.nextSibling;if(!n)return this.length;for(let r=0,c=0;;r++){let u=this.children[r];if(u.dom==n)return c;c+=u.length+u.breakAfter}}domBoundsAround(e,t,n=0){let r=-1,c=-1,u=-1,y=-1;for(let b=0,M=n,A=n;b<this.children.length;b++){let F=this.children[b],$=M+F.length;if(M<e&&$>t)return F.domBoundsAround(e,t,M);if($>=e&&r==-1&&(r=b,c=M),M>t&&F.dom.parentNode==this.dom){u=b,y=A;break}A=$,M=$+F.breakAfter}return{from:c,to:y<0?n+this.length:y,startDOM:(r?this.children[r-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=oe){this.markDirty();for(let r=e;r<t;r++){let c=this.children[r];c.parent==this&&n.indexOf(c)<0&&c.destroy()}this.children.splice(e,t-e,...n);for(let r=0;r<n.length;r++)n[r].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new Me(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,r,c,u){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}ye.prototype.breakAfter=0;function ke(s){let e=s.nextSibling;return s.parentNode.removeChild(s),e}class Me{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Fe(s,e,t,n,r,c,u,y,b){let{children:M}=s,A=M.length?M[e]:null,F=c.length?c[c.length-1]:null,$=F?F.breakAfter:u;if(!(e==n&&A&&!u&&!$&&c.length<2&&A.merge(t,r,c.length?F:null,t==0,y,b))){if(n<M.length){let X=M[n];X&&(r<X.length||X.breakAfter&&(F!=null&&F.breakAfter))?(e==n&&(X=X.split(r),r=0),!$&&F&&X.merge(0,r,F,!0,0,b)?c[c.length-1]=X:((r||X.children.length&&!X.children[0].length)&&X.merge(0,r,null,!1,0,b),c.push(X))):X!=null&&X.breakAfter&&(F?F.breakAfter=1:u=1),n++}for(A&&(A.breakAfter=u,t>0&&(!u&&c.length&&A.merge(t,A.length,c[0],!1,y,0)?A.breakAfter=c.shift().breakAfter:(t<A.length||A.children.length&&A.children[A.children.length-1].length==0)&&A.merge(t,A.length,null,!1,y,0),e++));e<n&&c.length;)if(M[n-1].become(c[c.length-1]))n--,c.pop(),b=c.length?0:y;else if(M[e].become(c[0]))e++,c.shift(),y=c.length?0:b;else break;!c.length&&e&&n<M.length&&!M[e-1].breakAfter&&M[n].merge(0,0,M[e-1],!1,y,b)&&e--,(e<n||c.length)&&s.replaceChildren(e,n,c)}}function Dt(s,e,t,n,r,c){let u=s.childCursor(),{i:y,off:b}=u.findPos(t,1),{i:M,off:A}=u.findPos(e,-1),F=e-t;for(let $ of n)F+=$.length;s.length+=F,Fe(s,M,A,y,b,n,0,r,c)}let lt=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},Qt=typeof document!="undefined"?document:{documentElement:{style:{}}};const et=/Edge\/(\d+)/.exec(lt.userAgent),Li=/MSIE \d/.test(lt.userAgent),Rt=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(lt.userAgent),kt=!!(Li||Rt||et),_t=!kt&&/gecko\/(\d+)/i.test(lt.userAgent),Xi=!kt&&/Chrome\/(\d+)/.exec(lt.userAgent),hn="webkitFontSmoothing"in Qt.documentElement.style,ie=!kt&&/Apple Computer/.test(lt.vendor),w=ie&&(/Mobile\/\w+/.test(lt.userAgent)||lt.maxTouchPoints>2);var C={mac:w||/Mac/.test(lt.platform),windows:/Win/.test(lt.platform),linux:/Linux|X11/.test(lt.platform),ie:kt,ie_version:Li?Qt.documentMode||6:Rt?+Rt[1]:et?+et[1]:0,gecko:_t,gecko_version:_t?+(/Firefox\/(\d+)/.exec(lt.userAgent)||[0,0])[1]:0,chrome:!!Xi,chrome_version:Xi?+Xi[1]:0,ios:w,android:/Android\b/.test(lt.userAgent),webkit:hn,safari:ie,webkit_version:hn?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Qt.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const N=256;class I extends ye{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof I)||this.length-(t-e)+n.length>N||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new I(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Xe(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return ee(this.dom,e,t)}}class Z extends ye{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let r of t)r.setParent(this)}setAttrs(e){if(Si(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,r,c,u){return n&&(!(n instanceof Z&&n.mark.eq(this.mark))||e&&c<=0||t<this.length&&u<=0)?!1:(Dt(this,e,t,n?n.children.slice():[],c-1,u-1),this.markDirty(),!0)}split(e){let t=[],n=0,r=-1,c=0;for(let y of this.children){let b=n+y.length;b>e&&t.push(n<e?y.split(e-n):y),r<0&&n>=e&&(r=c),n=b,c++}let u=this.length-e;return this.length=e,r>-1&&(this.children.length=r,this.markDirty()),new Z(this.mark,t,u)}domAtPos(e){return He(this,e)}coordsAt(e,t){return Je(this,e,t)}}function ee(s,e,t){let n=s.nodeValue.length;e>n&&(e=n);let r=e,c=e,u=0;e==0&&t<0||e==n&&t>=0?C.chrome||C.gecko||(e?(r--,u=1):c<n&&(c++,u=-1)):t<0?r--:c<n&&c++;let y=ct(s,r,c).getClientRects();if(!y.length)return null;let b=y[(u?u<0:t>=0)?0:y.length-1];return C.safari&&!u&&b.width==0&&(b=Array.prototype.find.call(y,M=>M.width)||b),u?Kt(b,u<0):b||null}class se extends ye{static create(e,t,n){return new se(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=se.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,n,r,c,u){return n&&(!(n instanceof se)||!this.widget.compare(n.widget)||e>0&&c<=0||t<this.length&&u<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof se&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return p.xv.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,r=this.posAtStart;return n?n.slice(r,r+this.length):p.xv.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Xe.before(this.dom):Xe.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let r=this.dom.getClientRects(),c=null;if(!r.length)return null;let u=this.side?this.side<0:e>0;for(let y=u?r.length-1:0;c=r[y],!(e>0?y==0:y==r.length-1||c.top<c.bottom);y+=u?-1:1);return Kt(c,!u)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class xe extends ye{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof xe&&e.side==this.side}split(){return new xe(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Xe.before(this.dom):Xe.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return p.xv.empty}get isHidden(){return!0}}I.prototype.children=se.prototype.children=xe.prototype.children=oe;function He(s,e){let t=s.dom,{children:n}=s,r=0;for(let c=0;r<n.length;r++){let u=n[r],y=c+u.length;if(!(y==c&&u.getSide()<=0)){if(e>c&&e<y&&u.dom.parentNode==t)return u.domAtPos(e-c);if(e<=c)break;c=y}}for(let c=r;c>0;c--){let u=n[c-1];if(u.dom.parentNode==t)return u.domAtPos(u.length)}for(let c=r;c<n.length;c++){let u=n[c];if(u.dom.parentNode==t)return u.domAtPos(0)}return new Xe(t,0)}function Oe(s,e,t){let n,{children:r}=s;t>0&&e instanceof Z&&r.length&&(n=r[r.length-1])instanceof Z&&n.mark.eq(e.mark)?Oe(n,e.children[0],t-1):(r.push(e),e.setParent(s)),s.length+=e.length}function Je(s,e,t){let n=null,r=-1,c=null,u=-1;function y(M,A){for(let F=0,$=0;F<M.children.length&&$<=A;F++){let X=M.children[F],_=$+X.length;_>=A&&(X.children.length?y(X,A-$):(!c||c.isHidden&&t>0)&&(_>A||$==_&&X.getSide()>0)?(c=X,u=A-$):($<A||$==_&&X.getSide()<0&&!X.isHidden)&&(n=X,r=A-$)),$=_}}y(s,e);let b=(t<0?n:c)||n||c;return b?b.coordsAt(Math.max(0,b==n?r:u),t):tt(s)}function tt(s){let e=s.dom.lastChild;if(!e)return s.dom.getBoundingClientRect();let t=mt(e);return t[t.length-1]||null}function rt(s,e){for(let t in s)t=="class"&&e.class?e.class+=" "+s.class:t=="style"&&e.style?e.style+=";"+s.style:e[t]=s[t];return e}const ei=Object.create(null);function ci(s,e,t){if(s==e)return!0;s||(s=ei),e||(e=ei);let n=Object.keys(s),r=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=r.length-(t&&r.indexOf(t)>-1?1:0))return!1;for(let c of n)if(c!=t&&(r.indexOf(c)==-1||s[c]!==e[c]))return!1;return!0}function Vt(s,e,t){let n=!1;if(e)for(let r in e)t&&r in t||(n=!0,r=="style"?s.style.cssText="":s.removeAttribute(r));if(t)for(let r in t)e&&e[r]==t[r]||(n=!0,r=="style"?s.style.cssText=t[r]:s.setAttribute(r,t[r]));return n}function zt(s){let e=Object.create(null);for(let t=0;t<s.attributes.length;t++){let n=s.attributes[t];e[n.name]=n.value}return e}class Ct extends ye{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,r,c,u){if(n){if(!(n instanceof Ct))return!1;this.dom||n.transferDOM(this)}return r&&this.setDeco(n?n.attrs:null),Dt(this,e,t,n?n.children.slice():[],c,u),!0}split(e){let t=new Ct;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:r}=this.childPos(e);r&&(t.append(this.children[n].split(r),0),this.children[n].merge(r,this.children[n].length,null,!1,0,0),n++);for(let c=n;c<this.children.length;c++)t.append(this.children[c],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){ci(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Oe(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=rt(t,this.attrs||{})),n&&(this.attrs=rt({class:n},this.attrs||{}))}domAtPos(e){return He(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(Si(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Vt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let r=this.dom.lastChild;for(;r&&ye.get(r)instanceof Z;)r=r.lastChild;if(!r||!this.length||r.nodeName!="BR"&&((n=ye.get(r))===null||n===void 0?void 0:n.isEditable)==!1&&(!C.ios||!this.children.some(c=>c instanceof I))){let c=document.createElement("BR");c.cmIgnore=!0,this.dom.appendChild(c)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof I)||/[^ -~]/.test(n.text))return null;let r=mt(n.dom);if(r.length!=1)return null;e+=r[0].width,t=r[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=Je(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:r}=this.parent.view.viewState,c=n.bottom-n.top;if(Math.abs(c-r.lineHeight)<2&&r.textHeight<c){let u=(c-r.textHeight)/2;return{top:n.top+u,bottom:n.bottom-u,left:n.left,right:n.left}}}return n}become(e){return!1}covers(){return!0}static find(e,t){for(let n=0,r=0;n<e.children.length;n++){let c=e.children[n],u=r+c.length;if(u>=t){if(c instanceof Ct)return c;if(u>t)break}r=u+c.breakAfter}return null}}class Bt extends ye{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,r,c,u){return n&&(!(n instanceof Bt)||!this.widget.compare(n.widget)||e>0&&c<=0||t<this.length&&u<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Xe.before(this.dom):Xe.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Bt(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return oe}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):p.xv.empty}domBoundsAround(){return null}become(e){return e instanceof Bt&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class Ci{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}destroy(e){}}var it=function(s){return s[s.Text=0]="Text",s[s.WidgetBefore=1]="WidgetBefore",s[s.WidgetAfter=2]="WidgetAfter",s[s.WidgetRange=3]="WidgetRange",s}(it||(it={}));class Ye extends p.uU{constructor(e,t,n,r){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=r}get heightRelevant(){return!1}static mark(e){return new We(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new st(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,r;if(e.isBlockGap)n=-5e8,r=4e8;else{let{start:c,end:u}=ot(e,t);n=(c?t?-3e8:-1:5e8)-1,r=(u?t?2e8:1:-6e8)+1}return new st(e,n,r,t,e.widget||null,!0)}static line(e){return new Ut(e)}static set(e,t=!1){return p.Xs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ye.none=p.Xs.empty;class We extends Ye{constructor(e){let{start:t,end:n}=ot(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof We&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&ci(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}We.prototype.point=!1;class Ut extends Ye{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Ut&&this.spec.class==e.spec.class&&ci(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Ut.prototype.mapMode=p.gc.TrackBefore,Ut.prototype.point=!0;class st extends Ye{constructor(e,t,n,r,c,u){super(t,n,c,e),this.block=r,this.isReplace=u,this.mapMode=r?t<=0?p.gc.TrackBefore:p.gc.TrackAfter:p.gc.TrackDel}get type(){return this.startSide!=this.endSide?it.WidgetRange:this.startSide<=0?it.WidgetBefore:it.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof st&&gt(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}st.prototype.point=!0;function ot(s,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=s;return t==null&&(t=s.inclusive),n==null&&(n=s.inclusive),{start:t!=null?t:e,end:n!=null?n:e}}function gt(s,e){return s==e||!!(s&&e&&s.compare(e))}function at(s,e,t,n=0){let r=t.length-1;r>=0&&t[r]+n>=s?t[r]=Math.max(t[r],e):t.push(s,e)}class Lt{constructor(e,t,n,r){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=r,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Bt&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ct),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append($t(new xe(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Bt)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:c,lineBreak:u,done:y}=this.cursor.next(this.skip);if(this.skip=0,y)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=c,this.textOff=0}let r=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append($t(new I(this.text.slice(this.textOff,this.textOff+r)),t),n),this.atCursorPos=!0,this.textOff+=r,e-=r,n=0}}span(e,t,n,r){this.buildText(t-e,n,r),this.pos=t,this.openStart<0&&(this.openStart=r)}point(e,t,n,r,c,u){if(this.disallowBlockEffectsFor[u]&&n instanceof st){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let y=t-e;if(n instanceof st)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Bt(n.widget||new qe("div"),y,n));else{let b=se.create(n.widget||new qe("span"),y,y?0:n.startSide),M=this.atCursorPos&&!b.isEditable&&c<=r.length&&(e<t||n.startSide>0),A=!b.isEditable&&(e<t||c>r.length||n.startSide<=0),F=this.getLine();this.pendingBuffer==2&&!M&&!b.isEditable&&(this.pendingBuffer=0),this.flushBuffer(r),M&&(F.append($t(new xe(1),r),c),c=r.length+Math.max(0,c-r.length)),F.append($t(b,r),c),this.atCursorPos=A,this.pendingBuffer=A?e<t||c>r.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=r.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);y&&(this.textOff+y<=this.text.length?this.textOff+=y:(this.skip+=y-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=c)}static build(e,t,n,r,c){let u=new Lt(e,t,n,c);return u.openEnd=p.Xs.spans(r,t,n,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function $t(s,e){for(let t of e)s=new Z(t,[s],s.length);return s}class qe extends Ci{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const Vi=p.r$.define(),fi=p.r$.define(),vi=p.r$.define(),tn=p.r$.define(),Ti=p.r$.define(),Ht=p.r$.define(),Ni=p.r$.define(),zi=p.r$.define({combine:s=>s.some(e=>e)}),Yi=p.r$.define({combine:s=>s.some(e=>e)});class $i{constructor(e,t="nearest",n="nearest",r=5,c=5,u=!1){this.range=e,this.y=t,this.x=n,this.yMargin=r,this.xMargin=c,this.isSnapshot=u}map(e){return e.empty?this:new $i(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new $i(p.jT.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const nn=p.Py.define({map:(s,e)=>s.map(e)});function si(s,e,t){let n=s.facet(tn);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Zi=p.r$.define({combine:s=>s.length?s[0]:!0});let $n=0;const cn=p.r$.define();class di{constructor(e,t,n,r,c){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=r,this.extension=c(this)}static define(e,t){const{eventHandlers:n,eventObservers:r,provide:c,decorations:u}=t||{};return new di($n++,e,n,r,y=>{let b=[cn.of(y)];return u&&b.push(Fn.of(M=>{let A=M.plugin(y);return A?u(A):Ye.none})),c&&b.push(c(y)),b})}static fromClass(e,t){return di.define(n=>new e(n),t)}}class Nn{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(si(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){si(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){si(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const On=p.r$.define(),qn=p.r$.define(),Fn=p.r$.define(),R=p.r$.define(),a=p.r$.define();function d(s,e,t){let n=s.state.facet(a);if(!n.length)return n;let r=n.map(u=>u instanceof Function?u(s):u),c=[];return p.Xs.spans(r,e,t,{point(){},span(u,y,b,M){let A=c;for(let F=b.length-1;F>=0;F--,M--){let $=b[F].spec.bidiIsolate,X;if($!=null)if(M>0&&A.length&&(X=A[A.length-1]).to==u&&X.direction==$)X.to=y,A=X.inner;else{let _={from:u,to:y,direction:$,inner:[]};A.push(_),A=_.inner}}}}),c}const v=p.r$.define();function x(s){let e=0,t=0,n=0,r=0;for(let c of s.state.facet(v)){let u=c(s);u&&(u.left!=null&&(e=Math.max(e,u.left)),u.right!=null&&(t=Math.max(t,u.right)),u.top!=null&&(n=Math.max(n,u.top)),u.bottom!=null&&(r=Math.max(r,u.bottom)))}return{left:e,right:t,top:n,bottom:r}}const E=p.r$.define();class D{constructor(e,t,n,r){this.fromA=e,this.toA=t,this.fromB=n,this.toB=r}join(e){return new D(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let r=e[t-1];if(!(r.fromA>n.toA)){if(r.toA<n.fromA)break;n=n.join(r),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let r=0,c=0,u=0,y=0;;r++){let b=r==e.length?null:e[r],M=u-y,A=b?b.fromB:1e9;for(;c<t.length&&t[c]<A;){let F=t[c],$=t[c+1],X=Math.max(y,F),_=Math.min(A,$);if(X<=_&&new D(X+M,_+M,X,_).addToSet(n),$>A)break;c+=2}if(!b)return n;new D(b.fromA,b.toA,b.fromB,b.toB).addToSet(n),u=b.toA,y=b.toB}}}class V{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=p.as.empty(this.startState.doc.length);for(let c of n)this.changes=this.changes.compose(c.changes);let r=[];this.changes.iterChangedRanges((c,u,y,b)=>r.push(new D(c,u,y,b))),this.changedRanges=r}static create(e,t,n){return new V(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var j=function(s){return s[s.LTR=0]="LTR",s[s.RTL=1]="RTL",s}(j||(j={}));const ne=j.LTR,fe=j.RTL;function ve(s){let e=[];for(let t=0;t<s.length;t++)e.push(1<<+s[t]);return e}const Le=ve("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Pe=ve("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Gt=Object.create(null),pi=[];for(let s of["()","[]","{}"]){let e=s.charCodeAt(0),t=s.charCodeAt(1);Gt[e]=t,Gt[t]=-e}function bi(s){return s<=247?Le[s]:1424<=s&&s<=1524?2:1536<=s&&s<=1785?Pe[s-1536]:1774<=s&&s<=2220?4:8192<=s&&s<=8204?256:64336<=s&&s<=65023?4:1}const jn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class mn{get dir(){return this.level%2?fe:ne}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,n,r){let c=-1;for(let u=0;u<e.length;u++){let y=e[u];if(y.from<=t&&y.to>=t){if(y.level==n)return u;(c<0||(r!=0?r<0?y.from<t:y.to>t:e[c].level>y.level))&&(c=u)}}if(c<0)throw new RangeError("Index out of range");return c}}function Pn(s,e){if(s.length!=e.length)return!1;for(let t=0;t<s.length;t++){let n=s[t],r=e[t];if(n.from!=r.from||n.to!=r.to||n.direction!=r.direction||!Pn(n.inner,r.inner))return!1}return!0}const qt=[];function Rr(s,e,t,n,r){for(let c=0;c<=n.length;c++){let u=c?n[c-1].to:e,y=c<n.length?n[c].from:t,b=c?256:r;for(let M=u,A=b,F=b;M<y;M++){let $=bi(s.charCodeAt(M));$==512?$=A:$==8&&F==4&&($=16),qt[M]=$==4?2:$,$&7&&(F=$),A=$}for(let M=u,A=b,F=b;M<y;M++){let $=qt[M];if($==128)M<y-1&&A==qt[M+1]&&A&24?$=qt[M]=A:qt[M]=256;else if($==64){let X=M+1;for(;X<y&&qt[X]==64;)X++;let _=M&&A==8||X<t&&qt[X]==8?F==1?1:8:256;for(let le=M;le<X;le++)qt[le]=_;M=X-1}else $==8&&F==1&&(qt[M]=1);A=$,$&7&&(F=$)}}}function Br(s,e,t,n,r){let c=r==1?2:1;for(let u=0,y=0,b=0;u<=n.length;u++){let M=u?n[u-1].to:e,A=u<n.length?n[u].from:t;for(let F=M,$,X,_;F<A;F++)if(X=Gt[$=s.charCodeAt(F)])if(X<0){for(let le=y-3;le>=0;le-=3)if(pi[le+1]==-X){let re=pi[le+2],pe=re&2?r:re&4?re&1?c:r:0;pe&&(qt[F]=qt[pi[le]]=pe),y=le;break}}else{if(pi.length==189)break;pi[y++]=F,pi[y++]=$,pi[y++]=b}else if((_=qt[F])==2||_==1){let le=_==r;b=le?0:1;for(let re=y-3;re>=0;re-=3){let pe=pi[re+2];if(pe&2)break;if(le)pi[re+2]|=2;else{if(pe&4)break;pi[re+2]|=4}}}}}function Jr(s,e,t,n){for(let r=0,c=n;r<=t.length;r++){let u=r?t[r-1].to:s,y=r<t.length?t[r].from:e;for(let b=u;b<y;){let M=qt[b];if(M==256){let A=b+1;for(;;)if(A==y){if(r==t.length)break;A=t[r++].to,y=r<t.length?t[r].from:e}else if(qt[A]==256)A++;else break;let F=c==1,$=(A<e?qt[A]:n)==1,X=F==$?F?1:2:n;for(let _=A,le=r,re=le?t[le-1].to:s;_>b;)_==re&&(_=t[--le].from,re=le?t[le-1].to:s),qt[--_]=X;b=A}else c=M,b++}}}function dr(s,e,t,n,r,c,u){let y=n%2?2:1;if(n%2==r%2)for(let b=e,M=0;b<t;){let A=!0,F=!1;if(M==c.length||b<c[M].from){let le=qt[b];le!=y&&(A=!1,F=le==16)}let $=!A&&y==1?[]:null,X=A?n:n+1,_=b;e:for(;;)if(M<c.length&&_==c[M].from){if(F)break e;let le=c[M];if(!A)for(let re=le.to,pe=M+1;;){if(re==t)break e;if(pe<c.length&&c[pe].from==re)re=c[pe++].to;else{if(qt[re]==y)break e;break}}if(M++,$)$.push(le);else{le.from>b&&u.push(new mn(b,le.from,X));let re=le.direction==ne!=!(X%2);Lr(s,re?n+1:n,r,le.inner,le.from,le.to,u),b=le.to}_=le.to}else{if(_==t||(A?qt[_]!=y:qt[_]==y))break;_++}$?dr(s,b,_,n+1,r,$,u):b<_&&u.push(new mn(b,_,X)),b=_}else for(let b=t,M=c.length;b>e;){let A=!0,F=!1;if(!M||b>c[M-1].to){let le=qt[b-1];le!=y&&(A=!1,F=le==16)}let $=!A&&y==1?[]:null,X=A?n:n+1,_=b;e:for(;;)if(M&&_==c[M-1].to){if(F)break e;let le=c[--M];if(!A)for(let re=le.from,pe=M;;){if(re==e)break e;if(pe&&c[pe-1].to==re)re=c[--pe].from;else{if(qt[re-1]==y)break e;break}}if($)$.push(le);else{le.to<b&&u.push(new mn(le.to,b,X));let re=le.direction==ne!=!(X%2);Lr(s,re?n+1:n,r,le.inner,le.from,le.to,u),b=le.from}_=le.from}else{if(_==e||(A?qt[_-1]!=y:qt[_-1]==y))break;_--}$?dr(s,_,b,n+1,r,$,u):_<b&&u.push(new mn(_,b,X)),b=_}}function Lr(s,e,t,n,r,c,u){let y=e%2?2:1;Rr(s,r,c,n,y),Br(s,r,c,n,y),Jr(r,c,n,y),dr(s,r,c,e,t,n,u)}function pr(s,e,t){if(!s)return[new mn(0,0,e==fe?1:0)];if(e==ne&&!t.length&&!jn.test(s))return Rn(s.length);if(t.length)for(;s.length>qt.length;)qt[qt.length]=256;let n=[],r=e==ne?0:1;return Lr(s,r,r,t,0,s.length,n),n}function Rn(s){return[new mn(0,s,0)]}let Qn="";function O(s,e,t,n,r){var c;let u=n.head-s.from,y=-1;if(u==0){if(!r||!s.length)return null;e[0].level!=t&&(u=e[0].side(!1,t),y=0)}else if(u==s.length){if(r)return null;let $=e[e.length-1];$.level!=t&&(u=$.side(!0,t),y=e.length-1)}y<0&&(y=mn.find(e,u,(c=n.bidiLevel)!==null&&c!==void 0?c:-1,n.assoc));let b=e[y];u==b.side(r,t)&&(b=e[y+=r?1:-1],u=b.side(!r,t));let M=r==(b.dir==t),A=(0,p.cp)(s.text,u,M);if(Qn=s.text.slice(Math.min(u,A),Math.max(u,A)),A>b.from&&A<b.to)return p.jT.cursor(A+s.from,M?-1:1,b.level);let F=y==(r?e.length-1:0)?null:e[y+(r?1:-1)];return!F&&b.level!=t?p.jT.cursor(r?s.to:s.from,r?-1:1,t):F&&F.level<b.level?p.jT.cursor(F.side(!r,t)+s.from,r?1:-1,F.level):p.jT.cursor(A+s.from,r?-1:1,b.level)}class g extends ye{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ct],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new D(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:M,toA:A})=>A<this.minWidthFrom||M>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let r=-1;this.view.inputState.composing>=0&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?r=this.domChanged.newSel.head:!jt(e.changes,this.hasComposition)&&!e.selectionSet&&(r=e.state.selection.main.head));let c=r>-1?K(this.view,e.changes,r):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:M,to:A}=this.hasComposition;n=new D(M,A,e.changes.mapPos(M,-1),e.changes.mapPos(A,1)).addToSet(n.slice())}this.hasComposition=c?{from:c.range.fromB,to:c.range.toB}:null,(C.ie||C.chrome)&&!c&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let u=this.decorations,y=this.updateDeco(),b=Ee(u,y,e.changes);return n=D.extendWithRanges(n,b),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,c),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:r}=this.view;r.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let u=C.chrome||C.ios?{node:r.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,u),this.flags&=-8,u&&(u.written||r.selectionRange.focusNode!=u.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(u=>u.flags&=-9);let c=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let u of this.children)u instanceof Bt&&u.widget instanceof P&&c.push(u.dom);r.updateGaps(c)}updateChildren(e,t,n){let r=n?n.range.addToSet(e.slice()):e,c=this.childCursor(t);for(let u=r.length-1;;u--){let y=u>=0?r[u]:null;if(!y)break;let{fromA:b,toA:M,fromB:A,toB:F}=y,$,X,_,le;if(n&&n.range.fromB<F&&n.range.toB>A){let Ke=Lt.build(this.view.state.doc,A,n.range.fromB,this.decorations,this.dynamicDecorationMap),ht=Lt.build(this.view.state.doc,n.range.toB,F,this.decorations,this.dynamicDecorationMap);X=Ke.breakAtStart,_=Ke.openStart,le=ht.openEnd;let St=this.compositionView(n);ht.breakAtStart?St.breakAfter=1:ht.content.length&&St.merge(St.length,St.length,ht.content[0],!1,ht.openStart,0)&&(St.breakAfter=ht.content[0].breakAfter,ht.content.shift()),Ke.content.length&&St.merge(0,0,Ke.content[Ke.content.length-1],!0,0,Ke.openEnd)&&Ke.content.pop(),$=Ke.content.concat(St).concat(ht.content)}else({content:$,breakAtStart:X,openStart:_,openEnd:le}=Lt.build(this.view.state.doc,A,F,this.decorations,this.dynamicDecorationMap));let{i:re,off:pe}=c.findPos(M,1),{i:Ze,off:ft}=c.findPos(b,-1);Fe(this,Ze,ft,re,pe,$,X,_,le)}n&&this.fixCompositionDOM(n)}compositionView(e){let t=new I(e.text.nodeValue);t.flags|=8;for(let{deco:r}of e.marks)t=new Z(r,[t],t.length);let n=new Ct;return n.append(t,0),n}fixCompositionDOM(e){let t=(c,u)=>{u.flags|=8|(u.children.some(b=>b.flags&7)?1:0),this.markedForComposition.add(u);let y=ye.get(c);y&&y!=u&&(y.dom=null),u.setDOM(c)},n=this.childPos(e.range.fromB,1),r=this.children[n.i];t(e.line,r);for(let c=e.marks.length-1;c>=-1;c--)n=r.childPos(n.off,1),r=r.children[n.i],t(c>=0?e.marks[c].node:e.text,r)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,r=n==this.dom,c=!r&&_e(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(r||t||c))return;let u=this.forceSelection;this.forceSelection=!1;let y=this.view.state.selection.main,b=this.moveToLine(this.domAtPos(y.anchor)),M=y.empty?b:this.moveToLine(this.domAtPos(y.head));if(C.gecko&&y.empty&&!this.hasComposition&&S(b)){let F=document.createTextNode("");this.view.observer.ignore(()=>b.node.insertBefore(F,b.node.childNodes[b.offset]||null)),b=M=new Xe(F,0),u=!0}let A=this.view.observer.selectionRange;(u||!A.focusNode||!yi(b.node,b.offset,A.anchorNode,A.anchorOffset)||!yi(M.node,M.offset,A.focusNode,A.focusOffset))&&(this.view.observer.ignore(()=>{C.android&&C.chrome&&this.dom.contains(A.focusNode)&&Ve(A.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let F=bt(this.view.root);if(F)if(y.empty){if(C.gecko){let $=ce(b.node,b.offset);if($&&$!=3){let X=U(b.node,b.offset,$==1?1:-1);X&&(b=new Xe(X.node,X.offset))}}F.collapse(b.node,b.offset),y.bidiLevel!=null&&F.caretBidiLevel!==void 0&&(F.caretBidiLevel=y.bidiLevel)}else if(F.extend){F.collapse(b.node,b.offset);try{F.extend(M.node,M.offset)}catch{}}else{let $=document.createRange();y.anchor>y.head&&([b,M]=[M,b]),$.setEnd(M.node,M.offset),$.setStart(b.node,b.offset),F.removeAllRanges(),F.addRange($)}c&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(b,M)),this.impreciseAnchor=b.precise?null:new Xe(A.anchorNode,A.anchorOffset),this.impreciseHead=M.precise?null:new Xe(A.focusNode,A.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=bt(e.root),{anchorNode:r,anchorOffset:c}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let u=Ct.find(this,t.head);if(!u)return;let y=u.posAtStart;if(t.head==y||t.head==y+u.length)return;let b=this.coordsAt(t.head,-1),M=this.coordsAt(t.head,1);if(!b||!M||b.bottom>M.top)return;let A=this.domAtPos(t.head+t.assoc);n.collapse(A.node,A.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let F=e.observer.selectionRange;e.docView.posFromDOM(F.anchorNode,F.anchorOffset)!=t.from&&n.collapse(r,c)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let r=e.offset;!n&&r<t.childNodes.length;r++){let c=ye.get(t.childNodes[r]);c instanceof Ct&&(n=c.domAtPos(0))}for(let r=e.offset-1;!n&&r>=0;r--){let c=ye.get(t.childNodes[r]);c instanceof Ct&&(n=c.domAtPos(c.length))}return n?new Xe(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=ye.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let r=this.children[t];if(n<r.length||r instanceof Ct)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,r=0;for(let c=this.length,u=this.children.length-1;u>=0;u--){let y=this.children[u],b=c-y.breakAfter,M=b-y.length;if(b<e)break;M<=e&&(M<e||y.covers(-1))&&(b>e||y.covers(1))&&(!n||y instanceof Ct&&!(n instanceof Ct&&t>=0))&&(n=y,r=M),c=M}return n?n.coordsAt(e-r,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),r=this.children[t];if(!(r instanceof Ct))return null;for(;r.children.length;){let{i:y,off:b}=r.childPos(n,1);for(;;y++){if(y==r.children.length)return null;if((r=r.children[y]).length)break}n=b}if(!(r instanceof I))return null;let c=(0,p.cp)(r.text,n);if(c==n)return null;let u=ct(r.dom,n,c).getClientRects();for(let y=0;y<u.length;y++){let b=u[y];if(y==u.length-1||b.top<b.bottom&&b.left<b.right)return b}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:r}=e,c=this.view.contentDOM.clientWidth,u=c>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,y=-1,b=this.view.textDirection==j.LTR;for(let M=0,A=0;A<this.children.length;A++){let F=this.children[A],$=M+F.length;if($>r)break;if(M>=n){let X=F.dom.getBoundingClientRect();if(t.push(X.height),u){let _=F.dom.lastChild,le=_?mt(_):[];if(le.length){let re=le[le.length-1],pe=b?re.right-X.left:X.right-re.left;pe>y&&(y=pe,this.minWidth=c,this.minWidthFrom=M,this.minWidthTo=$)}}}M=$+F.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?j.RTL:j.LTR}measureTextSize(){for(let c of this.children)if(c instanceof Ct){let u=c.measureTextSize();if(u)return u}let e=document.createElement("div"),t,n,r;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let c=mt(e.firstChild)[0];t=e.getBoundingClientRect().height,n=c?c.width/27:7,r=c?c.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:r}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new Me(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,r=0;;r++){let c=r==t.viewports.length?null:t.viewports[r],u=c?c.from-1:this.length;if(u>n){let y=(t.lineBlockAt(u).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(Ye.replace({widget:new P(y),block:!0,inclusive:!0,isBlockGap:!0}).range(n,u))}if(!c)break;n=c.to+1}return Ye.set(e)}updateDeco(){let e=this.view.state.facet(Fn).map((t,n)=>(this.dynamicDecorationMap[n]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){if(e.isSnapshot){let M=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=M.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),r;if(!n)return;!t.empty&&(r=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,r.left),top:Math.min(n.top,r.top),right:Math.max(n.right,r.right),bottom:Math.max(n.bottom,r.bottom)});let c=x(this.view),u={left:n.left-c.left,top:n.top-c.top,right:n.right+c.right,bottom:n.bottom+c.bottom},{offsetWidth:y,offsetHeight:b}=this.view.scrollDOM;Et(this.view.scrollDOM,u,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,y),-y),Math.max(Math.min(e.yMargin,b),-b),this.view.textDirection==j.LTR)}}function S(s){return s.node.nodeType==1&&s.node.firstChild&&(s.offset==0||s.node.childNodes[s.offset-1].contentEditable=="false")&&(s.offset==s.node.childNodes.length||s.node.childNodes[s.offset].contentEditable=="false")}class P extends Ci{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function W(s,e){let t=s.observer.selectionRange,n=t.focusNode&&U(t.focusNode,t.focusOffset,0);if(!n)return null;let r=e-n.offset;return{from:r,to:r+n.node.nodeValue.length,node:n.node}}function K(s,e,t){let n=W(s,t);if(!n)return null;let{node:r,from:c,to:u}=n,y=r.nodeValue;if(/[\n\r]/.test(y)||s.state.doc.sliceString(n.from,n.to)!=y)return null;let b=e.invertedDesc,M=new D(b.mapPos(c),b.mapPos(u),c,u),A=[];for(let F=r.parentNode;;F=F.parentNode){let $=ye.get(F);if($ instanceof Z)A.push({node:F,deco:$.mark});else{if($ instanceof Ct||F.nodeName=="DIV"&&F.parentNode==s.contentDOM)return{range:M,text:r,marks:A,line:F};if(F!=s.contentDOM)A.push({node:F,deco:new We({inclusive:!0,attributes:zt(F),tagName:F.tagName.toLowerCase()})});else return null}}}function U(s,e,t){if(t<=0)for(let n=s,r=e;;){if(n.nodeType==3)return{node:n,offset:r};if(n.nodeType==1&&r>0)n=n.childNodes[r-1],r=pt(n);else break}if(t>=0)for(let n=s,r=e;;){if(n.nodeType==3)return{node:n,offset:r};if(n.nodeType==1&&r<n.childNodes.length&&t>=0)n=n.childNodes[r],r=0;else break}return null}function ce(s,e){return s.nodeType!=1?0:(e&&s.childNodes[e-1].contentEditable=="false"?1:0)|(e<s.childNodes.length&&s.childNodes[e].contentEditable=="false"?2:0)}let ae=class{constructor(){this.changes=[]}compareRange(e,t){at(e,t,this.changes)}comparePoint(e,t){at(e,t,this.changes)}};function Ee(s,e,t){let n=new ae;return p.Xs.compare(s,e,t,n),n.changes}function Ve(s,e){for(let t=s;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function jt(s,e){let t=!1;return e&&s.iterChangedRanges((n,r)=>{n<e.to&&r>e.from&&(t=!0)}),t}function Ki(s,e,t=1){let n=s.charCategorizer(e),r=s.doc.lineAt(e),c=e-r.from;if(r.length==0)return p.jT.cursor(e);c==0?t=1:c==r.length&&(t=-1);let u=c,y=c;t<0?u=(0,p.cp)(r.text,c,!1):y=(0,p.cp)(r.text,c);let b=n(r.text.slice(u,y));for(;u>0;){let M=(0,p.cp)(r.text,u,!1);if(n(r.text.slice(M,u))!=b)break;u=M}for(;y<r.length;){let M=(0,p.cp)(r.text,y);if(n(r.text.slice(y,M))!=b)break;y=M}return p.jT.range(u+r.from,y+r.from)}function Oi(s,e){return e.left>s?e.left-s:Math.max(0,s-e.right)}function gn(s,e){return e.top>s?e.top-s:Math.max(0,s-e.bottom)}function Cn(s,e){return s.top<e.bottom-1&&s.bottom>e.top+1}function It(s,e){return e<s.top?{top:e,left:s.left,right:s.right,bottom:s.bottom}:s}function qi(s,e){return e>s.bottom?{top:s.top,left:s.left,right:s.right,bottom:e}:s}function yn(s,e,t){let n,r,c,u,y=!1,b,M,A,F;for(let _=s.firstChild;_;_=_.nextSibling){let le=mt(_);for(let re=0;re<le.length;re++){let pe=le[re];r&&Cn(r,pe)&&(pe=It(qi(pe,r.bottom),r.top));let Ze=Oi(e,pe),ft=gn(t,pe);if(Ze==0&&ft==0)return _.nodeType==3?_n(_,e,t):yn(_,e,t);if(!n||u>ft||u==ft&&c>Ze){n=_,r=pe,c=Ze,u=ft;let Ke=ft?t<pe.top?-1:1:Ze?e<pe.left?-1:1:0;y=!Ke||(Ke>0?re<le.length-1:re>0)}Ze==0?t>pe.bottom&&(!A||A.bottom<pe.bottom)?(b=_,A=pe):t<pe.top&&(!F||F.top>pe.top)&&(M=_,F=pe):A&&Cn(A,pe)?A=qi(A,pe.bottom):F&&Cn(F,pe)&&(F=It(F,pe.top))}}if(A&&A.bottom>=t?(n=b,r=A):F&&F.top<=t&&(n=M,r=F),!n)return{node:s,offset:0};let $=Math.max(r.left,Math.min(r.right,e));if(n.nodeType==3)return _n(n,$,t);if(y&&n.contentEditable!="false")return yn(n,$,t);let X=Array.prototype.indexOf.call(s.childNodes,n)+(e>=(r.left+r.right)/2?1:0);return{node:s,offset:X}}function _n(s,e,t){let n=s.nodeValue.length,r=-1,c=1e9,u=0;for(let y=0;y<n;y++){let b=ct(s,y,y+1).getClientRects();for(let M=0;M<b.length;M++){let A=b[M];if(A.top==A.bottom)continue;u||(u=e-A.left);let F=(A.top>t?A.top-t:t-A.bottom)-1;if(A.left-1<=e&&A.right+1>=e&&F<c){let $=e>=(A.left+A.right)/2,X=$;if((C.chrome||C.gecko)&&ct(s,y).getBoundingClientRect().left==A.right&&(X=!$),F<=0)return{node:s,offset:y+(X?1:0)};r=y+(X?1:0),c=F}}}return{node:s,offset:r>-1?r:u>0?s.nodeValue.length:0}}function Zn(s,e,t,n=-1){var r,c;let u=s.contentDOM.getBoundingClientRect(),y=u.top+s.viewState.paddingTop,b,{docHeight:M}=s.viewState,{x:A,y:F}=e,$=F-y;if($<0)return 0;if($>M)return s.state.doc.length;for(let Ke=s.viewState.heightOracle.textHeight/2,ht=!1;b=s.elementAtHeight($),b.type!=it.Text;)for(;$=n>0?b.bottom+Ke:b.top-Ke,!($>=0&&$<=M);){if(ht)return t?null:0;ht=!0,n=-n}F=y+$;let X=b.from;if(X<s.viewport.from)return s.viewport.from==0?0:t?null:fn(s,u,b,A,F);if(X>s.viewport.to)return s.viewport.to==s.state.doc.length?s.state.doc.length:t?null:fn(s,u,b,A,F);let _=s.dom.ownerDocument,le=s.root.elementFromPoint?s.root:_,re=le.elementFromPoint(A,F);re&&!s.contentDOM.contains(re)&&(re=null),re||(A=Math.max(u.left+1,Math.min(u.right-1,A)),re=le.elementFromPoint(A,F),re&&!s.contentDOM.contains(re)&&(re=null));let pe,Ze=-1;if(re&&((r=s.docView.nearest(re))===null||r===void 0?void 0:r.isEditable)!=!1){if(_.caretPositionFromPoint){let Ke=_.caretPositionFromPoint(A,F);Ke&&({offsetNode:pe,offset:Ze}=Ke)}else if(_.caretRangeFromPoint){let Ke=_.caretRangeFromPoint(A,F);Ke&&({startContainer:pe,startOffset:Ze}=Ke,(!s.contentDOM.contains(pe)||C.safari&&mr(pe,Ze,A)||C.chrome&&Ur(pe,Ze,A))&&(pe=void 0))}}if(!pe||!s.docView.dom.contains(pe)){let Ke=Ct.find(s.docView,X);if(!Ke)return $>b.top+b.height/2?b.to:b.from;({node:pe,offset:Ze}=yn(Ke.dom,A,F))}let ft=s.docView.nearest(pe);if(!ft)return null;if(ft.isWidget&&((c=ft.dom)===null||c===void 0?void 0:c.nodeType)==1){let Ke=ft.dom.getBoundingClientRect();return e.y<Ke.top||e.y<=Ke.bottom&&e.x<=(Ke.left+Ke.right)/2?ft.posAtStart:ft.posAtEnd}else return ft.localPosFromDOM(pe,Ze)+ft.posAtStart}function fn(s,e,t,n,r){let c=Math.round((n-e.left)*s.defaultCharacterWidth);if(s.lineWrapping&&t.height>s.defaultLineHeight*1.5){let y=s.viewState.heightOracle.textHeight,b=Math.floor((r-t.top-(s.defaultLineHeight-y)*.5)/y);c+=b*s.viewState.heightOracle.lineLength}let u=s.state.sliceDoc(t.from,t.to);return t.from+(0,p.Gz)(u,c,s.state.tabSize)}function mr(s,e,t){let n;if(s.nodeType!=3||e!=(n=s.nodeValue.length))return!1;for(let r=s.nextSibling;r;r=r.nextSibling)if(r.nodeType!=1||r.nodeName!="BR")return!1;return ct(s,n-1,n).getBoundingClientRect().left>t}function Ur(s,e,t){if(e!=0)return!1;for(let r=s;;){let c=r.parentNode;if(!c||c.nodeType!=1||c.firstChild!=r)return!1;if(c.classList.contains("cm-line"))break;r=c}let n=s.nodeType==1?s.getBoundingClientRect():ct(s,0,Math.max(s.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function er(s,e){let t=s.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==it.Text))return n}return t}function Wn(s,e,t,n){let r=er(s,e.head),c=!n||r.type!=it.Text||!(s.lineWrapping||r.widgetLineBreaks)?null:s.coordsAtPos(e.assoc<0&&e.head>r.from?e.head-1:e.head);if(c){let u=s.dom.getBoundingClientRect(),y=s.textDirectionAt(r.from),b=s.posAtCoords({x:t==(y==j.LTR)?u.right-1:u.left+1,y:(c.top+c.bottom)/2});if(b!=null)return p.jT.cursor(b,t?-1:1)}return p.jT.cursor(t?r.to:r.from,t?-1:1)}function Hn(s,e,t,n){let r=s.state.doc.lineAt(e.head),c=s.bidiSpans(r),u=s.textDirectionAt(r.from);for(let y=e,b=null;;){let M=O(r,c,u,y,t),A=Qn;if(!M){if(r.number==(t?s.state.doc.lines:1))return y;A=`
`,r=s.state.doc.line(r.number+(t?1:-1)),c=s.bidiSpans(r),M=p.jT.cursor(t?r.from:r.to)}if(b){if(!b(A))return y}else{if(!n)return M;b=n(A)}y=M}}function Ir(s,e,t){let n=s.state.charCategorizer(e),r=n(t);return c=>{let u=n(c);return r==p.D0.Space&&(r=u),r==u}}function os(s,e,t,n){let r=e.head,c=t?1:-1;if(r==(t?s.state.doc.length:0))return p.jT.cursor(r,e.assoc);let u=e.goalColumn,y,b=s.contentDOM.getBoundingClientRect(),M=s.coordsAtPos(r,e.assoc||-1),A=s.documentTop;if(M)u==null&&(u=M.left-b.left),y=c<0?M.top:M.bottom;else{let X=s.viewState.lineBlockAt(r);u==null&&(u=Math.min(b.right-b.left,s.defaultCharacterWidth*(r-X.from))),y=(c<0?X.top:X.bottom)+A}let F=b.left+u,$=n!=null?n:s.viewState.heightOracle.textHeight>>1;for(let X=0;;X+=10){let _=y+($+X)*c,le=Zn(s,{x:F,y:_},!1,c);if(_<b.top||_>b.bottom||(c<0?le<r:le>r)){let re=s.docView.coordsForChar(le),pe=!re||_<re.top?-1:1;return p.jT.cursor(le,pe,void 0,u)}}}function Nr(s,e,t){for(;;){let n=0;for(let r of s)r.between(e-1,e+1,(c,u,y)=>{if(e>c&&e<u){let b=n||t||(e-c<u-e?-1:1);e=b<0?c:u,n=b}});if(!n)return e}}function Ms(s,e,t){let n=Nr(s.state.facet(R).map(r=>r(s)),t.from,e.head>t.from?-1:1);return n==t.from?t:p.jT.cursor(n,n<t.from?1:-1)}class io{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,C.safari&&e.contentDOM.addEventListener("input",()=>null),C.gecko&&Ne(e.contentDOM.ownerDocument)}handleEvent(e){!cs(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let r of n.observers)r(this.view,t);for(let r of n.handlers){if(t.defaultPrevented)break;if(r(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=as(e),n=this.handlers,r=this.view.contentDOM;for(let c in t)if(c!="scroll"){let u=!t[c].handlers.length,y=n[c];y&&u!=!y.handlers.length&&(r.removeEventListener(c,this.handleEvent),y=null),y||r.addEventListener(c,this.handleEvent,{passive:u})}for(let c in n)c!="scroll"&&!t[c]&&r.removeEventListener(c,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&Gr.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),C.android&&C.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return C.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=Es.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||hi.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,Yt(this.view.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:C.safari&&!C.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function ls(s,e){return(t,n)=>{try{return e.call(s,n,t)}catch(r){si(t.state,r)}}}function as(s){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of s){let r=n.spec;if(r&&r.domEventHandlers)for(let c in r.domEventHandlers){let u=r.domEventHandlers[c];u&&t(c).handlers.push(ls(n.value,u))}if(r&&r.domEventObservers)for(let c in r.domEventObservers){let u=r.domEventObservers[c];u&&t(c).observers.push(ls(n.value,u))}}for(let n in An)t(n).handlers.push(An[n]);for(let n in rn)t(n).observers.push(rn[n]);return e}const Es=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],hi="dthko",Gr=[16,17,18,20,91,92,224,225],gr=6;function Vn(s){return Math.max(0,s)*.7+8}function Ds(s,e){return Math.max(Math.abs(s.clientX-e.clientX),Math.abs(s.clientY-e.clientY))}class Kn{constructor(e,t,n,r){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=r,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=ii(e.contentDOM),this.atoms=e.state.facet(R).map(u=>u(e));let c=e.contentDOM.ownerDocument;c.addEventListener("mousemove",this.move=this.move.bind(this)),c.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(p.yy.allowMultipleSelections)&&Os(e,t),this.dragging=tr(e,t)&&Fs(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Ds(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,r=0,c=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},u=x(this.view);e.clientX-u.left<=c.left+gr?n=-Vn(c.left-e.clientX):e.clientX+u.right>=c.right-gr&&(n=Vn(e.clientX-c.right)),e.clientY-u.top<=c.top+gr?r=-Vn(c.top-e.clientY):e.clientY+u.bottom>=c.bottom-gr&&(r=Vn(e.clientY-c.bottom)),this.setScrollSpeed(n,r)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let r=e.ranges[n],c=null;if(r.empty){let u=Nr(this.atoms,r.from,0);u!=r.from&&(c=p.jT.cursor(u,-1))}else{let u=Nr(this.atoms,r.from,-1),y=Nr(this.atoms,r.to,1);(u!=r.from||y!=r.to)&&(c=p.jT.range(r.from==r.anchor?u:y,r.from==r.head?u:y))}c&&(t||(t=e.ranges.slice()),t[n]=c)}return t?p.jT.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection)||n.main.assoc!=t.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Os(s,e){let t=s.state.facet(Vi);return t.length?t[0](e):C.mac?e.metaKey:e.ctrlKey}function hs(s,e){let t=s.state.facet(fi);return t.length?t[0](e):C.mac?!e.altKey:!e.ctrlKey}function tr(s,e){let{main:t}=s.state.selection;if(t.empty)return!1;let n=bt(s.root);if(!n||n.rangeCount==0)return!0;let r=n.getRangeAt(0).getClientRects();for(let c=0;c<r.length;c++){let u=r[c];if(u.left<=e.clientX&&u.right>=e.clientX&&u.top<=e.clientY&&u.bottom>=e.clientY)return!0}return!1}function cs(s,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=s.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=ye.get(t))&&n.ignoreEvent(e))return!1;return!0}const An=Object.create(null),rn=Object.create(null),Xr=C.ie&&C.ie_version<15||C.ios&&C.webkit_version<604;function yr(s){let e=s.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{s.focus(),t.remove(),fs(s,t.value)},50)}function fs(s,e){let{state:t}=s,n,r=1,c=t.toText(e),u=c.lines==t.selection.ranges.length;if(Q!=null&&t.selection.ranges.every(b=>b.empty)&&Q==c.toString()){let b=-1;n=t.changeByRange(M=>{let A=t.doc.lineAt(M.from);if(A.from==b)return{range:M};b=A.from;let F=t.toText((u?c.line(r++).text:e)+t.lineBreak);return{changes:{from:A.from,insert:F},range:p.jT.cursor(M.from+F.length)}})}else u?n=t.changeByRange(b=>{let M=c.line(r++);return{changes:{from:b.from,to:b.to,insert:M.text},range:p.jT.cursor(b.from+M.length)}}):n=t.replaceSelection(c);s.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}rn.scroll=s=>{s.inputState.lastScrollTop=s.scrollDOM.scrollTop,s.inputState.lastScrollLeft=s.scrollDOM.scrollLeft},An.keydown=(s,e)=>(s.inputState.setSelectionOrigin("select"),e.keyCode==27&&(s.inputState.lastEscPress=Date.now()),!1),rn.touchstart=(s,e)=>{s.inputState.lastTouchTime=Date.now(),s.inputState.setSelectionOrigin("select.pointer")},rn.touchmove=s=>{s.inputState.setSelectionOrigin("select.pointer")},An.mousedown=(s,e)=>{if(s.observer.flush(),s.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of s.state.facet(vi))if(t=n(s,e),t)break;if(!t&&e.button==0&&(t=no(s,e)),t){let n=!s.hasFocus;s.inputState.startMouseSelection(new Kn(s,e,t,n)),n&&s.observer.ignore(()=>Ot(s.contentDOM));let r=s.inputState.mouseSelection;if(r)return r.start(e),r.dragging===!1}return!1};function Ps(s,e,t,n){if(n==1)return p.jT.cursor(e,t);if(n==2)return Ki(s.state,e,t);{let r=Ct.find(s.docView,e),c=s.state.doc.lineAt(r?r.posAtEnd:e),u=r?r.posAtStart:c.from,y=r?r.posAtEnd:c.to;return y<s.state.doc.length&&y==c.to&&y++,p.jT.range(u,y)}}let Rs=(s,e)=>s>=e.top&&s<=e.bottom,Bs=(s,e,t)=>Rs(e,t)&&s>=t.left&&s<=t.right;function Ls(s,e,t,n){let r=Ct.find(s.docView,e);if(!r)return 1;let c=e-r.posAtStart;if(c==0)return 1;if(c==r.length)return-1;let u=r.coordsAt(c,-1);if(u&&Bs(t,n,u))return-1;let y=r.coordsAt(c,1);return y&&Bs(t,n,y)?1:u&&Rs(n,u)?-1:1}function Is(s,e){let t=s.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Ls(s,t,e.clientX,e.clientY)}}const us=C.ie&&C.ie_version<=11;let Yr=null,ds=0,Ns=0;function Fs(s){if(!us)return s.detail;let e=Yr,t=Ns;return Yr=s,Ns=Date.now(),ds=!e||t>Date.now()-400&&Math.abs(e.clientX-s.clientX)<2&&Math.abs(e.clientY-s.clientY)<2?(ds+1)%3:1}function no(s,e){let t=Is(s,e),n=Fs(e),r=s.state.selection;return{update(c){c.docChanged&&(t.pos=c.changes.mapPos(t.pos),r=r.map(c.changes))},get(c,u,y){let b=Is(s,c),M,A=Ps(s,b.pos,b.bias,n);if(t.pos!=b.pos&&!u){let F=Ps(s,t.pos,t.bias,n),$=Math.min(F.from,A.from),X=Math.max(F.to,A.to);A=$<A.from?p.jT.range($,X):p.jT.range(X,$)}return u?r.replaceRange(r.main.extend(A.from,A.to)):y&&n==1&&r.ranges.length>1&&(M=ro(r,b.pos))?M:y?r.addRange(A):p.jT.create([A])}}}function ro(s,e){for(let t=0;t<s.ranges.length;t++){let{from:n,to:r}=s.ranges[t];if(n<=e&&r>=e)return p.jT.create(s.ranges.slice(0,t).concat(s.ranges.slice(t+1)),s.mainIndex==t?0:s.mainIndex-(s.mainIndex>t?1:0))}return null}An.dragstart=(s,e)=>{let{selection:{main:t}}=s.state;if(e.target.draggable){let r=s.docView.nearest(e.target);if(r&&r.isWidget){let c=r.posAtStart,u=c+r.length;(c>=t.to||u<=t.from)&&(t=p.jT.range(c,u))}}let{inputState:n}=s;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",s.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove"),!1},An.dragend=s=>(s.inputState.draggedContent=null,!1);function Ws(s,e,t,n){if(!t)return;let r=s.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:c}=s.inputState,u=n&&c&&hs(s,e)?{from:c.from,to:c.to}:null,y={from:r,insert:t},b=s.state.changes(u?[u,y]:y);s.focus(),s.dispatch({changes:b,selection:{anchor:b.mapPos(r,-1),head:b.mapPos(r,1)},userEvent:u?"move.drop":"input.drop"}),s.inputState.draggedContent=null}An.drop=(s,e)=>{if(!e.dataTransfer)return!1;if(s.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),r=0,c=()=>{++r==t.length&&Ws(s,e,n.filter(u=>u!=null).join(s.state.lineBreak),!1)};for(let u=0;u<t.length;u++){let y=new FileReader;y.onerror=c,y.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(y.result)||(n[u]=y.result),c()},y.readAsText(t[u])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Ws(s,e,n,!0),!0}return!1},An.paste=(s,e)=>{if(s.state.readOnly)return!0;s.observer.flush();let t=Xr?null:e.clipboardData;return t?(fs(s,t.getData("text/plain")||t.getData("text/uri-text")),!0):(yr(s),!1)};function z(s,e){let t=s.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),s.focus()},50)}function H(s){let e=[],t=[],n=!1;for(let r of s.selection.ranges)r.empty||(e.push(s.sliceDoc(r.from,r.to)),t.push(r));if(!e.length){let r=-1;for(let{from:c}of s.selection.ranges){let u=s.doc.lineAt(c);u.number>r&&(e.push(u.text),t.push({from:u.from,to:Math.min(s.doc.length,u.to+1)})),r=u.number}n=!0}return{text:e.join(s.lineBreak),ranges:t,linewise:n}}let Q=null;An.copy=An.cut=(s,e)=>{let{text:t,ranges:n,linewise:r}=H(s.state);if(!t&&!r)return!1;Q=r?t:null,e.type=="cut"&&!s.state.readOnly&&s.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let c=Xr?null:e.clipboardData;return c?(c.clearData(),c.setData("text/plain",t),!0):(z(s,t),!1)};const te=p.q6.define();function he(s,e){let t=[];for(let n of s.facet(Ni)){let r=n(s,e);r&&t.push(r)}return t?s.update({effects:t,annotations:te.of(!0)}):null}function ue(s){setTimeout(()=>{let e=s.hasFocus;if(e!=s.inputState.notifiedFocused){let t=he(s.state,e);t?s.dispatch(t):s.update([])}},10)}rn.focus=s=>{s.inputState.lastFocusTime=Date.now(),!s.scrollDOM.scrollTop&&(s.inputState.lastScrollTop||s.inputState.lastScrollLeft)&&(s.scrollDOM.scrollTop=s.inputState.lastScrollTop,s.scrollDOM.scrollLeft=s.inputState.lastScrollLeft),ue(s)},rn.blur=s=>{s.observer.clearSelectionRange(),ue(s)},rn.compositionstart=rn.compositionupdate=s=>{s.inputState.compositionFirstChange==null&&(s.inputState.compositionFirstChange=!0),s.inputState.composing<0&&(s.inputState.composing=0)},rn.compositionend=s=>{s.inputState.composing=-1,s.inputState.compositionEndedAt=Date.now(),s.inputState.compositionPendingKey=!0,s.inputState.compositionPendingChange=s.observer.pendingRecords().length>0,s.inputState.compositionFirstChange=null,C.chrome&&C.android?s.observer.flushSoon():s.inputState.compositionPendingChange?Promise.resolve().then(()=>s.observer.flush()):setTimeout(()=>{s.inputState.composing<0&&s.docView.hasComposition&&s.update([])},50)},rn.contextmenu=s=>{s.inputState.lastContextMenu=Date.now()},An.beforeinput=(s,e)=>{var t;let n;if(C.chrome&&C.android&&(n=Es.find(r=>r.inputType==e.inputType))&&(s.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let r=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var c;(((c=window.visualViewport)===null||c===void 0?void 0:c.height)||0)>r+10&&s.hasFocus&&(s.contentDOM.blur(),s.focus())},100)}return!1};const be=new Set;function Ne(s){be.has(s)||(be.add(s),s.addEventListener("copy",()=>{}),s.addEventListener("cut",()=>{}))}const Mt=["pre-wrap","normal","pre-line","break-spaces"];class yt{constructor(e){this.lineWrapping=e,this.doc=p.xv.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return Mt.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let r=e[n];r<0?n++:this.heightSamples[Math.floor(r*10)]||(t=!0,this.heightSamples[Math.floor(r*10)]=!0)}return t}refresh(e,t,n,r,c,u){let y=Mt.indexOf(e)>-1,b=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=y;if(this.lineWrapping=y,this.lineHeight=t,this.charWidth=n,this.textHeight=r,this.lineLength=c,b){this.heightSamples={};for(let M=0;M<u.length;M++){let A=u[M];A<0?M++:this.heightSamples[Math.floor(A*10)]=!0}}return b}}class Ue{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class De{constructor(e,t,n,r,c){this.from=e,this.length=t,this.top=n,this.height=r,this._content=c}get type(){return typeof this._content=="number"?it.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof st?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new De(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Ae=function(s){return s[s.ByPos=0]="ByPos",s[s.ByHeight=1]="ByHeight",s[s.ByPosNoHeight=2]="ByPosNoHeight",s}(Ae||(Ae={}));const At=.001;class je{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>At&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return je.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,r){let c=this,u=n.doc;for(let y=r.length-1;y>=0;y--){let{fromA:b,toA:M,fromB:A,toB:F}=r[y],$=c.lineAt(b,Ae.ByPosNoHeight,n.setDoc(t),0,0),X=$.to>=M?$:c.lineAt(M,Ae.ByPosNoHeight,n,0,0);for(F+=X.to-M,M=X.to;y>0&&$.from<=r[y-1].toA;)b=r[y-1].fromA,A=r[y-1].fromB,y--,b<$.from&&($=c.lineAt(b,Ae.ByPosNoHeight,n,0,0));A+=$.from-b,b=$.from;let _=Ui.build(n.setDoc(u),e,A,F);c=c.replace(b,M,_)}return c.updateHeight(n,0)}static empty(){return new ni(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,r=0,c=0;for(;;)if(t==n)if(r>c*2){let y=e[t-1];y.break?e.splice(--t,1,y.left,null,y.right):e.splice(--t,1,y.left,y.right),n+=1+y.break,r-=y.size}else if(c>r*2){let y=e[n];y.break?e.splice(n,1,y.left,null,y.right):e.splice(n,1,y.left,y.right),n+=2+y.break,c-=y.size}else break;else if(r<c){let y=e[t++];y&&(r+=y.size)}else{let y=e[--n];y&&(c+=y.size)}let u=0;return e[t-1]==null?(u=1,t--):e[t]==null&&(u=1,n++),new Fi(je.of(e.slice(0,t)),u,je.of(e.slice(n)))}}je.prototype.size=1;class Pt extends je{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,r){return new De(r,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,r,c){return this.blockAt(0,n,r,c)}forEachLine(e,t,n,r,c,u){e<=c+this.length&&t>=c&&u(this.blockAt(0,n,r,c))}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more&&this.setHeight(e,r.heights[r.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class ni extends Pt{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,r){return new De(r,this.length,n,this.height,this.breaks)}replace(e,t,n){let r=n[0];return n.length==1&&(r instanceof ni||r instanceof Zt&&r.flags&4)&&Math.abs(this.length-r.length)<10?(r instanceof Zt?r=new ni(r.length,this.height):r.height=this.height,this.outdated||(r.outdated=!1),r):je.of(n)}updateHeight(e,t=0,n=!1,r){return r&&r.from<=t&&r.more?this.setHeight(e,r.heights[r.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Zt extends je{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,r=e.doc.lineAt(t+this.length).number,c=r-n+1,u,y=0;if(e.lineWrapping){let b=Math.min(this.height,e.lineHeight*c);u=b/c,this.length>c+1&&(y=(this.height-b)/(this.length-c-1))}else u=this.height/c;return{firstLine:n,lastLine:r,perLine:u,perChar:y}}blockAt(e,t,n,r){let{firstLine:c,lastLine:u,perLine:y,perChar:b}=this.heightMetrics(t,r);if(t.lineWrapping){let M=r+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),A=t.doc.lineAt(M),F=y+A.length*b,$=Math.max(n,e-F/2);return new De(A.from,A.length,$,F,0)}else{let M=Math.max(0,Math.min(u-c,Math.floor((e-n)/y))),{from:A,length:F}=t.doc.line(c+M);return new De(A,F,n+y*M,y,0)}}lineAt(e,t,n,r,c){if(t==Ae.ByHeight)return this.blockAt(e,n,r,c);if(t==Ae.ByPosNoHeight){let{from:X,to:_}=n.doc.lineAt(e);return new De(X,_-X,0,0,0)}let{firstLine:u,perLine:y,perChar:b}=this.heightMetrics(n,c),M=n.doc.lineAt(e),A=y+M.length*b,F=M.number-u,$=r+y*F+b*(M.from-c-F);return new De(M.from,M.length,Math.max(r,Math.min($,r+this.height-A)),A,0)}forEachLine(e,t,n,r,c,u){e=Math.max(e,c),t=Math.min(t,c+this.length);let{firstLine:y,perLine:b,perChar:M}=this.heightMetrics(n,c);for(let A=e,F=r;A<=t;){let $=n.doc.lineAt(A);if(A==e){let _=$.number-y;F+=b*_+M*(e-c-_)}let X=b+M*$.length;u(new De($.from,$.length,F,X,0)),F+=X,A=$.to+1}}replace(e,t,n){let r=this.length-t;if(r>0){let c=n[n.length-1];c instanceof Zt?n[n.length-1]=new Zt(c.length+r):n.push(null,new Zt(r-1))}if(e>0){let c=n[0];c instanceof Zt?n[0]=new Zt(e+c.length):n.unshift(new Zt(e-1),null)}return je.of(n)}decomposeLeft(e,t){t.push(new Zt(e-1),null)}decomposeRight(e,t){t.push(null,new Zt(this.length-e-1))}updateHeight(e,t=0,n=!1,r){let c=t+this.length;if(r&&r.from<=t+this.length&&r.more){let u=[],y=Math.max(t,r.from),b=-1;for(r.from>t&&u.push(new Zt(r.from-t-1).updateHeight(e,t));y<=c&&r.more;){let A=e.doc.lineAt(y).length;u.length&&u.push(null);let F=r.heights[r.index++];b==-1?b=F:Math.abs(F-b)>=At&&(b=-2);let $=new ni(A,F);$.outdated=!1,u.push($),y+=A+1}y<=c&&u.push(null,new Zt(c-y).updateHeight(e,y));let M=je.of(u);return(b<0||Math.abs(M.height-this.height)>=At||Math.abs(b-this.heightMetrics(e,t).perLine)>=At)&&(e.heightChanged=!0),M}else(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Fi extends je{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,r){let c=n+this.left.height;return e<c?this.left.blockAt(e,t,n,r):this.right.blockAt(e,t,c,r+this.left.length+this.break)}lineAt(e,t,n,r,c){let u=r+this.left.height,y=c+this.left.length+this.break,b=t==Ae.ByHeight?e<u:e<y,M=b?this.left.lineAt(e,t,n,r,c):this.right.lineAt(e,t,n,u,y);if(this.break||(b?M.to<y:M.from>y))return M;let A=t==Ae.ByPosNoHeight?Ae.ByPosNoHeight:Ae.ByPos;return b?M.join(this.right.lineAt(y,A,n,u,y)):this.left.lineAt(y,A,n,r,c).join(M)}forEachLine(e,t,n,r,c,u){let y=r+this.left.height,b=c+this.left.length+this.break;if(this.break)e<b&&this.left.forEachLine(e,t,n,r,c,u),t>=b&&this.right.forEachLine(e,t,n,y,b,u);else{let M=this.lineAt(b,Ae.ByPos,n,r,c);e<M.from&&this.left.forEachLine(e,M.from-1,n,r,c,u),M.to>=e&&M.from<=t&&u(M),t>M.to&&this.right.forEachLine(M.to+1,t,n,y,b,u)}}replace(e,t,n){let r=this.left.length+this.break;if(t<r)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-r,t-r,n));let c=[];e>0&&this.decomposeLeft(e,c);let u=c.length;for(let y of n)c.push(y);if(e>0&&Pi(c,u-1),t<this.length){let y=c.length;this.decomposeRight(t,c),Pi(c,y)}return je.of(c)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,r=n+this.break;if(e>=r)return this.right.decomposeRight(e-r,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<r&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?je.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,r){let{left:c,right:u}=this,y=t+c.length+this.break,b=null;return r&&r.from<=t+c.length&&r.more?b=c=c.updateHeight(e,t,n,r):c.updateHeight(e,t,n),r&&r.from<=y+u.length&&r.more?b=u=u.updateHeight(e,y,n,r):u.updateHeight(e,y,n),b?this.balanced(c,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Pi(s,e){let t,n;s[e]==null&&(t=s[e-1])instanceof Zt&&(n=s[e+1])instanceof Zt&&s.splice(e-1,3,new Zt(t.length+1+n.length))}const Ji=5;class Ui{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),r=this.nodes[this.nodes.length-1];r instanceof ni?r.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new ni(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let r=n.widget?n.widget.estimatedHeight:0,c=n.widget?n.widget.lineBreaks:0;r<0&&(r=this.oracle.lineHeight);let u=t-e;n.block?this.addBlock(new Pt(u,r,n)):(u||c||r>=Ji)&&this.addLineDeco(r,c,u)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new ni(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new Zt(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof ni)return e;let t=new ni(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let r=this.ensureLine();r.length+=n,r.collapsed+=n,r.widgetHeight=Math.max(r.widgetHeight,e),r.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof ni)&&!this.isCovered?this.nodes.push(new ni(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let r of this.nodes)r instanceof ni&&r.updateHeight(this.oracle,n),n+=r?r.length:1;return this.nodes}static build(e,t,n,r){let c=new Ui(n,e);return p.Xs.spans(t,n,r,c,0),c.finish(n)}}function Nt(s,e,t){let n=new Tn;return p.Xs.compare(s,e,t,n,0),n.changes}class Tn{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,r){(e<t||n&&n.heightRelevant||r&&r.heightRelevant)&&at(e,t,this.changes,5)}}function oi(s,e){let t=s.getBoundingClientRect(),n=s.ownerDocument,r=n.defaultView||window,c=Math.max(0,t.left),u=Math.min(r.innerWidth,t.right),y=Math.max(0,t.top),b=Math.min(r.innerHeight,t.bottom);for(let M=s.parentNode;M&&M!=n.body;)if(M.nodeType==1){let A=M,F=window.getComputedStyle(A);if((A.scrollHeight>A.clientHeight||A.scrollWidth>A.clientWidth)&&F.overflow!="visible"){let $=A.getBoundingClientRect();c=Math.max(c,$.left),u=Math.min(u,$.right),y=Math.max(y,$.top),b=M==s.parentNode?$.bottom:Math.min(b,$.bottom)}M=F.position=="absolute"||F.position=="fixed"?A.offsetParent:A.parentNode}else if(M.nodeType==11)M=M.host;else break;return{left:c-t.left,right:Math.max(c,u)-t.left,top:y-(t.top+e),bottom:Math.max(y,b)-(t.top+e)}}function Wi(s,e){let t=s.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class ji{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let r=e[n],c=t[n];if(r.from!=c.from||r.to!=c.to||r.size!=c.size)return!1}return!0}draw(e,t){return Ye.replace({widget:new Mn(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Mn extends Ci{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ir{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=vn,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=j.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(qn).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new yt(t),this.stateDeco=e.facet(Fn).filter(n=>typeof n!="function"),this.heightMap=je.empty().applyChanges(this.stateDeco,p.xv.empty,this.heightOracle.setDoc(e.doc),[new D(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ye.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let r=n?t.head:t.anchor;if(!e.some(({from:c,to:u})=>r>=c&&r<=u)){let{from:c,to:u}=this.lineBlockAt(r);e.push(new li(c,u))}}this.viewports=e.sort((n,r)=>n.from-r.from),this.scaler=this.heightMap.height<=7e6?vn:new qr(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:rr(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Fn).filter(A=>typeof A!="function");let r=e.changedRanges,c=D.extendWithRanges(r,Nt(n,this.stateDeco,e?e.changes:p.as.empty(this.state.doc.length))),u=this.heightMap.height,y=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),c),this.heightMap.height!=u&&(e.flags|=2),y?(this.scrollAnchorPos=e.changes.mapPos(y.from,-1),this.scrollAnchorHeight=y.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let b=c.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<b.from||t.range.head>b.to)||!this.viewportIsAppropriate(b))&&(b=this.getViewport(0,t));let M=!e.changes.empty||e.flags&2||b.from!=this.viewport.from||b.to!=this.viewport.to;this.viewport=b,this.updateForViewport(),M&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(Yi)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),r=this.heightOracle,c=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?j.RTL:j.LTR;let u=this.heightOracle.mustRefreshForWrapping(c),y=t.getBoundingClientRect(),b=u||this.mustMeasureContent||this.contentDOMHeight!=y.height;this.contentDOMHeight=y.height,this.mustMeasureContent=!1;let M=0,A=0;if(y.width&&y.height){let{scaleX:Ke,scaleY:ht}=ui(t,y);(this.scaleX!=Ke||this.scaleY!=ht)&&(this.scaleX=Ke,this.scaleY=ht,M|=8,u=b=!0)}let F=(parseInt(n.paddingTop)||0)*this.scaleY,$=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=F||this.paddingBottom!=$)&&(this.paddingTop=F,this.paddingBottom=$,M|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(r.lineWrapping&&(b=!0),this.editorWidth=e.scrollDOM.clientWidth,M|=8);let X=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=X&&(this.scrollAnchorHeight=-1,this.scrollTop=X),this.scrolledToBottom=ki(e.scrollDOM);let _=(this.printing?Wi:oi)(t,this.paddingTop),le=_.top-this.pixelViewport.top,re=_.bottom-this.pixelViewport.bottom;this.pixelViewport=_;let pe=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(pe!=this.inView&&(this.inView=pe,pe&&(b=!0)),!this.inView&&!this.scrollTarget)return 0;let Ze=y.width;if((this.contentDOMWidth!=Ze||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=y.width,this.editorHeight=e.scrollDOM.clientHeight,M|=8),b){let Ke=e.docView.measureVisibleLineHeights(this.viewport);if(r.mustRefreshForHeights(Ke)&&(u=!0),u||r.lineWrapping&&Math.abs(Ze-this.contentDOMWidth)>r.charWidth){let{lineHeight:ht,charWidth:St,textHeight:Hi}=e.docView.measureTextSize();u=ht>0&&r.refresh(c,ht,St,Hi,Ze/St,Ke),u&&(e.docView.minWidth=0,M|=8)}le>0&&re>0?A=Math.max(le,re):le<0&&re<0&&(A=Math.min(le,re)),r.heightChanged=!1;for(let ht of this.viewports){let St=ht.from==this.viewport.from?Ke:e.docView.measureVisibleLineHeights(ht);this.heightMap=(u?je.empty().applyChanges(this.stateDeco,p.xv.empty,this.heightOracle,[new D(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(r,0,u,new Ue(ht.from,St))}r.heightChanged&&(M|=2)}let ft=!this.viewportIsAppropriate(this.viewport,A)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return ft&&(this.viewport=this.getViewport(A,this.scrollTarget)),this.updateForViewport(),(M&2||ft)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,e)),M|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),M}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),r=this.heightMap,c=this.heightOracle,{visibleTop:u,visibleBottom:y}=this,b=new li(r.lineAt(u-n*1e3,Ae.ByHeight,c,0,0).from,r.lineAt(y+(1-n)*1e3,Ae.ByHeight,c,0,0).to);if(t){let{head:M}=t.range;if(M<b.from||M>b.to){let A=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),F=r.lineAt(M,Ae.ByPos,c,0,0),$;t.y=="center"?$=(F.top+F.bottom)/2-A/2:t.y=="start"||t.y=="nearest"&&M<b.from?$=F.top:$=F.bottom-A,b=new li(r.lineAt($-1e3/2,Ae.ByHeight,c,0,0).from,r.lineAt($+A+1e3/2,Ae.ByHeight,c,0,0).to)}}return b}mapViewport(e,t){let n=t.mapPos(e.from,-1),r=t.mapPos(e.to,1);return new li(this.heightMap.lineAt(n,Ae.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(r,Ae.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:r}=this.heightMap.lineAt(e,Ae.ByPos,this.heightOracle,0,0),{bottom:c}=this.heightMap.lineAt(t,Ae.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:y}=this;return(e==0||r<=u-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||c>=y+Math.max(10,Math.min(n,250)))&&r>u-2*1e3&&c<y+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let r of e)t.touchesRange(r.from,r.to)||n.push(new ji(t.mapPos(r.from),t.mapPos(r.to),r.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,r=n?1e4:2e3,c=r>>1,u=r<<1;if(this.defaultTextDirection!=j.LTR&&!n)return[];let y=[],b=(M,A,F,$)=>{if(A-M<c)return;let X=this.state.selection.main,_=[X.from];X.empty||_.push(X.to);for(let re of _)if(re>M&&re<A){b(M,re-10,F,$),b(re+10,A,F,$);return}let le=Fr(e,re=>re.from>=F.from&&re.to<=F.to&&Math.abs(re.from-M)<c&&Math.abs(re.to-A)<c&&!_.some(pe=>re.from<pe&&re.to>pe));if(!le){if(A<F.to&&t&&n&&t.visibleRanges.some(re=>re.from<=A&&re.to>=A)){let re=t.moveToLineBoundary(p.jT.cursor(A),!1,!0).head;re>M&&(A=re)}le=new ji(M,A,this.gapSize(F,M,A,$))}y.push(le)};for(let M of this.viewportLines){if(M.length<u)continue;let A=un(M.from,M.to,this.stateDeco);if(A.total<u)continue;let F=this.scrollTarget?this.scrollTarget.range.head:null,$,X;if(n){let _=r/this.heightOracle.lineLength*this.heightOracle.lineHeight,le,re;if(F!=null){let pe=nr(A,F),Ze=((this.visibleBottom-this.visibleTop)/2+_)/M.height;le=pe-Ze,re=pe+Ze}else le=(this.visibleTop-M.top-_)/M.height,re=(this.visibleBottom-M.top+_)/M.height;$=Ri(A,le),X=Ri(A,re)}else{let _=A.total*this.heightOracle.charWidth,le=r*this.heightOracle.charWidth,re,pe;if(F!=null){let Ze=nr(A,F),ft=((this.pixelViewport.right-this.pixelViewport.left)/2+le)/_;re=Ze-ft,pe=Ze+ft}else re=(this.pixelViewport.left-le)/_,pe=(this.pixelViewport.right+le)/_;$=Ri(A,re),X=Ri(A,pe)}$>M.from&&b(M.from,$,M,A),X<M.to&&b(X,M.to,M,A)}return y}gapSize(e,t,n,r){let c=nr(r,n)-nr(r,t);return this.heightOracle.lineWrapping?e.height*c:r.total*this.heightOracle.charWidth*c}updateLineGaps(e){ji.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ye.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];p.Xs.spans(e,this.viewport.from,this.viewport.to,{span(r,c){t.push({from:r,to:c})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((r,c)=>r.from!=t[c].from||r.to!=t[c].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||rr(this.heightMap.lineAt(e,Ae.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return rr(this.heightMap.lineAt(this.scaler.fromDOM(e),Ae.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return rr(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class li{constructor(e,t){this.from=e,this.to=t}}function un(s,e,t){let n=[],r=s,c=0;return p.Xs.spans(t,s,e,{span(){},point(u,y){u>r&&(n.push({from:r,to:u}),c+=u-r),r=y}},20),r<e&&(n.push({from:r,to:e}),c+=e-r),{total:c,ranges:n}}function Ri({total:s,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(s*t);for(let r=0;;r++){let{from:c,to:u}=e[r],y=u-c;if(n<=y)return c+n;n-=y}}function nr(s,e){let t=0;for(let{from:n,to:r}of s.ranges){if(e<=r){t+=e-n;break}t+=r-n}return t/s.total}function Fr(s,e){for(let t of s)if(e(t))return t}const vn={toDOM(s){return s},fromDOM(s){return s},scale:1};class qr{constructor(e,t,n){let r=0,c=0,u=0;this.viewports=n.map(({from:y,to:b})=>{let M=t.lineAt(y,Ae.ByPos,e,0,0).top,A=t.lineAt(b,Ae.ByPos,e,0,0).bottom;return r+=A-M,{from:y,to:b,top:M,bottom:A,domTop:0,domBottom:0}}),this.scale=(7e6-r)/(t.height-r);for(let y of this.viewports)y.domTop=u+(y.top-c)*this.scale,u=y.domBottom=y.domTop+(y.bottom-y.top),c=y.bottom}toDOM(e){for(let t=0,n=0,r=0;;t++){let c=t<this.viewports.length?this.viewports[t]:null;if(!c||e<c.top)return r+(e-n)*this.scale;if(e<=c.bottom)return c.domTop+(e-c.top);n=c.bottom,r=c.domBottom}}fromDOM(e){for(let t=0,n=0,r=0;;t++){let c=t<this.viewports.length?this.viewports[t]:null;if(!c||e<c.domTop)return n+(e-r)/this.scale;if(e<=c.domBottom)return c.top+(e-c.domTop);n=c.bottom,r=c.domBottom}}}function rr(s,e){if(e.scale==1)return s;let t=e.toDOM(s.top),n=e.toDOM(s.bottom);return new De(s.from,s.length,t,n-t,Array.isArray(s._content)?s._content.map(r=>rr(r,e)):s._content)}const Ii=p.r$.define({combine:s=>s.join(" ")}),Bi=p.r$.define({combine:s=>s.indexOf(!0)>-1}),dn=Se.V.newName(),bn=Se.V.newName(),Wr=Se.V.newName(),sr={"&light":"."+bn,"&dark":"."+Wr};function sn(s,e,t){return new Se.V(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,r=>{if(r=="&")return s;if(!t||!t[r])throw new RangeError(`Unsupported selector: ${r}`);return t[r]}):s+" "+n}})}const Hr=sn("."+dn,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},sr),Bn="\uFFFF";class or{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(p.yy.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Bn}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let r=e;;){this.findPointBefore(n,r);let c=this.text.length;this.readNode(r);let u=r.nextSibling;if(u==t)break;let y=ye.get(r),b=ye.get(u);(y&&b?y.breakAfter:(y?y.breakAfter:br(r))||br(u)&&(r.nodeName!="BR"||r.cmIgnore)&&this.text.length>c)&&this.lineBreak(),r=u}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,r=this.lineSeparator?null:/\r\n?|\n/g;;){let c=-1,u=1,y;if(this.lineSeparator?(c=t.indexOf(this.lineSeparator,n),u=this.lineSeparator.length):(y=r.exec(t))&&(c=y.index,u=y[0].length),this.append(t.slice(n,c<0?t.length:c)),c<0)break;if(this.lineBreak(),u>1)for(let b of this.points)b.node==e&&b.pos>this.text.length&&(b.pos-=u-1);n=c+u}}readNode(e){if(e.cmIgnore)return;let t=ye.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let r=n.iter();!r.next().done;)r.lineBreak?this.lineBreak():this.append(r.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(vr(e,n.node,n.offset)?t:0))}}function vr(s,e,t){for(;;){if(!e||t<pt(e))return!1;if(e==s)return!0;t=Xt(e)+1,e=e.parentNode}}function br(s){return s.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(s.nodeName)}class xr{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class Qi{constructor(e,t,n,r){this.typeOver=r,this.bounds=null,this.text="";let{impreciseHead:c,impreciseAnchor:u}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let y=c||u?[]:lr(e),b=new or(y,e.state);b.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=b.text,this.newSel=ps(y,this.bounds.from)}else{let y=e.observer.selectionRange,b=c&&c.node==y.focusNode&&c.offset==y.focusOffset||!$e(e.contentDOM,y.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(y.focusNode,y.focusOffset),M=u&&u.node==y.anchorNode&&u.offset==y.anchorOffset||!$e(e.contentDOM,y.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(y.anchorNode,y.anchorOffset);this.newSel=p.jT.single(M,b)}}}function En(s,e){let t,{newSel:n}=e,r=s.state.selection.main,c=s.inputState.lastKeyTime>Date.now()-100?s.inputState.lastKeyCode:-1;if(e.bounds){let{from:u,to:y}=e.bounds,b=r.from,M=null;(c===8||C.android&&e.text.length<y-u)&&(b=r.to,M="end");let A=Un(s.state.doc.sliceString(u,y,Bn),e.text,b-u,M);A&&(C.chrome&&c==13&&A.toB==A.from+2&&e.text.slice(A.from,A.toB)==Bn+Bn&&A.toB--,t={from:u+A.from,to:u+A.toA,insert:p.xv.of(e.text.slice(A.from,A.toB).split(Bn))})}else n&&(!s.hasFocus&&s.state.facet(Zi)||n.main.eq(r))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!r.empty&&n&&n.main.empty?t={from:r.from,to:r.to,insert:s.state.doc.slice(r.from,r.to)}:t&&t.from>=r.from&&t.to<=r.to&&(t.from!=r.from||t.to!=r.to)&&r.to-r.from-(t.to-t.from)<=4?t={from:r.from,to:r.to,insert:s.state.doc.slice(r.from,t.from).append(t.insert).append(s.state.doc.slice(t.to,r.to))}:(C.mac||C.android)&&t&&t.from==t.to&&t.from==r.head-1&&/^\. ?$/.test(t.insert.toString())&&s.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=p.jT.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:p.xv.of([" "])}):C.chrome&&t&&t.from==t.to&&t.from==r.head&&t.insert.toString()==`
 `&&s.lineWrapping&&(n&&(n=p.jT.single(n.main.anchor-1,n.main.head-1)),t={from:r.from,to:r.to,insert:p.xv.of([" "])}),t){if(C.ios&&s.inputState.flushIOSKey()||C.android&&(t.from==r.from&&t.to==r.to&&t.insert.length==1&&t.insert.lines==2&&Yt(s.contentDOM,"Enter",13)||(t.from==r.from-1&&t.to==r.to&&t.insert.length==0||c==8&&t.insert.length<t.to-t.from&&t.to>r.head)&&Yt(s.contentDOM,"Backspace",8)||t.from==r.from&&t.to==r.to+1&&t.insert.length==0&&Yt(s.contentDOM,"Delete",46)))return!0;let u=t.insert.toString();s.inputState.composing>=0&&s.inputState.composing++;let y,b=()=>y||(y=Jn(s,t,n));return s.state.facet(Ht).some(M=>M(s,t.from,t.to,u,b))||s.dispatch(b()),!0}else if(n&&!n.main.eq(r)){let u=!1,y="select";return s.inputState.lastSelectionTime>Date.now()-50&&(s.inputState.lastSelectionOrigin=="select"&&(u=!0),y=s.inputState.lastSelectionOrigin),s.dispatch({selection:n,scrollIntoView:u,userEvent:y}),!0}else return!1}function Jn(s,e,t){let n,r=s.state,c=r.selection.main;if(e.from>=c.from&&e.to<=c.to&&e.to-e.from>=(c.to-c.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&s.inputState.composing<0){let y=c.from<e.from?r.sliceDoc(c.from,e.from):"",b=c.to>e.to?r.sliceDoc(e.to,c.to):"";n=r.replaceSelection(s.state.toText(y+e.insert.sliceString(0,void 0,s.state.lineBreak)+b))}else{let y=r.changes(e),b=t&&t.main.to<=y.newLength?t.main:void 0;if(r.selection.ranges.length>1&&s.inputState.composing>=0&&e.to<=c.to&&e.to>=c.to-10){let M=s.state.sliceDoc(e.from,e.to),A,F=t&&W(s,t.main.head);if(F){let _=e.insert.length-(e.to-e.from);A={from:F.from,to:F.to-_}}else A=s.state.doc.lineAt(c.head);let $=c.to-e.to,X=c.to-c.from;n=r.changeByRange(_=>{if(_.from==c.from&&_.to==c.to)return{changes:y,range:b||_.map(y)};let le=_.to-$,re=le-M.length;if(_.to-_.from!=X||s.state.sliceDoc(re,le)!=M||_.to>=A.from&&_.from<=A.to)return{range:_};let pe=r.changes({from:re,to:le,insert:e.insert}),Ze=_.to-c.to;return{changes:pe,range:b?p.jT.range(Math.max(0,b.anchor+Ze),Math.max(0,b.head+Ze)):_.map(pe)}})}else n={changes:y,selection:b&&r.selection.replaceRange(b)}}let u="input.type";return(s.composing||s.inputState.compositionPendingChange&&s.inputState.compositionEndedAt>Date.now()-50)&&(s.inputState.compositionPendingChange=!1,u+=".compose",s.inputState.compositionFirstChange&&(u+=".start",s.inputState.compositionFirstChange=!1)),r.update(n,{userEvent:u,scrollIntoView:!0})}function Un(s,e,t,n){let r=Math.min(s.length,e.length),c=0;for(;c<r&&s.charCodeAt(c)==e.charCodeAt(c);)c++;if(c==r&&s.length==e.length)return null;let u=s.length,y=e.length;for(;u>0&&y>0&&s.charCodeAt(u-1)==e.charCodeAt(y-1);)u--,y--;if(n=="end"){let b=Math.max(0,c-Math.min(u,y));t-=u+b-c}if(u<c&&s.length<e.length){let b=t<=c&&t>=u?c-t:0;c-=b,y=c+(y-u),u=c}else if(y<c){let b=t<=c&&t>=y?c-t:0;c-=b,u=c+(u-y),y=c}return{from:c,toA:u,toB:y}}function lr(s){let e=[];if(s.root.activeElement!=s.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:r,focusOffset:c}=s.observer.selectionRange;return t&&(e.push(new xr(t,n)),(r!=t||c!=n)&&e.push(new xr(r,c))),e}function ps(s,e){if(s.length==0)return null;let t=s[0].pos,n=s.length==2?s[1].pos:t;return t>-1&&n>-1?p.jT.single(t+e,n+e):null}const ar={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},xn=C.ie&&C.ie_version<=11;class Dn{constructor(e){this.view=e,this.active=!1,this.selectionRange=new Di,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(C.ie&&C.ie_version<=11||C.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),xn&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,r=this.selectionRange;if(n.state.facet(Zi)?n.root.activeElement!=this.dom:!_e(n.dom,r))return;let c=r.anchorNode&&n.docView.nearest(r.anchorNode);if(c&&c.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(C.ie&&C.ie_version<=11||C.android&&C.chrome)&&!n.state.selection.main.empty&&r.focusNode&&yi(r.focusNode,r.focusOffset,r.anchorNode,r.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=C.safari&&e.root.nodeType==11&&nt(this.dom.ownerDocument)==this.dom&&pn(this.view)||bt(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=_e(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Ge(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,ar),xn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),xn&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let r=()=>{let c=this.delayedAndroidKey;c&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=c.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&c.force&&Yt(this.dom,c.key,c.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(r)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,r=!1;for(let c of e){let u=this.readMutation(c);u&&(u.typeOver&&(r=!0),t==-1?{from:t,to:n}=u:(t=Math.min(u.from,t),n=Math.max(u.to,n)))}return{from:t,to:n,typeOver:r}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),r=this.selectionChanged&&_e(this.dom,this.selectionRange);if(e<0&&!r)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let c=new Qi(this.view,e,t,n);return this.view.docView.domChanged={newSel:c.newSel?c.newSel.main:null},c}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,r=En(this.view,t);return this.view.state==n&&this.view.update([]),r}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=mi(t,e.previousSibling||e.target.previousSibling,-1),r=mi(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:r?t.posBefore(r):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let r of this.scrollTargets)r.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function mi(s,e,t){for(;e;){let n=ye.get(e);if(n&&n.parent==s)return n;let r=e.parentNode;e=r!=s.dom?r:t>0?e.nextSibling:e.previousSibling}return null}function pn(s){let e=null;function t(b){b.preventDefault(),b.stopImmediatePropagation(),e=b.getTargetRanges()[0]}if(s.contentDOM.addEventListener("beforeinput",t,!0),s.dom.ownerDocument.execCommand("indent"),s.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let n=e.startContainer,r=e.startOffset,c=e.endContainer,u=e.endOffset,y=s.docView.domAtPos(s.state.selection.main.anchor);return yi(y.node,y.offset,c,u)&&([n,r,c,u]=[c,u,n,r]),{anchorNode:n,anchorOffset:r,focusNode:c,focusOffset:u}}class Ft{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(n=>n.forEach(r=>t(r,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=e.root||ri(e.parent)||document,this.viewState=new ir(e.state||p.yy.create(e)),e.scrollTo&&e.scrollTo.is(nn)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(cn).map(n=>new Nn(n));for(let n of this.plugins)n.update(this);this.observer=new Dn(this),this.inputState=new io(this),this.inputState.ensureHandlers(this.plugins),this.docView=new g(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let t=e.length==1&&e[0]instanceof p.YW?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,r,c=this.state;for(let $ of e){if($.startState!=c)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");c=$.state}if(this.destroyed){this.viewState.state=c;return}let u=this.hasFocus,y=0,b=null;e.some($=>$.annotation(te))?(this.inputState.notifiedFocused=u,y=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,b=he(c,u),b||(y=1));let M=this.observer.delayedAndroidKey,A=null;if(M?(this.observer.clearDelayedAndroidKey(),A=this.observer.readChange(),(A&&!this.state.doc.eq(c.doc)||!this.state.selection.eq(c.selection))&&(A=null)):this.observer.clear(),c.facet(p.yy.phrases)!=this.state.facet(p.yy.phrases))return this.setState(c);r=V.create(this,c,e),r.flags|=y;let F=this.viewState.scrollTarget;try{this.updateState=2;for(let $ of e){if(F&&(F=F.map($.changes)),$.scrollIntoView){let{main:X}=$.state.selection;F=new $i(X.empty?X:p.jT.cursor(X.head,X.head>X.anchor?-1:1))}for(let X of $.effects)X.is(nn)&&(F=X.value.clip(this.state))}this.viewState.update(r,F),this.bidiCache=Sr.update(this.bidiCache,r.changes),r.empty||(this.updatePlugins(r),this.inputState.update(r)),t=this.docView.update(r),this.state.facet(E)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some($=>$.isUserEvent("select.pointer")))}finally{this.updateState=0}if(r.startState.facet(Ii)!=r.state.facet(Ii)&&(this.viewState.mustMeasureContent=!0),(t||n||F||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!r.empty)for(let $ of this.state.facet(Ti))try{$(r)}catch(X){si(this.state,X,"update listener")}(b||A)&&Promise.resolve().then(()=>{b&&this.state==b.startState&&this.dispatch(b),A&&!En(this,A)&&M.force&&Yt(this.contentDOM,M.key,M.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new ir(e),this.plugins=e.facet(cn).map(n=>new Nn(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new g(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(cn),n=e.state.facet(cn);if(t!=n){let r=[];for(let c of n){let u=t.indexOf(c);if(u<0)r.push(new Nn(c));else{let y=this.plugins[u];y.mustUpdate=e,r.push(y)}}for(let c of this.plugins)c.mustUpdate!=e&&c.destroy(this);this.plugins=r,this.pluginMap.clear()}else for(let r of this.plugins)r.mustUpdate=e;for(let r=0;r<this.plugins.length;r++)this.plugins[r].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,r=n.scrollTop*this.scaleY,{scrollAnchorPos:c,scrollAnchorHeight:u}=this.viewState;Math.abs(r-this.viewState.scrollTop)>1&&(u=-1),this.viewState.scrollAnchorHeight=-1;try{for(let y=0;;y++){if(u<0)if(ki(n))c=-1,u=this.viewState.heightMap.height;else{let X=this.viewState.scrollAnchorAt(r);c=X.from,u=X.top}this.updateState=1;let b=this.viewState.measure(this);if(!b&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(y>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let M=[];b&4||([this.measureRequests,M]=[M,this.measureRequests]);let A=M.map(X=>{try{return X.read(this)}catch(_){return si(this.state,_),wr}}),F=V.create(this,this.state,[]),$=!1;F.flags|=b,t?t.flags|=b:t=F,this.updateState=2,F.empty||(this.updatePlugins(F),this.inputState.update(F),this.updateAttrs(),$=this.docView.update(F));for(let X=0;X<M.length;X++)if(A[X]!=wr)try{let _=M[X];_.write&&_.write(A[X],this)}catch(_){si(this.state,_)}if($&&this.docView.updateSelection(!0),!F.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=-1;continue}else{let _=(c<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(c).top)-u;if(_>1||_<-1){r=r+_,n.scrollTop=r/this.scaleY,u=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let y of this.state.facet(Ti))y(t)}get themeClasses(){return dn+" "+(this.state.facet(Bi)?Wr:bn)+" "+this.state.facet(Ii)}updateAttrs(){let e=kr(this,On,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Zi)?"true":"false",class:"cm-content",style:`${C.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),kr(this,qn,t);let n=this.observer.ignore(()=>{let r=Vt(this.contentDOM,this.contentAttrs,t),c=Vt(this.dom,this.editorAttrs,e);return r||c});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let r of n.effects)if(r.is(Ft.announce)){t&&(this.announceDOM.textContent=""),t=!1;let c=this.announceDOM.appendChild(document.createElement("div"));c.textContent=r.value}}mountStyles(){this.styleModules=this.state.facet(E);let e=this.state.facet(Ft.cspNonce);Se.V.mount(this.root,this.styleModules.concat(Hr).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Ms(this,e,Hn(this,e,t,n))}moveByGroup(e,t){return Ms(this,e,Hn(this,e,t,n=>Ir(this,e.head,n)))}moveToLineBoundary(e,t,n=!0){return Wn(this,e,t,n)}moveVertically(e,t,n){return Ms(this,e,os(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Zn(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let r=this.state.doc.lineAt(e),c=this.bidiSpans(r),u=c[mn.find(c,e-r.from,-1,t)];return Kt(n,u.dir==j.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(zi)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>Qr)return Rn(e.length);let t=this.textDirectionAt(e.from),n;for(let c of this.bidiCache)if(c.from==e.from&&c.dir==t&&(c.fresh||Pn(c.isolates,n=d(this,e.from,e.to))))return c.order;n||(n=d(this,e.from,e.to));let r=pr(e.text,t,n);return this.bidiCache.push(new Sr(e.from,e.to,t,n,!0,r)),r}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||C.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Ot(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return nn.of(new $i(typeof e=="number"?p.jT.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return nn.of(new $i(p.jT.cursor(n.from),"start","start",n.top-e,t,!0))}static domEventHandlers(e){return di.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return di.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=Se.V.newName(),r=[Ii.of(n),E.of(sn(`.${n}`,e))];return t&&t.dark&&r.push(Bi.of(!0)),r}static baseTheme(e){return p.Wl.lowest(E.of(sn("."+dn,e,sr)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),r=n&&ye.get(n)||ye.get(e);return((t=r==null?void 0:r.rootView)===null||t===void 0?void 0:t.view)||null}}Ft.styleModule=E,Ft.inputHandler=Ht,Ft.focusChangeEffect=Ni,Ft.perLineTextDirection=zi,Ft.exceptionSink=tn,Ft.updateListener=Ti,Ft.editable=Zi,Ft.mouseSelectionStyle=vi,Ft.dragMovesSelection=fi,Ft.clickAddsSelectionRange=Vi,Ft.decorations=Fn,Ft.atomicRanges=R,Ft.bidiIsolatedRanges=a,Ft.scrollMargins=v,Ft.darkTheme=Bi,Ft.cspNonce=p.r$.define({combine:s=>s.length?s[0]:""}),Ft.contentAttributes=qn,Ft.editorAttributes=On,Ft.lineWrapping=Ft.contentAttributes.of({class:"cm-lineWrapping"}),Ft.announce=p.Py.define();const Qr=4096,wr={};class Sr{constructor(e,t,n,r,c,u){this.from=e,this.to=t,this.dir=n,this.isolates=r,this.fresh=c,this.order=u}static update(e,t){if(t.empty&&!e.some(c=>c.fresh))return e;let n=[],r=e.length?e[e.length-1].dir:j.LTR;for(let c=Math.max(0,e.length-10);c<e.length;c++){let u=e[c];u.dir==r&&!t.touchesRange(u.from,u.to)&&n.push(new Sr(t.mapPos(u.from,1),t.mapPos(u.to,-1),u.dir,u.isolates,!1,u.order))}return n}}function kr(s,e,t){for(let n=s.state.facet(e),r=n.length-1;r>=0;r--){let c=n[r],u=typeof c=="function"?c(s):c;u&&rt(u,t)}return t}const _i=C.mac?"mac":C.windows?"win":C.linux?"linux":"key";function Re(s,e){const t=s.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let r,c,u,y;for(let b=0;b<t.length-1;++b){const M=t[b];if(/^(cmd|meta|m)$/i.test(M))y=!0;else if(/^a(lt)?$/i.test(M))r=!0;else if(/^(c|ctrl|control)$/i.test(M))c=!0;else if(/^s(hift)?$/i.test(M))u=!0;else if(/^mod$/i.test(M))e=="mac"?y=!0:c=!0;else throw new Error("Unrecognized modifier name: "+M)}return r&&(n="Alt-"+n),c&&(n="Ctrl-"+n),y&&(n="Meta-"+n),u&&(n="Shift-"+n),n}function ai(s,e,t){return e.altKey&&(s="Alt-"+s),e.ctrlKey&&(s="Ctrl-"+s),e.metaKey&&(s="Meta-"+s),t!==!1&&e.shiftKey&&(s="Shift-"+s),s}const wn=p.Wl.default(Ft.domEventHandlers({keydown(s,e){return Gn(Vs(e.state),s,e,"editor")}})),Ln=p.r$.define({enables:wn}),Hs=new WeakMap;function Vs(s){let e=s.facet(Ln),t=Hs.get(e);return t||Hs.set(e,t=on(e.reduce((n,r)=>n.concat(r),[]))),t}function _r(s,e,t){return Gn(Vs(s.state),e,s,t)}let zn=null;const ms=4e3;function on(s,e=_i){let t=Object.create(null),n=Object.create(null),r=(u,y)=>{let b=n[u];if(b==null)n[u]=y;else if(b!=y)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},c=(u,y,b,M,A)=>{var F,$;let X=t[u]||(t[u]=Object.create(null)),_=y.split(/ (?!$)/).map(pe=>Re(pe,e));for(let pe=1;pe<_.length;pe++){let Ze=_.slice(0,pe).join(" ");r(Ze,!0),X[Ze]||(X[Ze]={preventDefault:!0,stopPropagation:!1,run:[ft=>{let Ke=zn={view:ft,prefix:Ze,scope:u};return setTimeout(()=>{zn==Ke&&(zn=null)},ms),!0}]})}let le=_.join(" ");r(le,!1);let re=X[le]||(X[le]={preventDefault:!1,stopPropagation:!1,run:(($=(F=X._any)===null||F===void 0?void 0:F.run)===null||$===void 0?void 0:$.slice())||[]});b&&re.run.push(b),M&&(re.preventDefault=!0),A&&(re.stopPropagation=!0)};for(let u of s){let y=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let M of y){let A=t[M]||(t[M]=Object.create(null));A._any||(A._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let F in A)A[F].run.push(u.any)}let b=u[e]||u.key;if(b)for(let M of y)c(M,b,u.run,u.preventDefault,u.stopPropagation),u.shift&&c(M,"Shift-"+b,u.shift,u.preventDefault,u.stopPropagation)}return t}function Gn(s,e,t,n){let r=dt(e),c=(0,p.gm)(r,0),u=(0,p.nZ)(c)==r.length&&r!=" ",y="",b=!1,M=!1,A=!1;zn&&zn.view==t&&zn.scope==n&&(y=zn.prefix+" ",Gr.indexOf(e.keyCode)<0&&(M=!0,zn=null));let F=new Set,$=re=>{if(re){for(let pe of re.run)if(!F.has(pe)&&(F.add(pe),pe(t,e)))return re.stopPropagation&&(A=!0),!0;re.preventDefault&&(re.stopPropagation&&(A=!0),M=!0)}return!1},X=s[n],_,le;return X&&($(X[y+ai(r,e,!u)])?b=!0:u&&(e.altKey||e.metaKey||e.ctrlKey)&&!(C.windows&&e.ctrlKey&&e.altKey)&&(_=de[e.keyCode])&&_!=r?($(X[y+ai(_,e,!0)])||e.shiftKey&&(le=L[e.keyCode])!=r&&le!=_&&$(X[y+ai(le,e,!1)]))&&(b=!0):u&&e.shiftKey&&$(X[y+ai(r,e,!0)])&&(b=!0),!b&&$(X._any)&&(b=!0)),M&&(b=!0),b&&A&&e.stopPropagation(),b}class Cr{constructor(e,t,n,r,c){this.className=e,this.left=t,this.top=n,this.width=r,this.height=c}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let r=e.coordsAtPos(n.head,n.assoc||1);if(!r)return[];let c=es(e);return[new Cr(t,r.left-c.left,r.top-c.top,null,r.bottom-r.top)]}else return xi(e,t,n)}}function es(s){let e=s.scrollDOM.getBoundingClientRect();return{left:(s.textDirection==j.LTR?e.left:e.right-s.scrollDOM.clientWidth*s.scaleX)-s.scrollDOM.scrollLeft*s.scaleX,top:e.top-s.scrollDOM.scrollTop*s.scaleY}}function ts(s,e,t){let n=p.jT.cursor(e);return{from:Math.max(t.from,s.moveToLineBoundary(n,!1,!0).from),to:Math.min(t.to,s.moveToLineBoundary(n,!0,!0).from),type:it.Text}}function xi(s,e,t){if(t.to<=s.viewport.from||t.from>=s.viewport.to)return[];let n=Math.max(t.from,s.viewport.from),r=Math.min(t.to,s.viewport.to),c=s.textDirection==j.LTR,u=s.contentDOM,y=u.getBoundingClientRect(),b=es(s),M=u.querySelector(".cm-line"),A=M&&window.getComputedStyle(M),F=y.left+(A?parseInt(A.paddingLeft)+Math.min(0,parseInt(A.textIndent)):0),$=y.right-(A?parseInt(A.paddingRight):0),X=er(s,n),_=er(s,r),le=X.type==it.Text?X:null,re=_.type==it.Text?_:null;if(le&&(s.lineWrapping||X.widgetLineBreaks)&&(le=ts(s,n,le)),re&&(s.lineWrapping||_.widgetLineBreaks)&&(re=ts(s,r,re)),le&&re&&le.from==re.from)return Ze(ft(t.from,t.to,le));{let ht=le?ft(t.from,null,le):Ke(X,!1),St=re?ft(null,t.to,re):Ke(_,!0),Hi=[];return(le||X).to<(re||_).from-(le&&re?1:0)||X.widgetLineBreaks>1&&ht.bottom+s.defaultLineHeight/2<St.top?Hi.push(pe(F,ht.bottom,$,St.top)):ht.bottom<St.top&&s.elementAtHeight((ht.bottom+St.top)/2).type==it.Text&&(ht.bottom=St.top=(ht.bottom+St.top)/2),Ze(ht).concat(Hi).concat(Ze(St))}function pe(ht,St,Hi,en){return new Cr(e,ht-b.left,St-b.top-.01,Hi-ht,en-St+.01)}function Ze({top:ht,bottom:St,horizontal:Hi}){let en=[];for(let Tr=0;Tr<Hi.length;Tr+=2)en.push(pe(Hi[Tr],ht,Hi[Tr+1],St));return en}function ft(ht,St,Hi){let en=1e9,Tr=-1e9,qs=[];function Ko(Mr,Er,ss,Zr,Ts){let Xn=s.coordsAtPos(Mr,Mr==Hi.to?-2:2),cr=s.coordsAtPos(ss,ss==Hi.from?2:-2);!Xn||!cr||(en=Math.min(Xn.top,cr.top,en),Tr=Math.max(Xn.bottom,cr.bottom,Tr),Ts==j.LTR?qs.push(c&&Er?F:Xn.left,c&&Zr?$:cr.right):qs.push(!c&&Zr?F:cr.left,!c&&Er?$:Xn.right))}let Qs=ht!=null?ht:Hi.from,_s=St!=null?St:Hi.to;for(let Mr of s.visibleRanges)if(Mr.to>Qs&&Mr.from<_s)for(let Er=Math.max(Mr.from,Qs),ss=Math.min(Mr.to,_s);;){let Zr=s.state.doc.lineAt(Er);for(let Ts of s.bidiSpans(Zr)){let Xn=Ts.from+Zr.from,cr=Ts.to+Zr.from;if(Xn>=ss)break;cr>Er&&Ko(Math.max(Xn,Er),ht==null&&Xn<=Qs,Math.min(cr,ss),St==null&&cr>=_s,Ts.dir)}if(Er=Zr.to+1,Er>=ss)break}return qs.length==0&&Ko(Qs,ht==null,_s,St==null,s.textDirection),{top:en,bottom:Tr,horizontal:qs}}function Ke(ht,St){let Hi=y.top+(St?ht.top:ht.bottom);return{top:Hi,bottom:Hi,horizontal:[]}}}function Qe(s,e){return s.constructor==e.constructor&&s.eq(e)}class Te{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(we)!=e.state.facet(we)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}setOrder(e){let t=0,n=e.facet(we);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!Qe(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let r of e)r.update&&t&&r.constructor&&this.drawn[n].constructor&&r.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(r.draw(),t);for(;t;){let r=t.nextSibling;t.remove(),t=r}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const we=p.r$.define();function ze(s){return[di.define(e=>new Te(e,s)),we.of(s)]}const xt=!C.ios,wt=p.r$.define({combine(s){return(0,p.BO)(s,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function gi(s={}){return[wt.of(s),gs,so,oo,Yi.of(!0)]}function Mi(s){return s.facet(wt)}function Sn(s){return s.startState.facet(wt)!=s.state.facet(wt)}const gs=ze({above:!0,markers(s){let{state:e}=s,t=e.facet(wt),n=[];for(let r of e.selection.ranges){let c=r==e.selection.main;if(r.empty?!c||xt:t.drawRangeCursor){let u=c?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",y=r.empty?r:p.jT.cursor(r.head,r.head>r.anchor?-1:1);for(let b of Cr.forRange(s,u,y))n.push(b)}}return n},update(s,e){s.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=Sn(s);return t&&is(s.state,e),s.docChanged||s.selectionSet||t},mount(s,e){is(e.state,s)},class:"cm-cursorLayer"});function is(s,e){e.style.animationDuration=s.facet(wt).cursorBlinkRate+"ms"}const so=ze({above:!1,markers(s){return s.state.selection.ranges.map(e=>e.empty?[]:Cr.forRange(s,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(s,e){return s.docChanged||s.selectionSet||s.viewportChanged||Sn(s)},class:"cm-selectionLayer"}),ys={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};xt&&(ys[".cm-line"].caretColor="transparent !important",ys[".cm-content"]={caretColor:"transparent !important"});const oo=p.Wl.highest(Ft.theme(ys)),So=p.Py.define({map(s,e){return s==null?null:e.mapPos(s)}}),vs=p.QQ.define({create(){return null},update(s,e){return s!=null&&(s=e.changes.mapPos(s)),e.effects.reduce((t,n)=>n.is(So)?n.value:t,s)}}),ns=di.fromClass(class{constructor(s){this.view=s,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(s){var e;let t=s.state.field(vs);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(s.startState.field(vs)!=t||s.docChanged||s.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:s}=this,e=s.state.field(vs),t=e!=null&&s.coordsAtPos(e);if(!t)return null;let n=s.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+s.scrollDOM.scrollLeft*s.scaleX,top:t.top-n.top+s.scrollDOM.scrollTop*s.scaleY,height:t.bottom-t.top}}drawCursor(s){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;s?(this.cursor.style.left=s.left/e+"px",this.cursor.style.top=s.top/t+"px",this.cursor.style.height=s.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(s){this.view.state.field(vs)!=s&&this.view.dispatch({effects:So.of(s)})}},{eventObservers:{dragover(s){this.setDropPos(this.view.posAtCoords({x:s.clientX,y:s.clientY}))},dragleave(s){(s.target==this.view.contentDOM||!this.view.contentDOM.contains(s.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function bs(){return[vs,ns]}function ko(s,e,t,n,r){e.lastIndex=0;for(let c=s.iterRange(t,n),u=t,y;!c.next().done;u+=c.value.length)if(!c.lineBreak)for(;y=e.exec(c.value);)r(u+y.index,y)}function Vr(s,e){let t=s.visibleRanges;if(t.length==1&&t[0].from==s.viewport.from&&t[0].to==s.viewport.to)return t;let n=[];for(let{from:r,to:c}of t)r=Math.max(s.state.doc.lineAt(r).from,r-e),c=Math.min(s.state.doc.lineAt(c).to,c+e),n.length&&n[n.length-1].to>=r?n[n.length-1].to=c:n.push({from:r,to:c});return n}class xs{constructor(e){const{regexp:t,decoration:n,decorate:r,boundary:c,maxLength:u=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,r)this.addMatch=(y,b,M,A)=>r(A,M,M+y[0].length,y,b);else if(typeof n=="function")this.addMatch=(y,b,M,A)=>{let F=n(y,b,M);F&&A(M,M+y[0].length,F)};else if(n)this.addMatch=(y,b,M,A)=>A(M,M+y[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=c,this.maxLength=u}createDeco(e){let t=new p.f_,n=t.add.bind(t);for(let{from:r,to:c}of Vr(e,this.maxLength))ko(e.state.doc,this.regexp,r,c,(u,y)=>this.addMatch(y,e,u,n));return t.finish()}updateDeco(e,t){let n=1e9,r=-1;return e.docChanged&&e.changes.iterChanges((c,u,y,b)=>{b>e.view.viewport.from&&y<e.view.viewport.to&&(n=Math.min(y,n),r=Math.max(b,r))}),e.viewportChanged||r-n>1e3?this.createDeco(e.view):r>-1?this.updateRange(e.view,t.map(e.changes),n,r):t}updateRange(e,t,n,r){for(let c of e.visibleRanges){let u=Math.max(c.from,n),y=Math.min(c.to,r);if(y>u){let b=e.state.doc.lineAt(u),M=b.to<y?e.state.doc.lineAt(y):b,A=Math.max(c.from,b.from),F=Math.min(c.to,M.to);if(this.boundary){for(;u>b.from;u--)if(this.boundary.test(b.text[u-1-b.from])){A=u;break}for(;y<M.to;y++)if(this.boundary.test(M.text[y-M.from])){F=y;break}}let $=[],X,_=(le,re,pe)=>$.push(pe.range(le,re));if(b==M)for(this.regexp.lastIndex=A-b.from;(X=this.regexp.exec(b.text))&&X.index<F-b.from;)this.addMatch(X,e,X.index+b.from,_);else ko(e.state.doc,this.regexp,A,F,(le,re)=>this.addMatch(re,e,le,_));t=t.update({filterFrom:A,filterTo:F,filter:(le,re)=>le<A||re>F,add:$})}}return t}}const lo=/x/.unicode!=null?"gu":"g",Co=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,lo),Go={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ao=null;function Xo(){var s;if(ao==null&&typeof document!="undefined"&&document.body){let e=document.body.style;ao=((s=e.tabSize)!==null&&s!==void 0?s:e.MozTabSize)!=null}return ao||!1}const ho=p.r$.define({combine(s){let e=(0,p.BO)(s,{render:null,specialChars:Co,addSpecialChars:null});return(e.replaceTabs=!Xo())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,lo)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,lo)),e}});function xl(s={}){return[ho.of(s),To()]}let Ao=null;function To(){return Ao||(Ao=di.fromClass(class{constructor(s){this.view=s,this.decorations=Ye.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(s.state.facet(ho)),this.decorations=this.decorator.createDeco(s)}makeDecorator(s){return new xs({regexp:s.specialChars,decoration:(e,t,n)=>{let{doc:r}=t.state,c=(0,p.gm)(e[0],0);if(c==9){let u=r.lineAt(n),y=t.state.tabSize,b=(0,p.IS)(u.text,y,n-u.from);return Ye.replace({widget:new Qo((y-b%y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[c]||(this.decorationCache[c]=Ye.replace({widget:new qo(s,c)}))},boundary:s.replaceTabs?void 0:/[^]/})}update(s){let e=s.state.facet(ho);s.startState.facet(ho)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(s.view)):this.decorations=this.decorator.updateDeco(s,this.decorations)}},{decorations:s=>s.decorations}))}const Yo="\u2022";function wl(s){return s>=32?Yo:s==10?"\u2424":String.fromCharCode(9216+s)}class qo extends Ci{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=wl(this.code),n=e.state.phrase("Control character")+" "+(Go[this.code]||"0x"+this.code.toString(16)),r=this.options.render&&this.options.render(this.code,n,t);if(r)return r;let c=document.createElement("span");return c.textContent=t,c.title=n,c.setAttribute("aria-label",n),c.className="cm-specialChar",c}ignoreEvent(){return!1}}class Qo extends Ci{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const co=null;function _o(){return[co,qn.of(s=>{var e;return((e=s.plugin(co))===null||e===void 0?void 0:e.attrs)||null})]}function el(){return Eo}const Mo=Ye.line({class:"cm-activeLine"}),Eo=di.fromClass(class{constructor(s){this.decorations=this.getDeco(s)}update(s){(s.docChanged||s.selectionSet)&&(this.decorations=this.getDeco(s.view))}getDeco(s){let e=-1,t=[];for(let n of s.state.selection.ranges){let r=s.lineBlockAt(n.head);r.from>e&&(t.push(Mo.range(r.from)),e=r.from)}return Ye.set(t)}},{decorations:s=>s.decorations});class Sl extends Ci{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?mt(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),r=Kt(t[0],n.direction!="rtl"),c=parseInt(n.lineHeight);return r.bottom-r.top>c*1.5?{left:r.left,right:r.right,top:r.top,bottom:r.top+c}:r}ignoreEvent(){return!1}}function ws(s){return di.fromClass(class{constructor(e){this.view=e,this.placeholder=s?Ye.set([Ye.widget({widget:new Sl(s),side:1}).range(0)]):Ye.none}get decorations(){return this.view.state.doc.length?Ye.none:this.placeholder}},{decorations:e=>e.decorations})}const hr=2e3;function fo(s,e,t){let n=Math.min(e.line,t.line),r=Math.max(e.line,t.line),c=[];if(e.off>hr||t.off>hr||e.col<0||t.col<0){let u=Math.min(e.off,t.off),y=Math.max(e.off,t.off);for(let b=n;b<=r;b++){let M=s.doc.line(b);M.length<=y&&c.push(p.jT.range(M.from+u,M.to+y))}}else{let u=Math.min(e.col,t.col),y=Math.max(e.col,t.col);for(let b=n;b<=r;b++){let M=s.doc.line(b),A=(0,p.Gz)(M.text,u,s.tabSize,!0);if(A<0)c.push(p.jT.cursor(M.to));else{let F=(0,p.Gz)(M.text,y,s.tabSize);c.push(p.jT.range(M.from+A,M.from+F))}}}return c}function Do(s,e){let t=s.coordsAtPos(s.viewport.from);return t?Math.round(Math.abs((t.left-e)/s.defaultCharacterWidth)):-1}function Oo(s,e){let t=s.posAtCoords({x:e.clientX,y:e.clientY},!1),n=s.state.doc.lineAt(t),r=t-n.from,c=r>hr?-1:r==n.length?Do(s,e.clientX):(0,p.IS)(n.text,s.state.tabSize,t-n.from);return{line:n.number,col:c,off:r}}function uo(s,e){let t=Oo(s,e),n=s.state.selection;return t?{update(r){if(r.docChanged){let c=r.changes.mapPos(r.startState.doc.line(t.line).from),u=r.state.doc.lineAt(c);t={line:u.number,col:t.col,off:Math.min(t.off,u.length)},n=n.map(r.changes)}},get(r,c,u){let y=Oo(s,r);if(!y)return n;let b=fo(s.state,t,y);return b.length?u?p.jT.create(b.concat(n.ranges)):p.jT.create(b):n}}:null}function Po(s){let e=(s==null?void 0:s.eventFilter)||(t=>t.altKey&&t.button==0);return Ft.mouseSelectionStyle.of((t,n)=>e(n)?uo(t,n):null)}const Ro={Alt:[18,s=>!!s.altKey],Control:[17,s=>!!s.ctrlKey],Shift:[16,s=>!!s.shiftKey],Meta:[91,s=>!!s.metaKey]},tl={style:"cursor: crosshair"};function il(s={}){let[e,t]=Ro[s.key||"Alt"],n=di.fromClass(class{constructor(r){this.view=r,this.isDown=!1}set(r){this.isDown!=r&&(this.isDown=r,this.view.update([]))}},{eventObservers:{keydown(r){this.set(r.keyCode==e||t(r))},keyup(r){(r.keyCode==e||!t(r))&&this.set(!1)},mousemove(r){this.set(t(r))}}});return[n,Ft.contentAttributes.of(r=>{var c;return!((c=r.plugin(n))===null||c===void 0)&&c.isDown?tl:null})]}const zs="-10000px";class Bo{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(r=>r),this.tooltipViews=this.tooltips.map(n)}update(e,t){var n;let r=e.state.facet(this.facet),c=r.filter(b=>b);if(r===this.input){for(let b of this.tooltipViews)b.update&&b.update(e);return!1}let u=[],y=t?[]:null;for(let b=0;b<c.length;b++){let M=c[b],A=-1;if(M){for(let F=0;F<this.tooltips.length;F++){let $=this.tooltips[F];$&&$.create==M.create&&(A=F)}if(A<0)u[b]=this.createTooltipView(M),y&&(y[b]=!!M.above);else{let F=u[b]=this.tooltipViews[A];y&&(y[b]=t[A]),F.update&&F.update(e)}}}for(let b of this.tooltipViews)u.indexOf(b)<0&&(b.dom.remove(),(n=b.destroy)===null||n===void 0||n.call(b));return t&&(y.forEach((b,M)=>t[M]=b),t.length=y.length),this.input=r,this.tooltips=c,this.tooltipViews=u,!0}}function kl(s={}){return zr.of(s)}function Lo(s){let{win:e}=s;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const zr=p.r$.define({combine:s=>{var e,t,n;return{position:C.ios?"absolute":((e=s.find(r=>r.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=s.find(r=>r.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=s.find(r=>r.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Lo}}}),Io=new WeakMap,$s=di.fromClass(class{constructor(s){this.view=s,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=s.state.facet(zr);this.position=e.position,this.parent=e.parent,this.classes=s.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Bo(s,js,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),s.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let s of this.manager.tooltipViews)this.intersectionObserver.observe(s.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(s){s.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(s,this.above);e&&this.observeIntersection();let t=e||s.geometryChanged,n=s.state.facet(zr);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let r of this.manager.tooltipViews)r.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let r of this.manager.tooltipViews)this.container.appendChild(r.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(s){let e=s.create(this.view);if(e.dom.classList.add("cm-tooltip"),s.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=zs,e.dom.style.left="0px",this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var s,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(s=t.destroy)===null||s===void 0||s.call(t);this.parent&&this.container.remove(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let s=this.view.dom.getBoundingClientRect(),e=1,t=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:r}=this.manager.tooltipViews[0];if(C.gecko)n=r.offsetParent!=this.container.ownerDocument.body;else if(r.style.top==zs&&r.style.left=="0px"){let c=r.getBoundingClientRect();n=Math.abs(c.top+1e4)>1||Math.abs(c.left)>1}}if(n||this.position=="absolute")if(this.parent){let r=this.parent.getBoundingClientRect();r.width&&r.height&&(e=r.width/this.parent.offsetWidth,t=r.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);return{editor:s,parent:this.parent?this.container.getBoundingClientRect():s,pos:this.manager.tooltips.map((r,c)=>{let u=this.manager.tooltipViews[c];return u.getCoords?u.getCoords(r.pos):this.view.coordsAtPos(r.pos)}),size:this.manager.tooltipViews.map(({dom:r})=>r.getBoundingClientRect()),space:this.view.state.facet(zr).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:n}}writeMeasure(s){var e;if(s.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let y of this.manager.tooltipViews)y.dom.style.position="absolute"}let{editor:t,space:n,scaleX:r,scaleY:c}=s,u=[];for(let y=0;y<this.manager.tooltips.length;y++){let b=this.manager.tooltips[y],M=this.manager.tooltipViews[y],{dom:A}=M,F=s.pos[y],$=s.size[y];if(!F||F.bottom<=Math.max(t.top,n.top)||F.top>=Math.min(t.bottom,n.bottom)||F.right<Math.max(t.left,n.left)-.1||F.left>Math.min(t.right,n.right)+.1){A.style.top=zs;continue}let X=b.arrow?M.dom.querySelector(".cm-tooltip-arrow"):null,_=X?7:0,le=$.right-$.left,re=(e=Io.get(M))!==null&&e!==void 0?e:$.bottom-$.top,pe=M.offset||rl,Ze=this.view.textDirection==j.LTR,ft=$.width>n.right-n.left?Ze?n.left:n.right-$.width:Ze?Math.min(F.left-(X?14:0)+pe.x,n.right-le):Math.max(n.left,F.left-le+(X?14:0)-pe.x),Ke=this.above[y];!b.strictSide&&(Ke?F.top-($.bottom-$.top)-pe.y<n.top:F.bottom+($.bottom-$.top)+pe.y>n.bottom)&&Ke==n.bottom-F.bottom>F.top-n.top&&(Ke=this.above[y]=!Ke);let ht=(Ke?F.top-n.top:n.bottom-F.bottom)-_;if(ht<re&&M.resize!==!1){if(ht<this.view.defaultLineHeight){A.style.top=zs;continue}Io.set(M,re),A.style.height=(re=ht)/c+"px"}else A.style.height&&(A.style.height="");let St=Ke?F.top-re-_-pe.y:F.bottom+_+pe.y,Hi=ft+le;if(M.overlap!==!0)for(let en of u)en.left<Hi&&en.right>ft&&en.top<St+re&&en.bottom>St&&(St=Ke?en.top-re-2-_:en.bottom+_+2);if(this.position=="absolute"?(A.style.top=(St-s.parent.top)/c+"px",A.style.left=(ft-s.parent.left)/r+"px"):(A.style.top=St/c+"px",A.style.left=ft/r+"px"),X){let en=F.left+(Ze?pe.x:-pe.x)-(ft+14-7);X.style.left=en/r+"px"}M.overlap!==!0&&u.push({left:ft,top:St,right:Hi,bottom:St+re}),A.classList.toggle("cm-tooltip-above",Ke),A.classList.toggle("cm-tooltip-below",!Ke),M.positioned&&M.positioned(s.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let s of this.manager.tooltipViews)s.dom.style.top=zs}},{eventObservers:{scroll(){this.maybeMeasure()}}}),nl=Ft.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),rl={x:0,y:0},js=p.r$.define({enables:[$s,nl]}),Ss=p.r$.define();class ks{static create(e){return new ks(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Bo(e,Ss,t=>this.createHostedView(t))}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let r=n[e];if(r!==void 0){if(t===void 0)t=r;else if(t!==r)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const sl=js.compute([Ss],s=>{let e=s.facet(Ss).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:ks.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class No{constructor(e,t,n,r,c){this.view=e,this.source=t,this.field=n,this.setHover=r,this.hoverTime=c,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let r,c=1;if(n instanceof se)r=n.posAtStart;else{if(r=e.posAtCoords(t),r==null)return;let y=e.coordsAtPos(r);if(!y||t.y<y.top||t.y>y.bottom||t.x<y.left-e.defaultCharacterWidth||t.x>y.right+e.defaultCharacterWidth)return;let b=e.bidiSpans(e.state.doc.lineAt(r)).find(A=>A.from<=r&&A.to>=r),M=b&&b.dir==j.RTL?-1:1;c=t.x<y.left?-M:M}let u=this.source(e,r,c);if(u!=null&&u.then){let y=this.pending={pos:r};u.then(b=>{this.pending==y&&(this.pending=null,b&&e.dispatch({effects:this.setHover.of(b)}))},b=>si(e.state,b,"hover tooltip"))}else u&&e.dispatch({effects:this.setHover.of(u)})}get tooltip(){let e=this.view.plugin($s),t=e?e.manager.tooltips.findIndex(n=>n.create==ks.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:r}=this;if(n&&r&&!Cl(r.dom,e)||this.pending){let{pos:c}=n||this.pending,u=(t=n==null?void 0:n.end)!==null&&t!==void 0?t:c;(c==u?this.view.posAtCoords(this.lastMove)!=c:!Fo(this.view,c,u,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of(null)})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const Zs=4;function Cl(s,e){let t=s.getBoundingClientRect();return e.clientX>=t.left-Zs&&e.clientX<=t.right+Zs&&e.clientY>=t.top-Zs&&e.clientY<=t.bottom+Zs}function Fo(s,e,t,n,r,c){let u=s.scrollDOM.getBoundingClientRect(),y=s.documentTop+s.documentPadding.top+s.contentHeight;if(u.left>n||u.right<n||u.top>r||Math.min(u.bottom,y)<r)return!1;let b=s.posAtCoords({x:n,y:r},!1);return b>=e&&b<=t}function Al(s,e={}){let t=p.Py.define(),n=p.QQ.define({create(){return null},update(r,c){if(r&&(e.hideOnChange&&(c.docChanged||c.selection)||e.hideOn&&e.hideOn(c,r)))return null;if(r&&c.docChanged){let u=c.changes.mapPos(r.pos,-1,p.gc.TrackDel);if(u==null)return null;let y=Object.assign(Object.create(null),r);y.pos=u,r.end!=null&&(y.end=c.changes.mapPos(r.end)),r=y}for(let u of c.effects)u.is(t)&&(r=u.value),u.is(Ml)&&(r=null);return r},provide:r=>Ss.from(r)});return[n,di.define(r=>new No(r,s,n,t,e.hoverTime||300)),sl]}function Tl(s,e){let t=s.plugin($s);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}function Pl(s){return s.facet(Ss).some(e=>e)}const Ml=p.Py.define(),El=null;function rs(s){let e=s.plugin($s);e&&e.maybeMeasure()}const Ar=p.r$.define({combine(s){let e,t;for(let n of s)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function ol(s){return s?[Ar.of(s)]:[]}function Wo(s,e){let t=s.plugin(ll),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const ll=di.fromClass(class{constructor(s){this.input=s.state.facet(Js),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(s));let e=s.state.facet(Ar);this.top=new $r(s,!0,e.topContainer),this.bottom=new $r(s,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(s){let e=s.state.facet(Ar);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new $r(s.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new $r(s.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=s.state.facet(Js);if(t!=this.input){let n=t.filter(b=>b),r=[],c=[],u=[],y=[];for(let b of n){let M=this.specs.indexOf(b),A;M<0?(A=b(s.view),y.push(A)):(A=this.panels[M],A.update&&A.update(s)),r.push(A),(A.top?c:u).push(A)}this.specs=n,this.panels=r,this.top.sync(c),this.bottom.sync(u);for(let b of y)b.dom.classList.add("cm-panel"),b.mount&&b.mount()}else for(let n of this.panels)n.update&&n.update(s)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:s=>Ft.scrollMargins.of(e=>{let t=e.plugin(s);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class $r{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Ks(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Ks(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Ks(s){let e=s.nextSibling;return s.remove(),e}const Js=p.r$.define({enables:ll});class Ai extends p.uU{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Ai.prototype.elementClass="",Ai.prototype.toDOM=void 0,Ai.prototype.mapMode=p.gc.TrackBefore,Ai.prototype.startSide=Ai.prototype.endSide=-1,Ai.prototype.point=!0;const po=p.r$.define(),al={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>p.Xs.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Cs=p.r$.define();function Ho(s){return[go(),Cs.of(Object.assign(Object.assign({},al),s))]}const mo=p.r$.define({combine:s=>s.some(e=>e)});function go(s){let e=[hl];return s&&s.fixed===!1&&e.push(mo.of(!0)),e}const hl=di.fromClass(class{constructor(s){this.view=s,this.prevViewport=s.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=s.state.facet(Cs).map(e=>new Us(s,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!s.state.facet(mo),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),s.scrollDOM.insertBefore(this.dom,s.contentDOM)}update(s){if(this.updateGutters(s)){let e=this.prevViewport,t=s.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}s.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(mo)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=s.view.viewport}syncGutters(s){let e=this.dom.nextSibling;s&&this.dom.remove();let t=p.Xs.iter(this.view.state.facet(po),this.view.viewport.from),n=[],r=this.gutters.map(c=>new Vo(c,this.view.viewport,-this.view.documentPadding.top));for(let c of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(c.type)){let u=!0;for(let y of c.type)if(y.type==it.Text&&u){yo(t,n,y.from);for(let b of r)b.line(this.view,y,n);u=!1}else if(y.widget)for(let b of r)b.widget(this.view,y)}else if(c.type==it.Text){yo(t,n,c.from);for(let u of r)u.line(this.view,c,n)}else if(c.widget)for(let u of r)u.widget(this.view,c);for(let c of r)c.finish();s&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(s){let e=s.startState.facet(Cs),t=s.state.facet(Cs),n=s.docChanged||s.heightChanged||s.viewportChanged||!p.Xs.eq(s.startState.facet(po),s.state.facet(po),s.view.viewport.from,s.view.viewport.to);if(e==t)for(let r of this.gutters)r.update(s)&&(n=!0);else{n=!0;let r=[];for(let c of t){let u=e.indexOf(c);u<0?r.push(new Us(this.view,c)):(this.gutters[u].update(s),r.push(this.gutters[u]))}for(let c of this.gutters)c.dom.remove(),r.indexOf(c)<0&&c.destroy();for(let c of r)this.dom.appendChild(c.dom);this.gutters=r}return n}destroy(){for(let s of this.gutters)s.destroy();this.dom.remove()}},{provide:s=>Ft.scrollMargins.of(e=>{let t=e.plugin(s);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==j.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function cl(s){return Array.isArray(s)?s:[s]}function yo(s,e,t){for(;s.value&&s.from<=t;)s.from==t&&e.push(s.value),s.next()}class Vo{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=p.Xs.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:r}=this,c=(t.top-this.height)/e.scaleY,u=t.height/e.scaleY;if(this.i==r.elements.length){let y=new fl(e,u,c,n);r.elements.push(y),r.dom.appendChild(y.dom)}else r.elements[this.i].update(e,u,c,n);this.height=t.bottom,this.i++}line(e,t,n){let r=[];yo(this.cursor,r,t.from),n.length&&(r=r.concat(n));let c=this.gutter.config.lineMarker(e,t,r);c&&r.unshift(c);let u=this.gutter;r.length==0&&!u.config.renderEmptyElements||this.addElement(e,t,r)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Us{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,r=>{let c=r.target,u;if(c!=this.dom&&this.dom.contains(c)){for(;c.parentNode!=this.dom;)c=c.parentNode;let b=c.getBoundingClientRect();u=(b.top+b.bottom)/2}else u=r.clientY;let y=e.lineBlockAtHeight(u-e.documentTop);t.domEventHandlers[n](e,y,r)&&r.preventDefault()});this.markers=cl(t.markers(e)),t.initialSpacer&&(this.spacer=new fl(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=cl(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let r=this.config.updateSpacer(this.spacer.markers[0],e);r!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[r])}let n=e.view.viewport;return!p.Xs.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class fl{constructor(e,t,n,r){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,r)}update(e,t,n,r){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Dl(this.markers,r)||this.setMarkers(e,r)}setMarkers(e,t){let n="cm-gutterElement",r=this.dom.firstChild;for(let c=0,u=0;;){let y=u,b=c<t.length?t[c++]:null,M=!1;if(b){let A=b.elementClass;A&&(n+=" "+A);for(let F=u;F<this.markers.length;F++)if(this.markers[F].compare(b)){y=F,M=!0;break}}else y=this.markers.length;for(;u<y;){let A=this.markers[u++];if(A.toDOM){A.destroy(r);let F=r.nextSibling;r.remove(),r=F}}if(!b)break;b.toDOM&&(M?r=r.nextSibling:this.dom.insertBefore(b.toDOM(e),r)),M&&u++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function Dl(s,e){if(s.length!=e.length)return!1;for(let t=0;t<s.length;t++)if(!s[t].compare(e[t]))return!1;return!0}const zo=p.r$.define(),jr=p.r$.define({combine(s){return(0,p.BO)(s,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let r in t){let c=n[r],u=t[r];n[r]=c?(y,b,M)=>c(y,b,M)||u(y,b,M):u}return n}})}});class vo extends Ai{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Gs(s,e){return s.state.facet(jr).formatNumber(e,s.state)}const Xs=Cs.compute([jr],s=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(zo)},lineMarker(e,t,n){return n.some(r=>r.toDOM)?null:new vo(Gs(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(jr)!=e.state.facet(jr),initialSpacer(e){return new vo(Gs(e,As(e.state.doc.lines)))},updateSpacer(e,t){let n=Gs(t.view,As(t.view.state.doc.lines));return n==e.number?e:new vo(n)},domEventHandlers:s.facet(jr).domEventHandlers}));function Ys(s={}){return[jr.of(s),go(),Xs]}function As(s){let e=9;for(;e<s;)e=e*10+9;return e}const ul=new class extends Ai{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},$o=po.compute(["selection"],s=>{let e=[],t=-1;for(let n of s.selection.ranges){let r=s.doc.lineAt(n.head).from;r>t&&(t=r,e.push(ul.range(r)))}return p.Xs.of(e)});function dl(){return $o}const jo=new Map;function pl(s){let e=jo.get(s);return e||jo.set(s,e=Ye.mark({attributes:s==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":s.replace(/ /g,"\xB7")}})),e}function Zo(s){return di.define(e=>({decorations:s.createDeco(e),update(t){this.decorations=s.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const ml=Zo(new xs({regexp:/\t| +/g,decoration:s=>pl(s[0]),boundary:/\S/}));function gl(){return ml}const bo=Zo(new xs({regexp:/\s+$/g,decoration:Ye.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function yl(){return bo}const Ol={HeightMap:je,HeightOracle:yt,MeasuredHeights:Ue,QueryType:Ae,ChangedRange:D,computeOrder:pr,moveVisually:O}},21649:(kn,Wt,q)=>{q.d(Wt,{Jq:()=>Ie,Lj:()=>vt,_b:()=>Xe,i9:()=>ki,md:()=>L,mp:()=>nt,vj:()=>$e});const p=1024;let Se=0;class de{constructor(w,C){this.from=w,this.to=C}}class L{constructor(w={}){this.id=Se++,this.perNode=!!w.perNode,this.deserialize=w.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(w){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof w!="function"&&(w=Ie.match(w)),C=>{let N=w(C);return N===void 0?null:[this,N]}}}L.closedBy=new L({deserialize:ie=>ie.split(" ")}),L.openedBy=new L({deserialize:ie=>ie.split(" ")}),L.group=new L({deserialize:ie=>ie.split(" ")}),L.contextHash=new L({perNode:!0}),L.lookAhead=new L({perNode:!0}),L.mounted=new L({perNode:!0});class G{constructor(w,C,N){this.tree=w,this.overlay=C,this.parser=N}static get(w){return w&&w.props&&w.props[L.mounted.id]}}const Ce=Object.create(null);class Ie{constructor(w,C,N,I=0){this.name=w,this.props=C,this.id=N,this.flags=I}static define(w){let C=w.props&&w.props.length?Object.create(null):Ce,N=(w.top?1:0)|(w.skipped?2:0)|(w.error?4:0)|(w.name==null?8:0),I=new Ie(w.name||"",C,w.id,N);if(w.props){for(let Z of w.props)if(Array.isArray(Z)||(Z=Z(I)),Z){if(Z[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");C[Z[0].id]=Z[1]}}return I}prop(w){return this.props[w.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(w){if(typeof w=="string"){if(this.name==w)return!0;let C=this.prop(L.group);return C?C.indexOf(w)>-1:!1}return this.id==w}static match(w){let C=Object.create(null);for(let N in w)for(let I of N.split(" "))C[I]=w[N];return N=>{for(let I=N.prop(L.group),Z=-1;Z<(I?I.length:0);Z++){let ee=C[Z<0?N.name:I[Z]];if(ee)return ee}}}}Ie.none=new Ie("",Object.create(null),0,8);class vt{constructor(w){this.types=w;for(let C=0;C<w.length;C++)if(w[C].id!=C)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...w){let C=[];for(let N of this.types){let I=null;for(let Z of w){let ee=Z(N);ee&&(I||(I=Object.assign({},N.props)),I[ee[0].id]=ee[1])}C.push(I?new Ie(N.name,I,N.id,N.flags):N)}return new vt(C)}}const dt=new WeakMap,bt=new WeakMap;var $e;(function(ie){ie[ie.ExcludeBuffers=1]="ExcludeBuffers",ie[ie.IncludeAnonymous=2]="IncludeAnonymous",ie[ie.IgnoreMounts=4]="IgnoreMounts",ie[ie.IgnoreOverlays=8]="IgnoreOverlays"})($e||($e={}));class nt{constructor(w,C,N,I,Z){if(this.type=w,this.children=C,this.positions=N,this.length=I,this.props=null,Z&&Z.length){this.props=Object.create(null);for(let[ee,se]of Z)this.props[typeof ee=="number"?ee:ee.id]=se}}toString(){let w=G.get(this);if(w&&!w.overlay)return w.tree.toString();let C="";for(let N of this.children){let I=N.toString();I&&(C&&(C+=","),C+=I)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(C.length?"("+C+")":""):C}cursor(w=0){return new Ot(this.topNode,w)}cursorAt(w,C=0,N=0){let I=dt.get(this)||this.topNode,Z=new Ot(I);return Z.moveTo(w,C),dt.set(this,Z._tree),Z}get topNode(){return new pt(this,0,0,null)}resolve(w,C=0){let N=Xt(dt.get(this)||this.topNode,w,C,!1);return dt.set(this,N),N}resolveInner(w,C=0){let N=Xt(bt.get(this)||this.topNode,w,C,!0);return bt.set(this,N),N}resolveStack(w,C=0){return Jt(this,w,C)}iterate(w){let{enter:C,leave:N,from:I=0,to:Z=this.length}=w,ee=w.mode||0,se=(ee&$e.IncludeAnonymous)>0;for(let xe=this.cursor(ee|$e.IncludeAnonymous);;){let He=!1;if(xe.from<=Z&&xe.to>=I&&(!se&&xe.type.isAnonymous||C(xe)!==!1)){if(xe.firstChild())continue;He=!0}for(;He&&N&&(se||!xe.type.isAnonymous)&&N(xe),!xe.nextSibling();){if(!xe.parent())return;He=!0}}}prop(w){return w.perNode?this.props?this.props[w.id]:void 0:this.type.prop(w)}get propValues(){let w=[];if(this.props)for(let C in this.props)w.push([+C,this.props[C]]);return w}balance(w={}){return this.children.length<=8?this:Si(Ie.none,this.children,this.positions,0,this.children.length,0,this.length,(C,N,I)=>new nt(this.type,C,N,I,this.propValues),w.makeTree||((C,N,I)=>new nt(Ie.none,C,N,I)))}static build(w){return ct(w)}}nt.empty=new nt(Ie.none,[],[],0);class _e{constructor(w,C){this.buffer=w,this.index=C}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new _e(this.buffer,this.index)}}class mt{constructor(w,C,N){this.buffer=w,this.length=C,this.set=N}get type(){return Ie.none}toString(){let w=[];for(let C=0;C<this.buffer.length;)w.push(this.childString(C)),C=this.buffer[C+3];return w.join(",")}childString(w){let C=this.buffer[w],N=this.buffer[w+3],I=this.set.types[C],Z=I.name;if(/\W/.test(Z)&&!I.isError&&(Z=JSON.stringify(Z)),w+=4,N==w)return Z;let ee=[];for(;w<N;)ee.push(this.childString(w)),w=this.buffer[w+3];return Z+"("+ee.join(",")+")"}findChild(w,C,N,I,Z){let{buffer:ee}=this,se=-1;for(let xe=w;xe!=C&&!(yi(Z,I,ee[xe+1],ee[xe+2])&&(se=xe,N>0));xe=ee[xe+3]);return se}slice(w,C,N){let I=this.buffer,Z=new Uint16Array(C-w),ee=0;for(let se=w,xe=0;se<C;){Z[xe++]=I[se++],Z[xe++]=I[se++]-N;let He=Z[xe++]=I[se++]-N;Z[xe++]=I[se++]-w,ee=Math.max(ee,He)}return new mt(Z,ee,this.set)}}function yi(ie,w,C,N){switch(ie){case-2:return C<w;case-1:return N>=w&&C<w;case 0:return C<w&&N>w;case 1:return C<=w&&N>w;case 2:return N>w;case 4:return!0}}function Xt(ie,w,C,N){for(var I;ie.from==ie.to||(C<1?ie.from>=w:ie.from>w)||(C>-1?ie.to<=w:ie.to<w);){let ee=!N&&ie instanceof pt&&ie.index<0?null:ie.parent;if(!ee)return ie;ie=ee}let Z=N?0:$e.IgnoreOverlays;if(N)for(let ee=ie,se=ee.parent;se;ee=se,se=ee.parent)ee instanceof pt&&ee.index<0&&((I=se.enter(w,C,Z))===null||I===void 0?void 0:I.from)!=ee.from&&(ie=se);for(;;){let ee=ie.enter(w,C,Z);if(!ee)return ie;ie=ee}}class me{cursor(w=0){return new Ot(this,w)}getChild(w,C=null,N=null){let I=Kt(this,w,C,N);return I.length?I[0]:null}getChildren(w,C=null,N=null){return Kt(this,w,C,N)}resolve(w,C=0){return Xt(this,w,C,!1)}resolveInner(w,C=0){return Xt(this,w,C,!0)}matchContext(w){return wi(this,w)}enterUnfinishedNodesBefore(w){let C=this.childBefore(w),N=this;for(;C;){let I=C.lastChild;if(!I||I.to!=C.to)break;I.type.isError&&I.from==I.to?(N=C,C=I.prevSibling):C=I}return N}get node(){return this}get next(){return this.parent}}class pt extends me{constructor(w,C,N,I){super(),this._tree=w,this.from=C,this.index=N,this._parent=I}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(w,C,N,I,Z=0){for(let ee=this;;){for(let{children:se,positions:xe}=ee._tree,He=C>0?se.length:-1;w!=He;w+=C){let Oe=se[w],Je=xe[w]+ee.from;if(yi(I,N,Je,Je+Oe.length)){if(Oe instanceof mt){if(Z&$e.ExcludeBuffers)continue;let tt=Oe.findChild(0,Oe.buffer.length,C,N-Je,I);if(tt>-1)return new Et(new ui(ee,Oe,w,Je),null,tt)}else if(Z&$e.IncludeAnonymous||!Oe.type.isAnonymous||Tt(Oe)){let tt;if(!(Z&$e.IgnoreMounts)&&(tt=G.get(Oe))&&!tt.overlay)return new pt(tt.tree,Je,w,ee);let rt=new pt(Oe,Je,w,ee);return Z&$e.IncludeAnonymous||!rt.type.isAnonymous?rt:rt.nextChild(C<0?Oe.children.length-1:0,C,N,I)}}}if(Z&$e.IncludeAnonymous||!ee.type.isAnonymous||(ee.index>=0?w=ee.index+C:w=C<0?-1:ee._parent._tree.children.length,ee=ee._parent,!ee))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(w){return this.nextChild(0,1,w,2)}childBefore(w){return this.nextChild(this._tree.children.length-1,-1,w,-2)}enter(w,C,N=0){let I;if(!(N&$e.IgnoreOverlays)&&(I=G.get(this._tree))&&I.overlay){let Z=w-this.from;for(let{from:ee,to:se}of I.overlay)if((C>0?ee<=Z:ee<Z)&&(C<0?se>=Z:se>Z))return new pt(I.tree,I.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,w,C,N)}nextSignificantParent(){let w=this;for(;w.type.isAnonymous&&w._parent;)w=w._parent;return w}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Kt(ie,w,C,N){let I=ie.cursor(),Z=[];if(!I.firstChild())return Z;if(C!=null){for(;!I.type.is(C);)if(!I.nextSibling())return Z}for(;;){if(N!=null&&I.type.is(N))return Z;if(I.type.is(w)&&Z.push(I.node),!I.nextSibling())return N==null?Z:[]}}function wi(ie,w,C=w.length-1){for(let N=ie.parent;C>=0;N=N.parent){if(!N)return!1;if(!N.type.isAnonymous){if(w[C]&&w[C]!=N.name)return!1;C--}}return!0}class ui{constructor(w,C,N,I){this.parent=w,this.buffer=C,this.index=N,this.start=I}}class Et extends me{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(w,C,N){super(),this.context=w,this._parent=C,this.index=N,this.type=w.buffer.set.types[w.buffer.buffer[N]]}child(w,C,N){let{buffer:I}=this.context,Z=I.findChild(this.index+4,I.buffer[this.index+3],w,C-this.context.start,N);return Z<0?null:new Et(this.context,this,Z)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(w){return this.child(1,w,2)}childBefore(w){return this.child(-1,w,-2)}enter(w,C,N=0){if(N&$e.ExcludeBuffers)return null;let{buffer:I}=this.context,Z=I.findChild(this.index+4,I.buffer[this.index+3],C>0?1:-1,w-this.context.start,C);return Z<0?null:new Et(this.context,this,Z)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(w){return this._parent?null:this.context.parent.nextChild(this.context.index+w,w,0,4)}get nextSibling(){let{buffer:w}=this.context,C=w.buffer[this.index+3];return C<(this._parent?w.buffer[this._parent.index+3]:w.buffer.length)?new Et(this.context,this._parent,C):this.externalSibling(1)}get prevSibling(){let{buffer:w}=this.context,C=this._parent?this._parent.index+4:0;return this.index==C?this.externalSibling(-1):new Et(this.context,this._parent,w.findChild(C,this.index,-1,0,4))}get tree(){return null}toTree(){let w=[],C=[],{buffer:N}=this.context,I=this.index+4,Z=N.buffer[this.index+3];if(Z>I){let ee=N.buffer[this.index+1];w.push(N.slice(I,Z,ee)),C.push(0)}return new nt(this.type,w,C,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function ii(ie){if(!ie.length)return null;let w=0,C=ie[0];for(let Z=1;Z<ie.length;Z++){let ee=ie[Z];(ee.from>C.from||ee.to<C.to)&&(C=ee,w=Z)}let N=C instanceof pt&&C.index<0?null:C.parent,I=ie.slice();return N?I[w]=N:I.splice(w,1),new Di(I,C)}class Di{constructor(w,C){this.heads=w,this.node=C}get next(){return ii(this.heads)}}function Jt(ie,w,C){let N=ie.resolveInner(w,C),I=null;for(let Z=N instanceof pt?N:N.context.parent;Z;Z=Z.parent)if(Z.index<0){let ee=Z.parent;(I||(I=[N])).push(ee.resolve(w,C)),Z=ee}else{let ee=G.get(Z.tree);if(ee&&ee.overlay&&ee.overlay[0].from<=w&&ee.overlay[ee.overlay.length-1].to>=w){let se=new pt(ee.tree,ee.overlay[0].from+Z.from,-1,Z);(I||(I=[N])).push(Xt(se,w,C,!1))}}return I?ii(I):N}class Ot{get name(){return this.type.name}constructor(w,C=0){if(this.mode=C,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,w instanceof pt)this.yieldNode(w);else{this._tree=w.context.parent,this.buffer=w.context;for(let N=w._parent;N;N=N._parent)this.stack.unshift(N.index);this.bufferNode=w,this.yieldBuf(w.index)}}yieldNode(w){return w?(this._tree=w,this.type=w.type,this.from=w.from,this.to=w.to,!0):!1}yieldBuf(w,C){this.index=w;let{start:N,buffer:I}=this.buffer;return this.type=C||I.set.types[I.buffer[w]],this.from=N+I.buffer[w+1],this.to=N+I.buffer[w+2],!0}yield(w){return w?w instanceof pt?(this.buffer=null,this.yieldNode(w)):(this.buffer=w.context,this.yieldBuf(w.index,w.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(w,C,N){if(!this.buffer)return this.yield(this._tree.nextChild(w<0?this._tree._tree.children.length-1:0,w,C,N,this.mode));let{buffer:I}=this.buffer,Z=I.findChild(this.index+4,I.buffer[this.index+3],w,C-this.buffer.start,N);return Z<0?!1:(this.stack.push(this.index),this.yieldBuf(Z))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(w){return this.enterChild(1,w,2)}childBefore(w){return this.enterChild(-1,w,-2)}enter(w,C,N=this.mode){return this.buffer?N&$e.ExcludeBuffers?!1:this.enterChild(1,w,C):this.yield(this._tree.enter(w,C,N))}parent(){if(!this.buffer)return this.yieldNode(this.mode&$e.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let w=this.mode&$e.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(w)}sibling(w){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+w,w,0,4,this.mode)):!1;let{buffer:C}=this.buffer,N=this.stack.length-1;if(w<0){let I=N<0?0:this.stack[N]+4;if(this.index!=I)return this.yieldBuf(C.findChild(I,this.index,-1,0,4))}else{let I=C.buffer[this.index+3];if(I<(N<0?C.buffer.length:C.buffer[this.stack[N]+3]))return this.yieldBuf(I)}return N<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+w,w,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(w){let C,N,{buffer:I}=this;if(I){if(w>0){if(this.index<I.buffer.buffer.length)return!1}else for(let Z=0;Z<this.index;Z++)if(I.buffer.buffer[Z+3]<this.index)return!1;({index:C,parent:N}=I)}else({index:C,_parent:N}=this._tree);for(;N;{index:C,_parent:N}=N)if(C>-1)for(let Z=C+w,ee=w<0?-1:N._tree.children.length;Z!=ee;Z+=w){let se=N._tree.children[Z];if(this.mode&$e.IncludeAnonymous||se instanceof mt||!se.type.isAnonymous||Tt(se))return!1}return!0}move(w,C){if(C&&this.enterChild(w,0,4))return!0;for(;;){if(this.sibling(w))return!0;if(this.atLastNode(w)||!this.parent())return!1}}next(w=!0){return this.move(1,w)}prev(w=!0){return this.move(-1,w)}moveTo(w,C=0){for(;(this.from==this.to||(C<1?this.from>=w:this.from>w)||(C>-1?this.to<=w:this.to<w))&&this.parent(););for(;this.enterChild(1,w,C););return this}get node(){if(!this.buffer)return this._tree;let w=this.bufferNode,C=null,N=0;if(w&&w.context==this.buffer){e:for(let I=this.index,Z=this.stack.length;Z>=0;){for(let ee=w;ee;ee=ee._parent)if(ee.index==I){if(I==this.index)return ee;C=ee,N=Z+1;break e}I=this.stack[--Z]}}for(let I=N;I<this.stack.length;I++)C=new Et(this.buffer,C,this.stack[I]);return this.bufferNode=new Et(this.buffer,C,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(w,C){for(let N=0;;){let I=!1;if(this.type.isAnonymous||w(this)!==!1){if(this.firstChild()){N++;continue}this.type.isAnonymous||(I=!0)}for(;I&&C&&C(this),I=this.type.isAnonymous,!this.nextSibling();){if(!N)return;this.parent(),N--,I=!0}}}matchContext(w){if(!this.buffer)return wi(this.node,w);let{buffer:C}=this.buffer,{types:N}=C.set;for(let I=w.length-1,Z=this.stack.length-1;I>=0;Z--){if(Z<0)return wi(this.node,w,I);let ee=N[C.buffer[this.stack[Z]]];if(!ee.isAnonymous){if(w[I]&&w[I]!=ee.name)return!1;I--}}return!0}}function Tt(ie){return ie.children.some(w=>w instanceof mt||!w.type.isAnonymous||Tt(w))}function ct(ie){var w;let{buffer:C,nodeSet:N,maxBufferLength:I=p,reused:Z=[],minRepeatType:ee=N.types.length}=ie,se=Array.isArray(C)?new _e(C,C.length):C,xe=N.types,He=0,Oe=0;function Je(it,Ye,We,Ut,st,ot){let{id:gt,start:at,end:Lt,size:$t}=se,qe=Oe;for(;$t<0;)if(se.next(),$t==-1){let Ti=Z[gt];We.push(Ti),Ut.push(at-it);return}else if($t==-3){He=gt;return}else if($t==-4){Oe=gt;return}else throw new RangeError(`Unrecognized record size: ${$t}`);let Vi=xe[gt],fi,vi,tn=at-it;if(Lt-at<=I&&(vi=Vt(se.pos-Ye,st))){let Ti=new Uint16Array(vi.size-vi.skip),Ht=se.pos-vi.size,Ni=Ti.length;for(;se.pos>Ht;)Ni=zt(vi.start,Ti,Ni);fi=new mt(Ti,Lt-vi.start,N),tn=vi.start-it}else{let Ti=se.pos-$t;se.next();let Ht=[],Ni=[],zi=gt>=ee?gt:-1,Yi=0,$i=Lt;for(;se.pos>Ti;)zi>=0&&se.id==zi&&se.size>=0?(se.end<=$i-I&&(ei(Ht,Ni,at,Yi,se.end,$i,zi,qe),Yi=Ht.length,$i=se.end),se.next()):ot>2500?tt(at,Ti,Ht,Ni):Je(at,Ti,Ht,Ni,zi,ot+1);if(zi>=0&&Yi>0&&Yi<Ht.length&&ei(Ht,Ni,at,Yi,at,$i,zi,qe),Ht.reverse(),Ni.reverse(),zi>-1&&Yi>0){let nn=rt(Vi);fi=Si(Vi,Ht,Ni,0,Ht.length,0,Lt-at,nn,nn)}else fi=ci(Vi,Ht,Ni,Lt-at,qe-Lt)}We.push(fi),Ut.push(tn)}function tt(it,Ye,We,Ut){let st=[],ot=0,gt=-1;for(;se.pos>Ye;){let{id:at,start:Lt,end:$t,size:qe}=se;if(qe>4)se.next();else{if(gt>-1&&Lt<gt)break;gt<0&&(gt=$t-I),st.push(at,Lt,$t),ot++,se.next()}}if(ot){let at=new Uint16Array(ot*4),Lt=st[st.length-2];for(let $t=st.length-3,qe=0;$t>=0;$t-=3)at[qe++]=st[$t],at[qe++]=st[$t+1]-Lt,at[qe++]=st[$t+2]-Lt,at[qe++]=qe;We.push(new mt(at,st[2]-Lt,N)),Ut.push(Lt-it)}}function rt(it){return(Ye,We,Ut)=>{let st=0,ot=Ye.length-1,gt,at;if(ot>=0&&(gt=Ye[ot])instanceof nt){if(!ot&&gt.type==it&&gt.length==Ut)return gt;(at=gt.prop(L.lookAhead))&&(st=We[ot]+gt.length+at)}return ci(it,Ye,We,Ut,st)}}function ei(it,Ye,We,Ut,st,ot,gt,at){let Lt=[],$t=[];for(;it.length>Ut;)Lt.push(it.pop()),$t.push(Ye.pop()+We-st);it.push(ci(N.types[gt],Lt,$t,ot-st,at-ot)),Ye.push(st-We)}function ci(it,Ye,We,Ut,st=0,ot){if(He){let gt=[L.contextHash,He];ot=ot?[gt].concat(ot):[gt]}if(st>25){let gt=[L.lookAhead,st];ot=ot?[gt].concat(ot):[gt]}return new nt(it,Ye,We,Ut,ot)}function Vt(it,Ye){let We=se.fork(),Ut=0,st=0,ot=0,gt=We.end-I,at={size:0,start:0,skip:0};e:for(let Lt=We.pos-it;We.pos>Lt;){let $t=We.size;if(We.id==Ye&&$t>=0){at.size=Ut,at.start=st,at.skip=ot,ot+=4,Ut+=4,We.next();continue}let qe=We.pos-$t;if($t<0||qe<Lt||We.start<gt)break;let Vi=We.id>=ee?4:0,fi=We.start;for(We.next();We.pos>qe;){if(We.size<0)if(We.size==-3)Vi+=4;else break e;else We.id>=ee&&(Vi+=4);We.next()}st=fi,Ut+=$t,ot+=Vi}return(Ye<0||Ut==it)&&(at.size=Ut,at.start=st,at.skip=ot),at.size>4?at:void 0}function zt(it,Ye,We){let{id:Ut,start:st,end:ot,size:gt}=se;if(se.next(),gt>=0&&Ut<ee){let at=We;if(gt>4){let Lt=se.pos-(gt-4);for(;se.pos>Lt;)We=zt(it,Ye,We)}Ye[--We]=at,Ye[--We]=ot-it,Ye[--We]=st-it,Ye[--We]=Ut}else gt==-3?He=Ut:gt==-4&&(Oe=Ut);return We}let Ct=[],Bt=[];for(;se.pos>0;)Je(ie.start||0,ie.bufferStart||0,Ct,Bt,-1,0);let Ci=(w=ie.length)!==null&&w!==void 0?w:Ct.length?Bt[0]+Ct[0].length:0;return new nt(xe[ie.topID],Ct.reverse(),Bt.reverse(),Ci)}const Yt=new WeakMap;function ri(ie,w){if(!ie.isAnonymous||w instanceof mt||w.type!=ie)return 1;let C=Yt.get(w);if(C==null){C=1;for(let N of w.children){if(N.type!=ie||!(N instanceof nt)){C=1;break}C+=ri(ie,N)}Yt.set(w,C)}return C}function Si(ie,w,C,N,I,Z,ee,se,xe){let He=0;for(let ei=N;ei<I;ei++)He+=ri(ie,w[ei]);let Oe=Math.ceil(He*1.5/8),Je=[],tt=[];function rt(ei,ci,Vt,zt,Ct){for(let Bt=Vt;Bt<zt;){let Ci=Bt,it=ci[Bt],Ye=ri(ie,ei[Bt]);for(Bt++;Bt<zt;Bt++){let We=ri(ie,ei[Bt]);if(Ye+We>=Oe)break;Ye+=We}if(Bt==Ci+1){if(Ye>Oe){let We=ei[Ci];rt(We.children,We.positions,0,We.children.length,ci[Ci]+Ct);continue}Je.push(ei[Ci])}else{let We=ci[Bt-1]+ei[Bt-1].length-it;Je.push(Si(ie,ei,ci,Ci,Bt,it,We,null,xe))}tt.push(it+Ct-Z)}}return rt(w,C,N,I,0),(se||xe)(Je,tt,ee)}class Ge{constructor(){this.map=new WeakMap}setBuffer(w,C,N){let I=this.map.get(w);I||this.map.set(w,I=new Map),I.set(C,N)}getBuffer(w,C){let N=this.map.get(w);return N&&N.get(C)}set(w,C){w instanceof Et?this.setBuffer(w.context.buffer,w.index,C):w instanceof pt&&this.map.set(w.tree,C)}get(w){return w instanceof Et?this.getBuffer(w.context.buffer,w.index):w instanceof pt?this.map.get(w.tree):void 0}cursorSet(w,C){w.buffer?this.setBuffer(w.buffer.buffer,w.index,C):this.map.set(w.tree,C)}cursorGet(w){return w.buffer?this.getBuffer(w.buffer.buffer,w.index):this.map.get(w.tree)}}class ki{constructor(w,C,N,I,Z=!1,ee=!1){this.from=w,this.to=C,this.tree=N,this.offset=I,this.open=(Z?1:0)|(ee?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(w,C=[],N=!1){let I=[new ki(0,w.length,w,0,!1,N)];for(let Z of C)Z.to>w.length&&I.push(Z);return I}static applyChanges(w,C,N=128){if(!C.length)return w;let I=[],Z=1,ee=w.length?w[0]:null;for(let se=0,xe=0,He=0;;se++){let Oe=se<C.length?C[se]:null,Je=Oe?Oe.fromA:1e9;if(Je-xe>=N)for(;ee&&ee.from<Je;){let tt=ee;if(xe>=tt.from||Je<=tt.to||He){let rt=Math.max(tt.from,xe)-He,ei=Math.min(tt.to,Je)-He;tt=rt>=ei?null:new ki(rt,ei,tt.tree,tt.offset+He,se>0,!!Oe)}if(tt&&I.push(tt),ee.to>Je)break;ee=Z<w.length?w[Z++]:null}if(!Oe)break;xe=Oe.toA,He=Oe.toA-Oe.toB}return I}}class Xe{startParse(w,C,N){return typeof w=="string"&&(w=new oe(w)),N=N?N.length?N.map(I=>new de(I.from,I.to)):[new de(0,0)]:[new de(0,w.length)],this.createParse(w,C||[],N)}parse(w,C,N){let I=this.startParse(w,C,N);for(;;){let Z=I.advance();if(Z)return Z}}}class oe{constructor(w){this.string=w}get length(){return this.string.length}chunk(w){return this.string.slice(w)}get lineChunks(){return!1}read(w,C){return this.string.slice(w,C)}}function ye(ie){return(w,C,N,I)=>new lt(w,ie,C,N,I)}class ke{constructor(w,C,N,I,Z){this.parser=w,this.parse=C,this.overlay=N,this.target=I,this.from=Z}}function Me(ie){if(!ie.length||ie.some(w=>w.from>=w.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(ie))}class Fe{constructor(w,C,N,I,Z,ee,se){this.parser=w,this.predicate=C,this.mounts=N,this.index=I,this.start=Z,this.target=ee,this.prev=se,this.depth=0,this.ranges=[]}}const Dt=new L({perNode:!0});class lt{constructor(w,C,N,I,Z){this.nest=C,this.input=N,this.fragments=I,this.ranges=Z,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=w}advance(){if(this.baseParse){let N=this.baseParse.advance();if(!N)return null;if(this.baseParse=null,this.baseTree=N,this.startInner(),this.stoppedAt!=null)for(let I of this.inner)I.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let N=this.baseTree;return this.stoppedAt!=null&&(N=new nt(N.type,N.children,N.positions,N.length,N.propValues.concat([[Dt,this.stoppedAt]]))),N}let w=this.inner[this.innerDone],C=w.parse.advance();if(C){this.innerDone++;let N=Object.assign(Object.create(null),w.target.props);N[L.mounted.id]=new G(C,w.overlay,w.parser),w.target.props=N}return null}get parsedPos(){if(this.baseParse)return 0;let w=this.input.length;for(let C=this.innerDone;C<this.inner.length;C++)this.inner[C].from<w&&(w=Math.min(w,this.inner[C].parse.parsedPos));return w}stopAt(w){if(this.stoppedAt=w,this.baseParse)this.baseParse.stopAt(w);else for(let C=this.innerDone;C<this.inner.length;C++)this.inner[C].parse.stopAt(w)}startInner(){let w=new kt(this.fragments),C=null,N=null,I=new Ot(new pt(this.baseTree,this.ranges[0].from,0,null),$e.IncludeAnonymous|$e.IgnoreMounts);e:for(let Z,ee;;){let se=!0,xe;if(this.stoppedAt!=null&&I.from>=this.stoppedAt)se=!1;else if(w.hasNode(I)){if(C){let He=C.mounts.find(Oe=>Oe.frag.from<=I.from&&Oe.frag.to>=I.to&&Oe.mount.overlay);if(He)for(let Oe of He.mount.overlay){let Je=Oe.from+He.pos,tt=Oe.to+He.pos;Je>=I.from&&tt<=I.to&&!C.ranges.some(rt=>rt.from<tt&&rt.to>Je)&&C.ranges.push({from:Je,to:tt})}}se=!1}else if(N&&(ee=Qt(N.ranges,I.from,I.to)))se=ee!=2;else if(!I.type.isAnonymous&&(Z=this.nest(I,this.input))&&(I.from<I.to||!Z.overlay)){I.tree||Li(I);let He=w.findMounts(I.from,Z.parser);if(typeof Z.overlay=="function")C=new Fe(Z.parser,Z.overlay,He,this.inner.length,I.from,I.tree,C);else{let Oe=_t(this.ranges,Z.overlay||(I.from<I.to?[new de(I.from,I.to)]:[]));Oe.length&&Me(Oe),(Oe.length||!Z.overlay)&&this.inner.push(new ke(Z.parser,Oe.length?Z.parser.startParse(this.input,hn(He,Oe),Oe):Z.parser.startParse(""),Z.overlay?Z.overlay.map(Je=>new de(Je.from-I.from,Je.to-I.from)):null,I.tree,Oe.length?Oe[0].from:I.from)),Z.overlay?Oe.length&&(N={ranges:Oe,depth:0,prev:N}):se=!1}}else C&&(xe=C.predicate(I))&&(xe===!0&&(xe=new de(I.from,I.to)),xe.from<xe.to&&C.ranges.push(xe));if(se&&I.firstChild())C&&C.depth++,N&&N.depth++;else for(;!I.nextSibling();){if(!I.parent())break e;if(C&&!--C.depth){let He=_t(this.ranges,C.ranges);He.length&&(Me(He),this.inner.splice(C.index,0,new ke(C.parser,C.parser.startParse(this.input,hn(C.mounts,He),He),C.ranges.map(Oe=>new de(Oe.from-C.start,Oe.to-C.start)),C.target,He[0].from))),C=C.prev}N&&!--N.depth&&(N=N.prev)}}}}function Qt(ie,w,C){for(let N of ie){if(N.from>=C)break;if(N.to>w)return N.from<=w&&N.to>=C?2:1}return 0}function et(ie,w,C,N,I,Z){if(w<C){let ee=ie.buffer[w+1];N.push(ie.slice(w,C,ee)),I.push(ee-Z)}}function Li(ie){let{node:w}=ie,C=[],N=w.context.buffer;do C.push(ie.index),ie.parent();while(!ie.tree);let I=ie.tree,Z=I.children.indexOf(N),ee=I.children[Z],se=ee.buffer,xe=[Z];function He(Oe,Je,tt,rt,ei,ci){let Vt=C[ci],zt=[],Ct=[];et(ee,Oe,Vt,zt,Ct,rt);let Bt=se[Vt+1],Ci=se[Vt+2];xe.push(zt.length);let it=ci?He(Vt+4,se[Vt+3],ee.set.types[se[Vt]],Bt,Ci-Bt,ci-1):w.toTree();return zt.push(it),Ct.push(Bt-rt),et(ee,se[Vt+3],Je,zt,Ct,rt),new nt(tt,zt,Ct,ei)}I.children[Z]=He(0,se.length,Ie.none,0,ee.length,C.length-1);for(let Oe of xe){let Je=ie.tree.children[Oe],tt=ie.tree.positions[Oe];ie.yield(new pt(Je,tt+ie.from,Oe,ie._tree))}}class Rt{constructor(w,C){this.offset=C,this.done=!1,this.cursor=w.cursor($e.IncludeAnonymous|$e.IgnoreMounts)}moveTo(w){let{cursor:C}=this,N=w-this.offset;for(;!this.done&&C.from<N;)C.to>=w&&C.enter(N,1,$e.IgnoreOverlays|$e.ExcludeBuffers)||C.next(!1)||(this.done=!0)}hasNode(w){if(this.moveTo(w.from),!this.done&&this.cursor.from+this.offset==w.from&&this.cursor.tree)for(let C=this.cursor.tree;;){if(C==w.tree)return!0;if(C.children.length&&C.positions[0]==0&&C.children[0]instanceof nt)C=C.children[0];else break}return!1}}class kt{constructor(w){var C;if(this.fragments=w,this.curTo=0,this.fragI=0,w.length){let N=this.curFrag=w[0];this.curTo=(C=N.tree.prop(Dt))!==null&&C!==void 0?C:N.to,this.inner=new Rt(N.tree,-N.offset)}else this.curFrag=this.inner=null}hasNode(w){for(;this.curFrag&&w.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=w.from&&this.curTo>=w.to&&this.inner.hasNode(w)}nextFrag(){var w;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let C=this.curFrag=this.fragments[this.fragI];this.curTo=(w=C.tree.prop(Dt))!==null&&w!==void 0?w:C.to,this.inner=new Rt(C.tree,-C.offset)}}findMounts(w,C){var N;let I=[];if(this.inner){this.inner.cursor.moveTo(w,1);for(let Z=this.inner.cursor.node;Z;Z=Z.parent){let ee=(N=Z.tree)===null||N===void 0?void 0:N.prop(L.mounted);if(ee&&ee.parser==C)for(let se=this.fragI;se<this.fragments.length;se++){let xe=this.fragments[se];if(xe.from>=Z.to)break;xe.tree==this.curFrag.tree&&I.push({frag:xe,pos:Z.from-xe.offset,mount:ee})}}}return I}}function _t(ie,w){let C=null,N=w;for(let I=1,Z=0;I<ie.length;I++){let ee=ie[I-1].to,se=ie[I].from;for(;Z<N.length;Z++){let xe=N[Z];if(xe.from>=se)break;xe.to<=ee||(C||(N=C=w.slice()),xe.from<ee?(C[Z]=new de(xe.from,ee),xe.to>se&&C.splice(Z+1,0,new de(se,xe.to))):xe.to>se?C[Z--]=new de(se,xe.to):C.splice(Z--,1))}}return N}function Xi(ie,w,C,N){let I=0,Z=0,ee=!1,se=!1,xe=-1e9,He=[];for(;;){let Oe=I==ie.length?1e9:ee?ie[I].to:ie[I].from,Je=Z==w.length?1e9:se?w[Z].to:w[Z].from;if(ee!=se){let tt=Math.max(xe,C),rt=Math.min(Oe,Je,N);tt<rt&&He.push(new de(tt,rt))}if(xe=Math.min(Oe,Je),xe==1e9)break;Oe==xe&&(ee?(ee=!1,I++):ee=!0),Je==xe&&(se?(se=!1,Z++):se=!0)}return He}function hn(ie,w){let C=[];for(let{pos:N,mount:I,frag:Z}of ie){let ee=N+(I.overlay?I.overlay[0].from:0),se=ee+I.tree.length,xe=Math.max(Z.from,ee),He=Math.min(Z.to,se);if(I.overlay){let Oe=I.overlay.map(tt=>new de(tt.from+N,tt.to+N)),Je=Xi(w,Oe,xe,He);for(let tt=0,rt=xe;;tt++){let ei=tt==Je.length,ci=ei?He:Je[tt].from;if(ci>rt&&C.push(new ki(rt,ci,I.tree,-ee,Z.from>=rt||Z.openStart,Z.to<=ci||Z.openEnd)),ei)break;rt=Je[tt].to}}else C.push(new ki(xe,He,I.tree,-ee,Z.from>=ee||Z.openStart,Z.to<=se||Z.openEnd))}return C}},86253:(kn,Wt,q)=>{q.d(Wt,{Gv:()=>vt,QR:()=>$e,bW:()=>_e,pJ:()=>Ge});var p=q(21649);let Se=0;class de{constructor(oe,ye,ke){this.set=oe,this.base=ye,this.modified=ke,this.id=Se++}static define(oe){if(oe!=null&&oe.base)throw new Error("Can not derive from a modified tag");let ye=new de([],null,[]);if(ye.set.push(ye),oe)for(let ke of oe.set)ye.set.push(ke);return ye}static defineModifier(){let oe=new G;return ye=>ye.modified.indexOf(oe)>-1?ye:G.get(ye.base||ye,ye.modified.concat(oe).sort((ke,Me)=>ke.id-Me.id))}}let L=0;class G{constructor(){this.instances=[],this.id=L++}static get(oe,ye){if(!ye.length)return oe;let ke=ye[0].instances.find(lt=>lt.base==oe&&Ce(ye,lt.modified));if(ke)return ke;let Me=[],Fe=new de(Me,oe,ye);for(let lt of ye)lt.instances.push(Fe);let Dt=Ie(ye);for(let lt of oe.set)if(!lt.modified.length)for(let Qt of Dt)Me.push(G.get(lt,Qt));return Fe}}function Ce(Xe,oe){return Xe.length==oe.length&&Xe.every((ye,ke)=>ye==oe[ke])}function Ie(Xe){let oe=[[]];for(let ye=0;ye<Xe.length;ye++)for(let ke=0,Me=oe.length;ke<Me;ke++)oe.push(oe[ke].concat(Xe[ye]));return oe.sort((ye,ke)=>ke.length-ye.length)}function vt(Xe){let oe=Object.create(null);for(let ye in Xe){let ke=Xe[ye];Array.isArray(ke)||(ke=[ke]);for(let Me of ye.split(" "))if(Me){let Fe=[],Dt=2,lt=Me;for(let Rt=0;;){if(lt=="..."&&Rt>0&&Rt+3==Me.length){Dt=1;break}let kt=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(lt);if(!kt)throw new RangeError("Invalid path: "+Me);if(Fe.push(kt[0]=="*"?"":kt[0][0]=='"'?JSON.parse(kt[0]):kt[0]),Rt+=kt[0].length,Rt==Me.length)break;let _t=Me[Rt++];if(Rt==Me.length&&_t=="!"){Dt=0;break}if(_t!="/")throw new RangeError("Invalid path: "+Me);lt=Me.slice(Rt)}let Qt=Fe.length-1,et=Fe[Qt];if(!et)throw new RangeError("Invalid path: "+Me);let Li=new bt(ke,Dt,Qt>0?Fe.slice(0,Qt):null);oe[et]=Li.sort(oe[et])}}return dt.add(oe)}const dt=new p.md;class bt{constructor(oe,ye,ke,Me){this.tags=oe,this.mode=ye,this.context=ke,this.next=Me}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(oe){return!oe||oe.depth<this.depth?(this.next=oe,this):(oe.next=this.sort(oe.next),oe)}get depth(){return this.context?this.context.length:0}}bt.empty=new bt([],2,null);function $e(Xe,oe){let ye=Object.create(null);for(let Fe of Xe)if(!Array.isArray(Fe.tag))ye[Fe.tag.id]=Fe.class;else for(let Dt of Fe.tag)ye[Dt.id]=Fe.class;let{scope:ke,all:Me=null}=oe||{};return{style:Fe=>{let Dt=Me;for(let lt of Fe)for(let Qt of lt.set){let et=ye[Qt.id];if(et){Dt=Dt?Dt+" "+et:et;break}}return Dt},scope:ke}}function nt(Xe,oe){let ye=null;for(let ke of Xe){let Me=ke.style(oe);Me&&(ye=ye?ye+" "+Me:Me)}return ye}function _e(Xe,oe,ye,ke=0,Me=Xe.length){let Fe=new yi(ke,Array.isArray(oe)?oe:[oe],ye);Fe.highlightRange(Xe.cursor(),ke,Me,"",Fe.highlighters),Fe.flush(Me)}function mt(Xe,oe,ye,ke,Me,Fe=0,Dt=Xe.length){let lt=Fe;function Qt(et,Li){if(!(et<=lt)){for(let Rt=Xe.slice(lt,et),kt=0;;){let _t=Rt.indexOf(`
`,kt),Xi=_t<0?Rt.length:_t;if(Xi>kt&&ke(Rt.slice(kt,Xi),Li),_t<0)break;Me(),kt=_t+1}lt=et}}_e(oe,ye,(et,Li,Rt)=>{Qt(et,""),Qt(Li,Rt)},Fe,Dt),Qt(Dt,"")}class yi{constructor(oe,ye,ke){this.at=oe,this.highlighters=ye,this.span=ke,this.class=""}startSpan(oe,ye){ye!=this.class&&(this.flush(oe),oe>this.at&&(this.at=oe),this.class=ye)}flush(oe){oe>this.at&&this.class&&this.span(this.at,oe,this.class)}highlightRange(oe,ye,ke,Me,Fe){let{type:Dt,from:lt,to:Qt}=oe;if(lt>=ke||Qt<=ye)return;Dt.isTop&&(Fe=this.highlighters.filter(_t=>!_t.scope||_t.scope(Dt)));let et=Me,Li=Xt(oe)||bt.empty,Rt=nt(Fe,Li.tags);if(Rt&&(et&&(et+=" "),et+=Rt,Li.mode==1&&(Me+=(Me?" ":"")+Rt)),this.startSpan(Math.max(ye,lt),et),Li.opaque)return;let kt=oe.tree&&oe.tree.prop(p.md.mounted);if(kt&&kt.overlay){let _t=oe.node.enter(kt.overlay[0].from+lt,1),Xi=this.highlighters.filter(ie=>!ie.scope||ie.scope(kt.tree.type)),hn=oe.firstChild();for(let ie=0,w=lt;;ie++){let C=ie<kt.overlay.length?kt.overlay[ie]:null,N=C?C.from+lt:Qt,I=Math.max(ye,w),Z=Math.min(ke,N);if(I<Z&&hn)for(;oe.from<Z&&(this.highlightRange(oe,I,Z,Me,Fe),this.startSpan(Math.min(Z,oe.to),et),!(oe.to>=N||!oe.nextSibling())););if(!C||N>ke)break;w=C.to+lt,w>ye&&(this.highlightRange(_t.cursor(),Math.max(ye,C.from+lt),Math.min(ke,w),"",Xi),this.startSpan(Math.min(ke,w),et))}hn&&oe.parent()}else if(oe.firstChild()){kt&&(Me="");do if(!(oe.to<=ye)){if(oe.from>=ke)break;this.highlightRange(oe,ye,ke,Me,Fe),this.startSpan(Math.min(ke,oe.to),et)}while(oe.nextSibling());oe.parent()}}}function Xt(Xe){let oe=Xe.type.prop(dt);for(;oe&&oe.context&&!Xe.matchContext(oe.context);)oe=oe.next;return oe||null}const me=de.define,pt=me(),Kt=me(),wi=me(Kt),ui=me(Kt),Et=me(),ii=me(Et),Di=me(Et),Jt=me(),Ot=me(Jt),Tt=me(),ct=me(),Yt=me(),ri=me(Yt),Si=me(),Ge={comment:pt,lineComment:me(pt),blockComment:me(pt),docComment:me(pt),name:Kt,variableName:me(Kt),typeName:wi,tagName:me(wi),propertyName:ui,attributeName:me(ui),className:me(Kt),labelName:me(Kt),namespace:me(Kt),macroName:me(Kt),literal:Et,string:ii,docString:me(ii),character:me(ii),attributeValue:me(ii),number:Di,integer:me(Di),float:me(Di),bool:me(Et),regexp:me(Et),escape:me(Et),color:me(Et),url:me(Et),keyword:Tt,self:me(Tt),null:me(Tt),atom:me(Tt),unit:me(Tt),modifier:me(Tt),operatorKeyword:me(Tt),controlKeyword:me(Tt),definitionKeyword:me(Tt),moduleKeyword:me(Tt),operator:ct,derefOperator:me(ct),arithmeticOperator:me(ct),logicOperator:me(ct),bitwiseOperator:me(ct),compareOperator:me(ct),updateOperator:me(ct),definitionOperator:me(ct),typeOperator:me(ct),controlOperator:me(ct),punctuation:Yt,separator:me(Yt),bracket:ri,angleBracket:me(ri),squareBracket:me(ri),paren:me(ri),brace:me(ri),content:Jt,heading:Ot,heading1:me(Ot),heading2:me(Ot),heading3:me(Ot),heading4:me(Ot),heading5:me(Ot),heading6:me(Ot),contentSeparator:me(Jt),list:me(Jt),quote:me(Jt),emphasis:me(Jt),strong:me(Jt),link:me(Jt),monospace:me(Jt),strikethrough:me(Jt),inserted:me(),deleted:me(),changed:me(),invalid:me(),meta:Si,documentMeta:me(Si),annotation:me(Si),processingInstruction:me(Si),definition:de.defineModifier(),constant:de.defineModifier(),function:de.defineModifier(),standard:de.defineModifier(),local:de.defineModifier(),special:de.defineModifier()},ki=$e([{tag:Ge.link,class:"tok-link"},{tag:Ge.heading,class:"tok-heading"},{tag:Ge.emphasis,class:"tok-emphasis"},{tag:Ge.strong,class:"tok-strong"},{tag:Ge.keyword,class:"tok-keyword"},{tag:Ge.atom,class:"tok-atom"},{tag:Ge.bool,class:"tok-bool"},{tag:Ge.url,class:"tok-url"},{tag:Ge.labelName,class:"tok-labelName"},{tag:Ge.inserted,class:"tok-inserted"},{tag:Ge.deleted,class:"tok-deleted"},{tag:Ge.literal,class:"tok-literal"},{tag:Ge.string,class:"tok-string"},{tag:Ge.number,class:"tok-number"},{tag:[Ge.regexp,Ge.escape,Ge.special(Ge.string)],class:"tok-string2"},{tag:Ge.variableName,class:"tok-variableName"},{tag:Ge.local(Ge.variableName),class:"tok-variableName tok-local"},{tag:Ge.definition(Ge.variableName),class:"tok-variableName tok-definition"},{tag:Ge.special(Ge.variableName),class:"tok-variableName2"},{tag:Ge.definition(Ge.propertyName),class:"tok-propertyName tok-definition"},{tag:Ge.typeName,class:"tok-typeName"},{tag:Ge.namespace,class:"tok-namespace"},{tag:Ge.className,class:"tok-className"},{tag:Ge.macroName,class:"tok-macroName"},{tag:Ge.propertyName,class:"tok-propertyName"},{tag:Ge.operator,class:"tok-operator"},{tag:Ge.comment,class:"tok-comment"},{tag:Ge.meta,class:"tok-meta"},{tag:Ge.invalid,class:"tok-invalid"},{tag:Ge.punctuation,class:"tok-punctuation"}])},37207:(kn,Wt,q)=>{q.d(Wt,{V:()=>G});const p="\u037C",Se=typeof Symbol=="undefined"?"__"+p:Symbol.for(p),de=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),L=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class G{constructor(dt,bt){this.rules=[];let{finish:$e}=bt||{};function nt(mt){return/^@/.test(mt)?[mt]:mt.split(/,\s*/)}function _e(mt,yi,Xt,me){let pt=[],Kt=/^@(\w+)\b/.exec(mt[0]),wi=Kt&&Kt[1]=="keyframes";if(Kt&&yi==null)return Xt.push(mt[0]+";");for(let ui in yi){let Et=yi[ui];if(/&/.test(ui))_e(ui.split(/,\s*/).map(ii=>mt.map(Di=>ii.replace(/&/,Di))).reduce((ii,Di)=>ii.concat(Di)),Et,Xt);else if(Et&&typeof Et=="object"){if(!Kt)throw new RangeError("The value of a property ("+ui+") should be a primitive value.");_e(nt(ui),Et,pt,wi)}else Et!=null&&pt.push(ui.replace(/_.*/,"").replace(/[A-Z]/g,ii=>"-"+ii.toLowerCase())+": "+Et+";")}(pt.length||wi)&&Xt.push(($e&&!Kt&&!me?mt.map($e):mt).join(", ")+" {"+pt.join(" ")+"}")}for(let mt in dt)_e(nt(mt),dt[mt],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let dt=L[Se]||1;return L[Se]=dt+1,p+dt.toString(36)}static mount(dt,bt,$e){let nt=dt[de],_e=$e&&$e.nonce;nt?_e&&nt.setNonce(_e):nt=new Ie(dt,_e),nt.mount(Array.isArray(bt)?bt:[bt])}}let Ce=new Map;class Ie{constructor(dt,bt){let $e=dt.ownerDocument||dt,nt=$e.defaultView;if(!dt.head&&dt.adoptedStyleSheets&&nt.CSSStyleSheet){let _e=Ce.get($e);if(_e)return dt.adoptedStyleSheets=[_e.sheet,...dt.adoptedStyleSheets],dt[de]=_e;this.sheet=new nt.CSSStyleSheet,dt.adoptedStyleSheets=[this.sheet,...dt.adoptedStyleSheets],Ce.set($e,this)}else{this.styleTag=$e.createElement("style"),bt&&this.styleTag.setAttribute("nonce",bt);let _e=dt.head||dt;_e.insertBefore(this.styleTag,_e.firstChild)}this.modules=[],dt[de]=this}mount(dt){let bt=this.sheet,$e=0,nt=0;for(let _e=0;_e<dt.length;_e++){let mt=dt[_e],yi=this.modules.indexOf(mt);if(yi<nt&&yi>-1&&(this.modules.splice(yi,1),nt--,yi=-1),yi==-1){if(this.modules.splice(nt++,0,mt),bt)for(let Xt=0;Xt<mt.rules.length;Xt++)bt.insertRule(mt.rules[Xt],$e++)}else{for(;nt<yi;)$e+=this.modules[nt++].rules.length;$e+=mt.rules.length,nt++}}if(!bt){let _e="";for(let mt=0;mt<this.modules.length;mt++)_e+=this.modules[mt].getRules()+`
`;this.styleTag.textContent=_e}}setNonce(dt){this.styleTag&&this.styleTag.getAttribute("nonce")!=dt&&this.styleTag.setAttribute("nonce",dt)}}}}]);})();

//# sourceMappingURL=258.cf57e6c7.chunk.js.map